(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[5610],{3905:function(e,n,a){"use strict";a.d(n,{Zo:function(){return u},kt:function(){return m}});var t=a(67294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function _(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function l(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?_(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function i(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},_=Object.keys(e);for(t=0;t<_.length;t++)a=_[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(e);for(t=0;t<_.length;t++)a=_[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=t.createContext({}),o=function(e){var n=t.useContext(s),a=n;return e&&(a="function"==typeof e?e(n):l(l({},n),e)),a},u=function(e){var n=o(e.components);return t.createElement(s.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},d=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,_=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=o(a),m=r,p=d["".concat(s,".").concat(m)]||d[m]||c[m]||_;return a?t.createElement(p,l(l({ref:n},u),{},{components:a})):t.createElement(p,l({ref:n},u))}));function m(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var _=a.length,l=new Array(_);l[0]=d;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var o=2;o<_;o++)l[o]=a[o];return t.createElement.apply(null,l)}return t.createElement.apply(null,a)}d.displayName="MDXCreateElement"},50941:function(e,n,a){"use strict";a.r(n),a.d(n,{frontMatter:function(){return l},metadata:function(){return i},toc:function(){return s},default:function(){return u}});var t=a(22122),r=a(19756),_=(a(67294),a(3905)),l={title:"Update Person in CommCare V2",sidebar_label:"\u2728 Update Person in CommCare V2",id:"Update-Person-in-CommCare-V2-2019-10-04",keywords:["library","job","expression","commcare","dataValue","field","fields","submit"]},i={unversionedId:"jobs/auto/Update-Person-in-CommCare-V2-2019-10-04",id:"jobs/auto/Update-Person-in-CommCare-V2-2019-10-04",isDocsHomePage:!1,title:"Update Person in CommCare V2",description:"This job was provided by an OpenFn.org user via the job library API.",source:"@site/library/jobs/auto/Update-Person-in-CommCare-V2-2019-10-04.md",sourceDirName:"jobs/auto",slug:"/jobs/auto/Update-Person-in-CommCare-V2-2019-10-04",permalink:"/library/jobs/auto/Update-Person-in-CommCare-V2-2019-10-04",version:"current",sidebar_label:"\u2728 Update Person in CommCare V2",frontMatter:{title:"Update Person in CommCare V2",sidebar_label:"\u2728 Update Person in CommCare V2",id:"Update-Person-in-CommCare-V2-2019-10-04",keywords:["library","job","expression","commcare","dataValue","field","fields","submit"]},sidebar:"library",previous:{title:"Close Household Case",permalink:"/library/jobs/auto/Close-Household-Case-2017-05-15"},next:{title:"0 - Get TEI data",permalink:"/library/jobs/auto/0-Get-TEI-data-2021-06-02"}},s=[{value:"Metadata",id:"metadata",children:[]},{value:"Key Functions",id:"key-functions",children:[]},{value:"Expression",id:"expression",children:[]}],o={toc:s};function u(e){var n=e.components,a=(0,r.Z)(e,["components"]);return(0,_.kt)("wrapper",(0,t.Z)({},o,a,{components:n,mdxType:"MDXLayout"}),(0,_.kt)("em",null,"This job was provided by an OpenFn.org user via the job library API."),(0,_.kt)("h2",{id:"metadata"},"Metadata"),(0,_.kt)("ul",null,(0,_.kt)("li",{parentName:"ul"},"Name: Update Person in CommCare V2"),(0,_.kt)("li",{parentName:"ul"},"Adaptor: ",(0,_.kt)("a",{parentName:"li",href:"https://www.github.com/openfn/language-commcare"},(0,_.kt)("inlineCode",{parentName:"a"},"@openfn/language-commcare"))),(0,_.kt)("li",{parentName:"ul"},"Adaptor Version: ",(0,_.kt)("a",{parentName:"li",href:"https://www.github.com/openfn/language-commcare"},(0,_.kt)("inlineCode",{parentName:"a"},"latest"))),(0,_.kt)("li",{parentName:"ul"},"Created over 1 year ago"),(0,_.kt)("li",{parentName:"ul"},"Updated 10 months ago"),(0,_.kt)("li",{parentName:"ul"},"Score: ",(0,_.kt)("b",null,"93")," (an ",(0,_.kt)("a",{parentName:"li",href:"/library/#library-scores"},"indicator")," of how useful this job may be)")),(0,_.kt)("h2",{id:"key-functions"},"Key Functions"),(0,_.kt)("p",null,(0,_.kt)("inlineCode",{parentName:"p"},"dataValue"),", ",(0,_.kt)("inlineCode",{parentName:"p"},"field"),", ",(0,_.kt)("inlineCode",{parentName:"p"},"fields"),", ",(0,_.kt)("inlineCode",{parentName:"p"},"submit")),(0,_.kt)("h2",{id:"expression"},"Expression"),(0,_.kt)("pre",null,(0,_.kt)("code",{parentName:"pre",className:"language-js"},"submit(\n  fields(\n    field('@', state => {\n      return {\n        'xmlns:jrm': 'http://dev.commcarehq.org/jr/xforms',\n        xmlns: () => {\n          return dataValue('new[0].Catchment__c')(state) == 'a001p000017gpfZAAQ'\n            ? 'http://openrosa.org/formdesigner/457C806C-B47D-44F0-BE4B-7E88F7162D1D'\n            : 'http://openrosa.org/formdesigner/a34af027a7fa943998c39f64bc84a337a668114a';\n        },\n        uiVersion: '1',\n        version: '81',\n        name: () => {\n          return dataValue('new[0].Catchment__c')(state) == 'a001p000017gpfZAAQ'\n            ? 'Update Person MOH'\n            : 'Update Person';\n        },\n      };\n    }),\n    field('Source', 0),\n    field('Status', state => {\n      return {\n        Client_Status: dataValue('new[0].Client_Status__c')(state),\n        Date_of_Transfer_Out: dataValue('new[0].Date_of_Transfer_Out__c')(\n          state\n        ),\n        Date_Last_Seen: dataValue('new[0].Date_Last_Seen__c')(state),\n        Date_of_Death: dataValue('new[0].Date_of_Death__c')(state),\n        Cause_of_Death: dataValue('new[0].Cause_of_Death__c')(state),\n      };\n    }),\n    field('Basic_Information', state => {\n      return {\n        Basic_Information: {\n          Phone_Number: dataValue('new[0].Telephone__c')(state),\n          Final_Program: () => {\n            var program = '';\n            if (\n              dataValue('new[0].Active_In_Thrive_Thru_5__c')(state) == 'Yes' ||\n              dataValue('new[0].Active_TT5_Mother__c')(state) == 'Yes'\n            ) {\n              if (dataValue('new[0].Active_In_HAWI__c')(state) == 'Yes') {\n                program = 'Both';\n              } else {\n                program = 'Thrive_Through_5';\n              }\n            } else {\n              if (dataValue('new[0].Active_In_HAWI__c')(state) == 'Yes') {\n                program = 'HAWI';\n              }\n            }\n            return program;\n          },\n        },\n      };\n    }),\n    field('TT5', state => {\n      return {\n        Child_Information: {\n          ANCs: {\n            ANC_1: dataValue('new[0].ANC_1__c')(state),\n            ANC_2: dataValue('new[0].ANC_2__c')(state),\n            ANC_3: dataValue('new[0].ANC_3__c')(state),\n            ANC_4: dataValue('new[0].ANC_4__c')(state),\n            ANC_5: dataValue('new[0].ANC_5__c')(state),\n          },\n          Delivery_Information: {\n            Person_Name: dataValue('new[0].Name')(state),\n            DOB: dataValue('new[0].Date_of_Birth__c')(state),\n            Delivery_Type: () => {\n              var val = '';\n              if (dataValue('new[0].Place_of_Delivery__c')(state) == 'Home') {\n                val = 'Unskilled';\n              } else if (\n                dataValue('new[0].Place_of_Delivery__c')(state) == 'Facility'\n              ) {\n                val = 'Skilled';\n              }\n              return val;\n            },\n            Delivery_Facility: dataValue('new[0].Delivery_Facility__c')(state),\n          },\n          Immunizations: {\n            BCG: dataValue('new[0].BCG__c')(state),\n            OPV_0: dataValue('new[0].OPV_0__c')(state),\n            OPV_PCV_Penta_1: dataValue('new[0].OPV_1__c')(state),\n            OPV_PCV_Penta_2: dataValue('new[0].OPV_2__c')(state),\n            OPV_PCV_Penta_3: dataValue('new[0].OPV_3__c')(state),\n            Measles_6: dataValue('new[0].Measles_6__c')(state),\n            Measles_9: dataValue('new[0].Measles_9__c')(state),\n            Measles_18: dataValue('new[0].Measles_18__c')(state),\n            Fully_Immunized: dataValue(\n              'new[0].Fully_Immunized_at_12_Months__c'\n            )(state),\n          },\n          /*\"CCMM\":{\n            \"Home_Test_Date\":dataValue(\"new[0].Measles_18__c\")(state),\n            \"Home_Test_Date\":dataValue(\"new[0].Measles_18__c\")(state),\n            \"Home_Test_Date\":dataValue(\"new[0].Measles_18__c\")(state),\n            \"Home_Test_Date\":dataValue(\"new[0].Measles_18__c\")(state),\n            \"Home_Test_Date\":dataValue(\"new[0].Measles_18__c\")(state),\n          }*/\n        },\n        Mother_Information: {\n          Pregnant: () => {\n            if (dataValue('new[0].Pregnant__c')(state) === true) {\n              return 'Yes';\n            }\n          },\n        },\n      };\n    }),\n    field('HAWI', state => {\n      return {\n        Unique_Patient_Code: dataValue('new[0].Unique_Patient_Code__c')(state),\n        Support_Group: dataValue('new[0].Active_in_Support_Group__c')(state),\n        Preferred_Care_F: {\n          Preferred_Care_Facility: dataValue(\n            'new[0].Preferred_Care_Facility__c'\n          )(state),\n        },\n      };\n    }),\n\n    field('n0:case', state => {\n      return {\n        '@': {\n          case_id: dataValue('new[0].CommCare_ID__c')(state),\n          date_modified: new Date().toISOString(),\n          user_id: 'e298884bfb6ee2d2b38591a6e8ae0228',\n          'xmlns:n0': 'http://commcarehq.org/case/transaction/v2',\n        },\n        'n0:create': {\n          'n0:case_name': () => {\n            var name1 = dataValue('new[0].Name')(state);\n            var name2 = name1.replace(/\\w\\S*/g, function (txt) {\n              return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n            });\n            return name2;\n          },\n          'n0:case_type': 'Person',\n          'n0:parent_id': dataValue('new[0].CommCare_HH_Code__c')(state),\n        },\n        'n0:update': {\n          'n0:ANC_1': dataValue('new[0].ANC_1__c')(state),\n\n          'n0:ANC_2': dataValue('new[0].ANC_2__c')(state),\n          'n0:ANC_3': dataValue('new[0].ANC_3__c')(state),\n          'n0:ANC_4': dataValue('new[0].ANC_4__c')(state),\n          'n0:ANC_5': dataValue('new[0].ANC_5__c')(state),\n          'n0:BCG': dataValue('new[0].BCG__c')(state),\n          'n0:Fully_Immunized': dataValue(\n            'new[0].Fully_Immunized_at_12_Months__c'\n          )(state),\n          'n0:Delivery_Type': () => {\n            var val = '';\n            if (dataValue('new[0].Place_of_Delivery__c')(state) == 'Home') {\n              val = 'Unskilled';\n            } else if (\n              dataValue('new[0].Place_of_Delivery__c')(state) == 'Facility'\n            ) {\n              val = 'Skilled';\n            }\n            return val;\n          },\n          'n0:Delivery_Facility': dataValue('new[0].Delivery_Facility__c')(\n            state\n          ),\n          'n0:Family_Planning_Method': dataValue(\n            'new[0].Family_Planning_Method__c'\n          )(state),\n          'n0:Child_Status': dataValue('new[0].Child_Status__c')(state),\n          'n0:Active_in_OSG_Mentoring': dataValue('new[0].Active_in_OSG__c')(\n            state\n          ),\n          'n0:OSG_Mentoring_Group': dataValue('new[0].OSG_Group__c')(state),\n          'n0:OPV_0': dataValue('new[0].OPV_0__c')(state),\n          'n0:OPV_PCV_Penta_1': dataValue('new[0].OPV_1__c')(state),\n          'n0:OPV_PCV_Penta_2': dataValue('new[0].OPV_2__c')(state),\n          'n0:OPV_PCV_Penta_3': dataValue('new[0].OPV_3__c')(state),\n          'n0:Current_Height': dataValue('new[0].Current_Height__c')(state),\n          'n0:Current_Weight': dataValue('new[0].Current_Weight__c')(state),\n          'n0:Current_MUAC': dataValue('new[0].Current_MUAC__c')(state),\n          'n0:Measles_6': dataValue('new[0].Measles_6__c')(state),\n          'n0:Measles_9': dataValue('new[0].Measles_9__c')(state),\n          'n0:LMP': dataValue('new[0].LMP__c')(state),\n          'n0:EDD': dataValue('new[0].EDD__c')(state),\n          'n0:Measles_18': dataValue('new[0].Measles_18__c')(state),\n          'n0:Pregnant': () => {\n            if (dataValue('new[0].Pregnant__c')(state) === true) {\n              return 'Yes';\n            }\n          },\n          'n0:ART': dataValue('new[0].Currently_on_ART_s__c')(state),\n          'n0:ARVs': dataValue('new[0].ART_Regimen__c')(state),\n          'n0:Active_in_Support_Group': dataValue(\n            'new[0].Active_in_Support_Group__c'\n          )(state),\n          'n0:Client_Program': () => {\n            var program = '';\n            if (\n              dataValue('new[0].Active_in_Thrive_Thru_5__c')(state) == 'Yes' ||\n              dataValue('new[0].Active_TT5_Mother__c')(state) == 'Yes'\n            ) {\n              if (dataValue('new[0].Active_in_HAWI__c')(state) == 'Yes') {\n                program = 'Both';\n              } else {\n                program = 'Thrive_Through_5';\n              }\n            } else {\n              if (dataValue('new[0].Active_in_HAWI__c')(state) == 'Yes') {\n                program = 'HAWI';\n              }\n            }\n            return program;\n          },\n          'n0:Currently_on_family_planning': dataValue(\n            'new[0].Family_Planning__c'\n          )(state),\n          'n0:DOB': dataValue('new[0].Date_of_Birth__c')(state),\n          'n0:Education_Level': () => {\n            if (dataValue('new[0].Education_Level__c')(state) !== undefined) {\n              return dataValue('new[0].Education_Level__c')(state)\n                .toString()\n                .replace(/ /g, '_');\n            }\n          },\n          'n0:Ever_on_Family_Planning': dataValue(\n            'new[0].Ever_on_Family_Planning__c'\n          )(state),\n          'n0:Gender': dataValue('new[0].Gender__c')(state),\n          'n0:Gravida': dataValue('new[0].Gravida__c')(state),\n          'n0:Active_in_TT5': dataValue('new[0].Active_in_Thrive_Thru_5__c')(\n            state\n          ),\n          'n0:Active_in_HAWI': dataValue('new[0].Active_in_HAWI__c')(state),\n          'n0:Marital_Status': dataValue('new[0].Marital_Status__c')(state),\n          'n0:Exclusive_Breastfeeding': dataValue(\n            'new[0].Exclusive_Breastfeeding__c'\n          )(state),\n          'n0:Next_of_Kin': dataValue('new[0].Next_of_Kin__c')(state),\n          'n0:Next_of_Kin_Phone': dataValue('new[0].Next_of_Kin_Phone__c')(\n            state\n          ),\n          'n0:Parity': dataValue('new[0].Parity__c')(state),\n\n          'n0:Phone_Number': dataValue('new[0].Telephone__c')(state),\n          'n0:Preferred_Care_Facility': dataValue(\n            'new[0].Preferred_Care_Facility__c'\n          )(state),\n          'n0:Record_Type': () => {\n            return dataValue('new[0].Record_Type_Name__c')(state)\n              .toString()\n              .replace(/ /g, '_');\n          },\n          'n0:Unique_Patient_Code': dataValue('new[0].Unique_Patient_Code__c')(\n            state\n          ),\n        },\n        'n0:index': {\n          'n0:parent': {\n            '@': {\n              case_type: 'Household',\n            },\n            '#': dataValue('new[0].CommCare_HH_Code__c')(state),\n          },\n        },\n      };\n    }),\n\n    field('n2:meta', state => {\n      return {\n        '@': { 'xmlns:n2': 'http://openrosa.org/jr/xforms' },\n        'n2:deviceID': 'Formplayer',\n        'n2:timeStart': new Date().toISOString(),\n        'n2:timeEnd': new Date().toISOString(),\n        'n2:userID': 'e298884bfb6ee2d2b38591a6e8ae0228',\n      };\n    })\n  )\n);\n\n")))}u.isMDXComponent=!0}}]);