(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[4187],{3905:function(e,_,a){"use strict";a.d(_,{Zo:function(){return c},kt:function(){return d}});var n=a(67294);function t(e,_,a){return _ in e?Object.defineProperty(e,_,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[_]=a,e}function r(e,_){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);_&&(n=n.filter((function(_){return Object.getOwnPropertyDescriptor(e,_).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var _=1;_<arguments.length;_++){var a=null!=arguments[_]?arguments[_]:{};_%2?r(Object(a),!0).forEach((function(_){t(e,_,a[_])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(_){Object.defineProperty(e,_,Object.getOwnPropertyDescriptor(a,_))}))}return e}function l(e,_){if(null==e)return{};var a,n,t=function(e,_){if(null==e)return{};var a,n,t={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],_.indexOf(a)>=0||(t[a]=e[a]);return t}(e,_);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],_.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(t[a]=e[a])}return t}var o=n.createContext({}),s=function(e){var _=n.useContext(o),a=_;return e&&(a="function"==typeof e?e(_):i(i({},_),e)),a},c=function(e){var _=s(e.components);return n.createElement(o.Provider,{value:_},e.children)},m={inlineCode:"code",wrapper:function(e){var _=e.children;return n.createElement(n.Fragment,{},_)}},u=n.forwardRef((function(e,_){var a=e.components,t=e.mdxType,r=e.originalType,o=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=s(a),d=t,h=u["".concat(o,".").concat(d)]||u[d]||m[d]||r;return a?n.createElement(h,i(i({ref:_},c),{},{components:a})):n.createElement(h,i({ref:_},c))}));function d(e,_){var a=arguments,t=_&&_.mdxType;if("string"==typeof e||t){var r=a.length,i=new Array(r);i[0]=u;var l={};for(var o in _)hasOwnProperty.call(_,o)&&(l[o]=_[o]);l.originalType=e,l.mdxType="string"==typeof e?e:t,i[1]=l;for(var s=2;s<r;s++)i[s]=a[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},61768:function(e,_,a){"use strict";a.r(_),a.d(_,{frontMatter:function(){return i},metadata:function(){return l},toc:function(){return o},default:function(){return c}});var n=a(22122),t=a(19756),r=(a(67294),a(3905)),i={title:"Upsert Pre Challenges",sidebar_label:"Upsert Pre Challenges",id:"Upsert-Pre-Challenges-2021-04-30",keywords:["library","job","expression","salesforce","alterState","dataValue","field","fields","relationship","upsert"]},l={unversionedId:"jobs/auto/Upsert-Pre-Challenges-2021-04-30",id:"jobs/auto/Upsert-Pre-Challenges-2021-04-30",isDocsHomePage:!1,title:"Upsert Pre Challenges",description:"This job was provided by an OpenFn.org user via the job library API.",source:"@site/library/jobs/auto/Upsert-Pre-Challenges-2021-04-30.md",sourceDirName:"jobs/auto",slug:"/jobs/auto/Upsert-Pre-Challenges-2021-04-30",permalink:"/library/jobs/auto/Upsert-Pre-Challenges-2021-04-30",version:"current",sidebar_label:"Upsert Pre Challenges",frontMatter:{title:"Upsert Pre Challenges",sidebar_label:"Upsert Pre Challenges",id:"Upsert-Pre-Challenges-2021-04-30",keywords:["library","job","expression","salesforce","alterState","dataValue","field","fields","relationship","upsert"]},sidebar:"library",previous:{title:"Upsert Post Challenges",permalink:"/library/jobs/auto/Upsert-Post-Challenges-2021-04-30"},next:{title:"Upsert Register Event",permalink:"/library/jobs/auto/Upsert-Register-Event-2021-04-30"}},o=[{value:"Metadata",id:"metadata",children:[]},{value:"Key Functions",id:"key-functions",children:[]},{value:"Expression",id:"expression",children:[]}],s={toc:o};function c(e){var _=e.components,a=(0,t.Z)(e,["components"]);return(0,r.kt)("wrapper",(0,n.Z)({},s,a,{components:_,mdxType:"MDXLayout"}),(0,r.kt)("em",null,"This job was provided by an OpenFn.org user via the job library API."),(0,r.kt)("h2",{id:"metadata"},"Metadata"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Name: Upsert Pre Challenges"),(0,r.kt)("li",{parentName:"ul"},"Adaptor: ",(0,r.kt)("a",{parentName:"li",href:"https://www.github.com/openfn/language-salesforce"},(0,r.kt)("inlineCode",{parentName:"a"},"@openfn/language-salesforce"))),(0,r.kt)("li",{parentName:"ul"},"Adaptor Version: ",(0,r.kt)("a",{parentName:"li",href:"https://www.github.com/openfn/language-salesforce/releases/tag/v2.0.0"},(0,r.kt)("inlineCode",{parentName:"a"},"v2.0.0"))),(0,r.kt)("li",{parentName:"ul"},"Created 27 days ago"),(0,r.kt)("li",{parentName:"ul"},"Updated 10 days ago"),(0,r.kt)("li",{parentName:"ul"},"Score: ",(0,r.kt)("b",null,"68")," (an ",(0,r.kt)("a",{parentName:"li",href:"/library/#library-scores"},"indicator")," of how useful this job may be)")),(0,r.kt)("h2",{id:"key-functions"},"Key Functions"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"alterState"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"dataValue"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"field"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"fields"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"relationship"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"upsert")),(0,r.kt)("h2",{id:"expression"},"Expression"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"alterState(state => {\n  function transform(value) {\n    if (!value) return;\n    switch (value.toString().trim().toLowerCase()) {\n      case 'true':\n      case 'yes':\n      case 'agree':\n        return 1;\n      case 'false':\n      case 'no':\n      case 'disagree':\n        return 2;\n      case 'i_dont_know':\n        return 3;\n      case 'unanswered':\n        return 4;\n      case 'not_applicable':\n        return 5;\n      default:\n        return value;\n    }\n  }\n\n  state.helperFunctions = { transform };\n\n  return state;\n});\n\nupsert(\n  'Attendance__c',\n  'CommCare_Ext_ID__c',\n  fields(\n    //field('Event__c', dataValue('form.hidden_properties.intervention_name')),\n   relationship('Event__r', 'CommCare_Ext_ID__c', dataValue('form.hidden_properties.intervention_name')),\n    relationship('Person_Attendance__r', 'Participant_Identification_Number_PID__c', dataValue('form.case.@case_id')),\n    // relationship('Person_Attendance__r','CommCare_Ext_ID__c', state => {\n    //   return (\n    //     dataValue('form.hidden_properties.participant_first_name')(state) +\n    //     dataValue('form.hidden_properties.participant_surname')(state)\n    //   )\n    // }),\n    \n    field('CommCare_Ext_ID__c', state => {\n      return dataValue('form.case.@case_id')(state) + \"-\" +\n        dataValue('form.hidden_properties.intervention_name')(state)\n    }),\n    \n    \n    //field(\n      //'Person_Attendance__c',\n     // state =>\n     //   dataValue('form.hidden_properties.participant_first_name')(state) +\n    //    ' ' +\n     //   dataValue('form.hidden_properties.participant_surname')(state)\n    //),\n    field('Gender__c', dataValue('form.hidden_properties.gender')),\n    field('Grade__c', dataValue('form.hidden_properties.grade')),\n    field('Class__c', dataValue('form.hidden_properties.class')),\n    field('Pre_Post_Completed__c', state => {\n      var done = dataValue('form.hidden_properties.pre_questionnaire_complete')(state);\n      return done === 'Yes' ? true : done === 'No' ? false : undefined;\n    }),\n    field('Date_Pre_Administered__c', dataValue('form.date')),\n    field('Pre_1__c', state => {\n      const value =\n        dataValue('form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.in_general_i_feel_good_about_myself')(state) ||\n        dataValue('form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_know_what_decisions_to_make_to_achieve_my_goals')(state) ||\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.i_have_talked_about_hiv_with_an_adult_in_the_past_two_months_outside_skillz'\n        )(state)||\n        dataValue('form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_know_what_decisions_to_make_to_achieve_my_goals')(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_2__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_zambia_-_skillz_core_zambia.i_know_how_to_overcome_challenges_that_i_may_have_in_life'\n        )(state) ||\n        dataValue('form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girlboy')(state) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.i_have_the_skills_and_knowledge_to_avoid_getting_infected_with_another_kind'\n        )(state)||\n        dataValue('form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_dont_always_have_to_do_what_people_expect_just_because_i_am_girlboy')(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_3__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_what_i_am_good_at'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.unequal_power_in_relationships_can_contribute_to_the_spread_of_hiv'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_important_to_know_why_and_how_i_want_to_tell_someone_my_hiv_status'\n        )(state) ||\n        dataValue('form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me')(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_4__c', state => {\n      const value =\n        dataValue('form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.i_accept_myself_and_my_hiv_status')(state) ||\n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.the_most_effective_way_to_avoid_getting_hiv_is_to_abstain_from_sex'\n        )(state) ||\n        dataValue('form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_can_make_my_own_informed_decisions_about_my_sexual_health')(state);\n        \n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_5__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me'\n        )(state) ||\n        dataValue('form.pre_challenge_nigeria_-_advanced_skills.malaria_is_spread_by_standing_under_the_hot_sun')(\n          state\n        ) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare'\n        )(state) ||\n        dataValue('form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship')(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_6__c', state => {\n      const value =\n        dataValue('form.pre_challenge_nigeria_-_advanced_skills.drinking_alcohol_can_increase_my_risk_of_getting_hiv')(\n          state\n        ) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.are_you_or_have_you_been_past_12_months_in_a_sexual_relationship_na_if_not_'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare'\n        )(state) ||\n        dataValue('form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want')(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_7__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.sleeping_under_a_mosquito_net_every_night_can_help_protect_me_from_malaria'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.are_you_or_your_boyfriendgirlfriend_currently_using_any_contraceptive_or_pr'\n        )(state) ||\n        dataValue('form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_access_sexual_health_services_such_as_sti_and_hiv_testi')(state) ||\n        dataValue('form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.my_skillz_coach_helps_me_to_be_a_better_person')(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_8__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.having_more_than_one_sexual_partner_over_the_same_time_period_increases_my_'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.i_have_an_older_person_in_my_life_i_can_go_to_for_advice'\n        )(state) ||\n        dataValue('form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advise_or_when_i_have_a')(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_9__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.it_is_okay_for_someone_with_malaria_to_stop_taking_their_medication_as_soon'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.there_are_people_i_trust_with_whom_i_can_talk_about_my_status'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want'\n        )(state) ||\n        dataValue('form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related')(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_10__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.i_can_abstain_from_sex_until_i_am_older_even_if_it_is_difficult'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.girls_should_be_obedient_and_should_not_disagree_with_boys'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_okay_for_two_people_with_hiv_to_have_unprotected_sex_with_each_other'\n        )(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_11__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.i_would_say_no_to_playing_sport_with_someone_who_has_hiv'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.when_i_have_a_choice_it_is_important_to_eat_a_variety_of_foods_including_gr'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.if_a_girl_gets_pregnant_she_should_drop_out_of_school'\n        )(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_12__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.men_should_share_the_work_around_the_house_such_as_cleaning'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_okay_for_someone_with_hiv_to_stop_taking_their_arv_as_soon_as_they_st'\n        )(state) ||\n         dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.my_skillz_coach_helps_me_to_be_a_better_person'\n        )(state);\n        \n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_13__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.it_is_the_males_responsibilty_to_make_decisions_in_a_relationship'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.art_adherence_is_an_important_part_of_my_overall_health_and_well-being'\n        )(state) ||\n                \n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advice_or_when_i_have_a'\n        )(state);\n\n\n      return state.helperFunctions.transform(value);\n    }),\n    \n    field('Pre_14__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.i_can_use_drugs_and_still_easily_reach_my_goals_in_life'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.mental_health_problems_have_nothing_to_do_with_being_lazy_or_weak_and_many_'\n        )(state) ||\n        dataValue('form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.if_i_test_positive_for_hiv_there_will_be_someone_who_will_help_and_support_'\n        )(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_15__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.when_sick_it_is_better_to_visit_the_herb_seller_than_to_visit_a_doctor_or_a'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.the_most_common_illnesses_of_mental_health_are_depression_and_anxiety'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_who_to_go_to_if_i_amsomeone_i_know_is_abused_sexually_physically_and'\n        )(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_16__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.it_is_okay_to_use_violence_with_my_partner_if_he_or_she_makes_me_angry'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.biological_and_social_factors_contribute_to_females_and_males_experiencing_'\n        )(state) ||\n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_who_to_go_to_if_someone_touches_me_in_a_way_that_makes_me_uncomforta'\n        )(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_17__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_nigeria_-_advanced_skills.i_have_the_power_to_change_gender_expectations_that_i_do_not_agree_with'\n        )(state) ||\n        \n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related'\n        )(state);\n\n      return state.helperFunctions.transform(value);\n    }),\n    field('Pre_18__c', state => {\n      const value =\n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_would_say_no_to_playing_sport_with_someone_who_has_hiv'\n        )(state);\n        \n        return state.helperFunctions.transform(value);\n        \n      }),\n\n    field('Pre_19__c', state => {\n    const value =\n        dataValue(\n          'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her'\n        )(state);\n        \n        return state.helperFunctions.transform(value);\n      \n    })\n  )\n);\n\n")))}c.isMDXComponent=!0}}]);