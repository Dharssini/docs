(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{127:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return i})),t.d(n,"metadata",(function(){return s})),t.d(n,"toc",(function(){return p})),t.d(n,"default",(function(){return c}));var o=t(3),r=t(8),a=(t(0),t(264)),i={title:"Google Forms/Google Sheets"},s={unversionedId:"apps/google-sheets",id:"apps/google-sheets",isDocsHomePage:!1,title:"Google Forms/Google Sheets",description:"Google Forms/Google Sheets",source:"@site/docs/apps/google-sheets.md",slug:"/apps/google-sheets",permalink:"/documentation/apps/google-sheets",editUrl:"https://github.com/openfn/docs/edit/main/docs/apps/google-sheets.md",version:"current",sidebar:"docs",previous:{title:"Go.Data",permalink:"/documentation/apps/godata"},next:{title:"Kobo Toolbox",permalink:"/documentation/apps/kobo-toolbox"}},p=[{value:"Google Forms/Google Sheets",id:"google-formsgoogle-sheets",children:[]}],l={toc:p};function c(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(a.b)("wrapper",Object(o.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"google-formsgoogle-sheets"},"Google Forms/Google Sheets"),Object(a.b)("p",null,"You can send data to OpenFn whenever a new row is added to a Google Sheet, for\nexample when a new submission is made to a Google Form. Below is some sample\ncode you may add to your Google Sheet to make it push data to OpenFn whenever\nnew rows are added."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-js"},"function sendToOpenFn(e) {\n  var payload = JSON.stringify(e);\n  var url = 'https://www.openfn.org/inbox/your-id-here';\n  var options = {\n    method: 'post',\n    contentType: 'application/json',\n    payload: payload,\n  };\n  var response = UrlFetchApp.fetch(url, options);\n}\n\nfunction isDate(v) {\n  if (Object.prototype.toString.call(v) === '[object Date]') {\n    if (isNaN(v.getTime())) {\n      return false;\n    } else {\n      return true;\n    }\n  } else {\n    return false;\n  }\n}\n\nfunction isNumber(v) {\n  if (Object.prototype.toString.call(v) === '[object Number]') {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nfunction getReportData() {\n  var bookReportData = { formId: 'bookReport', data: [] };\n  var data = SpreadsheetApp.getActiveSheet().getDataRange().getValues();\n\n  var pageCount = 0;\n  var bookRating = 0;\n\n  for (i in data) {\n    if (isDate(data[i][0])) {\n      //  ignore header line\n      if (isNumber(data[i][3])) {\n        pageCount = data[i][3];\n      }\n\n      if (isNumber(data[i][6])) {\n        bookRating = data[i][6];\n      }\n\n      bookReportData.data.push({\n        Timestamp: data[i][0],\n        Title: data[i][1],\n        Author: data[i][2],\n        NumberOfPages: pageCount,\n        Summary: data[i][4],\n        Protagonist: data[i][5],\n        Rating: bookRating,\n        EmailTeacher: data[i][7],\n        EmailStudent: data[i][8],\n        SendStatus: data[i][9],\n      });\n    }\n  }\n\n  //  Logger.log(bookReportData);\n\n  sendToOpenFn(bookReportData);\n}\n")))}c.isMDXComponent=!0},264:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return f}));var o=t(0),r=t.n(o);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=r.a.createContext({}),c=function(e){var n=r.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},u=function(e){var n=c(e.components);return r.a.createElement(l.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},g=r.a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,l=p(e,["components","mdxType","originalType","parentName"]),u=c(t),g=o,f=u["".concat(i,".").concat(g)]||u[g]||d[g]||a;return t?r.a.createElement(f,s(s({ref:n},l),{},{components:t})):r.a.createElement(f,s({ref:n},l))}));function f(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=g;var s={};for(var p in n)hasOwnProperty.call(n,p)&&(s[p]=n[p]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var l=2;l<a;l++)i[l]=t[l];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,t)}g.displayName="MDXCreateElement"}}]);