"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[2258],{3905:function(e,t,a){a.d(t,{Zo:function(){return s},kt:function(){return u}});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),m=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},s=function(e){var t=m(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),d=m(a),u=r,f=d["".concat(l,".").concat(u)]||d[u]||c[u]||i;return a?n.createElement(f,o(o({ref:t},s),{},{components:a})):n.createElement(f,o({ref:t},s))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=d;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:r,o[1]=p;for(var m=2;m<i;m++)o[m]=a[m];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},84324:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return p},contentTitle:function(){return l},metadata:function(){return m},toc:function(){return s},default:function(){return d}});var n=a(83117),r=a(80102),i=(a(67294),a(3905)),o=["components"],p={title:"CommCare"},l=void 0,m={unversionedId:"apps/commcare",id:"apps/commcare",title:"CommCare",description:"App Overview",source:"@site/docs/apps/commcare.md",sourceDirName:"apps",slug:"/apps/commcare",permalink:"/documentation/apps/commcare",editUrl:"https://github.com/openfn/docs/edit/main/docs/apps/commcare.md",tags:[],version:"current",frontMatter:{title:"CommCare"},sidebar:"docs",previous:{title:"CKAN",permalink:"/documentation/apps/ckan"},next:{title:"Go.Data",permalink:"/documentation/apps/godata"}},s=[{value:"App Overview",id:"app-overview",children:[{value:"Data Model",id:"data-model",children:[],level:3}],level:2},{value:"Integration Use Cases",id:"integration-use-cases",children:[],level:2},{value:"APIs &amp; Integration Options",id:"apis--integration-options",children:[{value:"Web API",id:"web-api",children:[],level:3},{value:"Webhook: Forward cases and/or forms from CommCare to OpenFn using REST service",id:"webhook-forward-cases-andor-forms-from-commcare-to-openfn-using-rest-service",children:[],level:3}],level:2},{value:"App Setup &amp; Integration Tips",id:"app-setup--integration-tips",children:[{value:"App installation and configuration",id:"app-installation-and-configuration",children:[{value:"App Versioning",id:"app-versioning",children:[],level:4}],level:3},{value:"Exporting Metadata",id:"exporting-metadata",children:[],level:3},{value:"Unique Identifiers",id:"unique-identifiers",children:[],level:3},{value:"Data Element Mapping Notes",id:"data-element-mapping-notes",children:[],level:3}],level:2},{value:"Common Errors",id:"common-errors",children:[],level:2},{value:"OpenFn Adaptors",id:"openfn-adaptors",children:[],level:2},{value:"Implementation Examples",id:"implementation-examples",children:[],level:2}],c={toc:s};function d(e){var t=e.components,a=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"app-overview"},"App Overview"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.dimagi.com/commcare/"},"CommCare")," is a powerful data collection\nplatform developed by Dimagi. It is an open-source platform, and is primarily\nbest for mobile case management."),(0,i.kt)("h3",{id:"data-model"},"Data Model"),(0,i.kt)("p",null,"CommCare data is primarily stored in ",(0,i.kt)("strong",{parentName:"p"},"forms")," and ",(0,i.kt)("strong",{parentName:"p"},"cases"),". Forms are the\nbuilding blocks of applications and cases are used to track data on objects,\nusually people. Learn more about CommCare forms and cases at the links below."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Case management:",(0,i.kt)("br",{parentName:"li"}),(0,i.kt)("a",{parentName:"li",href:"https://confluence.dimagi.com/display/commcarepublic/CommCare+Fundamentals+-+Case+Management"},"https://confluence.dimagi.com/display/commcarepublic/CommCare+Fundamentals+-+Case+Management")),(0,i.kt)("li",{parentName:"ul"},"Form and case data in CommCare:\n",(0,i.kt)("a",{parentName:"li",href:"https://confluence.dimagi.com/display/commcarepublic/CommCare+Fundamentals+-+Data+in+CommCare"},"https://confluence.dimagi.com/display/commcarepublic/CommCare+Fundamentals+-+Data+in+CommCare"))),(0,i.kt)("h2",{id:"integration-use-cases"},"Integration Use Cases"),(0,i.kt)("p",null,"Example user stories:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"As a community health worker I want to store patient data that was collected\nin rural areas with no internet access in Salesforce so I can better analyze\nthe data being collected and make more informed recommendations."),(0,i.kt)("li",{parentName:"ul"},"As a teacher I want to set up automatic message alerts to my students in order\nto increase participation.")),(0,i.kt)("h2",{id:"apis--integration-options"},"APIs & Integration Options"),(0,i.kt)("p",null,"CommCare offers a number of integration options for extracting and/or loading\ndata to and from CommCare HQ."),(0,i.kt)("h3",{id:"web-api"},"Web API"),(0,i.kt)("p",null,"CommCare has different APIs for reading vs. updating data. Some helpful links:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://confluence.dimagi.com/display/commcarepublic/Data+APIs"},"Data APIs")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://confluence.dimagi.com/display/commcarepublic/Bulk+Upload+Case+Data"},"Bulk Case Upload API to mass update case records"))),(0,i.kt)("h3",{id:"webhook-forward-cases-andor-forms-from-commcare-to-openfn-using-rest-service"},"Webhook: Forward cases and/or forms from CommCare to OpenFn using REST service"),(0,i.kt)("p",null,"See\n",(0,i.kt)("a",{parentName:"p",href:"https://confluence.dimagi.com/pages/viewpage.action?pageId=12224128"},"CommCare docs"),'\non how to configure this webhook to "push" data to an external system like\nOpenFn. This option is great for ',(0,i.kt)("em",{parentName:"p"},"real-time")," data forwarding."),(0,i.kt)("p",null,"Quick instructions:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},'Go to "Project Settings".'),(0,i.kt)("li",{parentName:"ol"},'Click "Data Forwarding".'),(0,i.kt)("li",{parentName:"ol"},'"Add a forwarding location" for Cases, Forms, or both.'),(0,i.kt)("li",{parentName:"ol"},"Specify JSON, using your OpenFn inbox URL as the target. See the\n",(0,i.kt)("a",{parentName:"li",href:"https://confluence.dimagi.com/pages/viewpage.action?pageId=12224128"},"CommCare documentation"),"."),(0,i.kt)("li",{parentName:"ol"},"Create a\n",(0,i.kt)("a",{parentName:"li",href:"/documentation/build/triggers#match-a-message-with-a-fragment-inside-another-object-called-form"},"message-filter trigger like this"),"."),(0,i.kt)("li",{parentName:"ol"},"Set up a ",(0,i.kt)("inlineCode",{parentName:"li"},"job")," running on that filter to process CommCare submissions or case\nupdates.")),(0,i.kt)("p",null,"We recommend updating the ",(0,i.kt)("inlineCode",{parentName:"p"},"Connection Settings")," to list emails that should be\nalerted if there is a data forwarding error.\n",(0,i.kt)("a",{parentName:"p",href:"https://confluence.dimagi.com/pages/viewpage.action?pageId=12224128#EnablingDataIntegration(FormandCaseForwarding)-Errornotifications"},"See the CommCare docs for more on this."),"."),(0,i.kt)("h2",{id:"app-setup--integration-tips"},"App Setup & Integration Tips"),(0,i.kt)("h3",{id:"app-installation-and-configuration"},"App installation and configuration"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"CommCare docs on installing the mobile app:\n",(0,i.kt)("a",{parentName:"li",href:"https://confluence.dimagi.com/display/commcarepublic/Install+CommCare+for+Android+Smartphones"},"https://confluence.dimagi.com/display/commcarepublic/Install+CommCare+for+Android+Smartphones"))),(0,i.kt)("h4",{id:"app-versioning"},"App Versioning"),(0,i.kt)("p",null,"Ensure that you are always using the latest app version when testing, by\nupdating your app and checking that the version matches the latest version in\nCommCare HQ."),(0,i.kt)("h3",{id:"exporting-metadata"},"Exporting Metadata"),(0,i.kt)("p",null,"Use this\n",(0,i.kt)("a",{parentName:"p",href:"https://confluence.dimagi.com/display/commcarepublic/Export+Form+Contents"},"link"),"\nto ",(0,i.kt)("strong",{parentName:"p"},"export form contents"),". This will give you access to all the ",(0,i.kt)("inlineCode",{parentName:"p"},"question ids"),"\nand ",(0,i.kt)("inlineCode",{parentName:"p"},"labels")," in the CommCare form that are helpful for designing your\nintegration and mapping data elements."),(0,i.kt)("h3",{id:"unique-identifiers"},"Unique Identifiers"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"As CommCare data is stored in forms and cases, there are two types of UIDs in\nCommCare: ",(0,i.kt)("inlineCode",{parentName:"p"},"case_id")," & ",(0,i.kt)("inlineCode",{parentName:"p"},"form id"),". You can search for a particular case or form\nsubmission in CommCare by using the ",(0,i.kt)("inlineCode",{parentName:"p"},"Find Data by ID")," feature here:\n",(0,i.kt)("a",{parentName:"p",href:"https://confluence.dimagi.com/display/commcarepublic/Find+Data+by+ID"},"https://confluence.dimagi.com/display/commcarepublic/Find+Data+by+ID"),". For\nexample, if you received a submission in the OpenFn inbox that you would like\nto find in CommCare, search by ",(0,i.kt)("inlineCode",{parentName:"p"},"form id"),". If you'd like to find a particular\ncase (i.e. person, event, etc) search by ",(0,i.kt)("inlineCode",{parentName:"p"},"case id"),".",(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/80456839/128649444-04f371ea-80b1-4c28-8d42-1591c0a96758.png",alt:"image"}))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"In the OpenFn\n",(0,i.kt)("a",{parentName:"p",href:"https://docs.openfn.org/documentation/getting-started/overview#messages"},"message"),":\n",(0,i.kt)("inlineCode",{parentName:"p"},"id")," is the unique identifier for the form submission\n",(0,i.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/80456839/128649481-83b3f7ee-c6a6-42f8-8752-2f4e96b7fa1f.png",alt:"image"}))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"case_id")," is the unique identifier for the case being updated by the form. For\nexample, the ",(0,i.kt)("inlineCode",{parentName:"p"},"case_id")," can be the UID for a person.\n",(0,i.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/80456839/128649509-098a5418-4b72-4cec-a4d2-47c8bedaac25.png",alt:"image"})))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"N.B.")," Unique identifiers and ",(0,i.kt)("inlineCode",{parentName:"p"},"hidden fields")," in CommCare forms: Make sure\nthat unique identifiers for forms and objects are always in the form. If the\nunique identifier isn't relevant for the user, it can be added to the form as a\n",(0,i.kt)("inlineCode",{parentName:"p"},"hidden field"),". Learn more about ",(0,i.kt)("inlineCode",{parentName:"p"},"hidden fields")," here:\n",(0,i.kt)("a",{parentName:"p",href:"https://confluence.dimagi.com/display/commcarepublic/Hidden+Value+Calculations+Tutorial"},"https://confluence.dimagi.com/display/commcarepublic/Hidden+Value+Calculations+Tutorial")),(0,i.kt)("h3",{id:"data-element-mapping-notes"},"Data Element Mapping Notes"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Labels")," are generally not mapped in an integration because they represent text\nthat is displayed to the CommCare user to facilitate easy use of the\napplication. ",(0,i.kt)("inlineCode",{parentName:"p"},"Ids")," however, represent actual data that should be mapped."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"When mapping ",(0,i.kt)("inlineCode",{parentName:"li"},"multiple choice")," questions, make sure to consider how the answer\nchoices should map to the source/destination system.")),(0,i.kt)("h2",{id:"common-errors"},"Common Errors"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Docs in progress!\n")),(0,i.kt)("h2",{id:"openfn-adaptors"},"OpenFn Adaptors"),(0,i.kt)("p",null,"OpenFn implementations can leverage both the\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/OpenFn/language-http"},(0,i.kt)("inlineCode",{parentName:"a"},"HTTP"))," and\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/OpenFn/language-commcare"},(0,i.kt)("inlineCode",{parentName:"a"},"CommCare"))," adaptors to connect\nwith the CommCare API."),(0,i.kt)("h2",{id:"implementation-examples"},"Implementation Examples"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"MiracleFeet (CommCare-to-Salesforce sync):\n",(0,i.kt)("a",{parentName:"li",href:"https://github.com/OpenFn/miracle-feet"},"https://github.com/OpenFn/miracle-feet")),(0,i.kt)("li",{parentName:"ul"},"Lwala (CommCare-Salesforce 2-way sync): ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/OpenFn/lwala"},"https://github.com/OpenFn/lwala")),(0,i.kt)("li",{parentName:"ul"},"Grassroot Soccer (CommCare-to-Salesforce sync):\n",(0,i.kt)("a",{parentName:"li",href:"https://github.com/OpenFn/grassroot-soccer"},"https://github.com/OpenFn/grassroot-soccer"))))}d.isMDXComponent=!0}}]);