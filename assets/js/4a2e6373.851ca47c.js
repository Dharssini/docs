(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{156:function(e,n,a){"use strict";a.r(n),a.d(n,"frontMatter",(function(){return i})),a.d(n,"metadata",(function(){return l})),a.d(n,"toc",(function(){return o})),a.d(n,"default",(function(){return d}));var t=a(3),r=a(8),_=(a(0),a(336)),i={title:"Create Person in CommCare with commcare",sidebar_label:"Create Person in CommCare",id:"Create Person in CommCare-2017-01-31",keywords:["library","job","expression","commcare","dataValue","field","fields","submit"]},l={unversionedId:"jobs/auto/Create Person in CommCare-2017-01-31",id:"jobs/auto/Create Person in CommCare-2017-01-31",isDocsHomePage:!1,title:"Create Person in CommCare with commcare",description:"This job was provided by an OpenFn.org user via the job library API.",source:"@site/library/jobs/auto/Create Person in CommCare-2017-01-31.md",sourceDirName:"jobs/auto",slug:"/jobs/auto/Create Person in CommCare-2017-01-31",permalink:"/library/jobs/auto/Create Person in CommCare-2017-01-31",version:"current",sidebar_label:"Create Person in CommCare",frontMatter:{title:"Create Person in CommCare with commcare",sidebar_label:"Create Person in CommCare",id:"Create Person in CommCare-2017-01-31",keywords:["library","job","expression","commcare","dataValue","field","fields","submit"]},sidebar:"library",previous:{title:"Create Person in CommCare V2 with commcare",permalink:"/library/jobs/auto/Create Person in CommCare V2-2019-10-04"},next:{title:"Update Household in CommCare V2 with commcare",permalink:"/library/jobs/auto/Update Household in CommCare V2-2019-10-04"}},o=[{value:"Metadata",id:"metadata",children:[]},{value:"Key Functions",id:"key-functions",children:[]},{value:"Expression",id:"expression",children:[]}],s={toc:o};function d(e){var n=e.components,a=Object(r.a)(e,["components"]);return Object(_.b)("wrapper",Object(t.a)({},s,a,{components:n,mdxType:"MDXLayout"}),Object(_.b)("em",null,"This job was provided by an OpenFn.org user via the job library API."),Object(_.b)("h2",{id:"metadata"},"Metadata"),Object(_.b)("ul",null,Object(_.b)("li",{parentName:"ul"},"Name: Create Person in CommCare"),Object(_.b)("li",{parentName:"ul"},"Adaptor: ",Object(_.b)("inlineCode",{parentName:"li"},"@openfn/language-commcare")),Object(_.b)("li",{parentName:"ul"},"Adaptor Version: ",Object(_.b)("inlineCode",{parentName:"li"},"latest")),Object(_.b)("li",{parentName:"ul"},"Created over 4 years ago"),Object(_.b)("li",{parentName:"ul"},"Updated 8 months ago")),Object(_.b)("h2",{id:"key-functions"},"Key Functions"),Object(_.b)("p",null,Object(_.b)("inlineCode",{parentName:"p"},"dataValue"),", ",Object(_.b)("inlineCode",{parentName:"p"},"field"),", ",Object(_.b)("inlineCode",{parentName:"p"},"fields"),", ",Object(_.b)("inlineCode",{parentName:"p"},"submit")),Object(_.b)("h2",{id:"expression"},"Expression"),Object(_.b)("pre",null,Object(_.b)("code",{parentName:"pre",className:"language-js"},"submit(\n  fields(\n    field('@', state => {\n      return {\n        'xmlns:jrm': 'http://dev.commcarehq.org/jr/xforms',\n        xmlns:\n          'http://openrosa.org/formdesigner/7BDB73FA-AEF1-46A2-929A-AA92813C5D38',\n        uiVersion: '1',\n        version: '967',\n        name: 'Enroll a Person',\n      };\n    }),\n    field('Source', 0),\n    field('sfid', dataValue('new[0].Id')),\n    field('Basic_Information', state => {\n      return {\n        Record_Type: () => {\n          return dataValue('new[0].Record_Type_Name__c')(state)\n            .toString()\n            .replace(/ /g, '_');\n        },\n        //field(\"CHW_Name\",dataValue(\"new[0].\")),\n        Child_Status: dataValue('new[0].Child_Status__c')(state),\n        Person_Name: dataValue('new[0].Name')(state),\n        DOB: dataValue('new[0].Date_of_Birth__c')(state),\n        Final_Gender: dataValue('new[0].Gender__c')(state),\n        Marital_Status: dataValue('new[0].Marital_Status__c')(state),\n        Contact_Info: {\n          Phone_Number: dataValue('new[0].Telephone__c')(state),\n          Next_of_Kin: dataValue('new[0].Next_of_Kin__c')(state),\n          Next_of_Kin_Phone: dataValue('new[0].Next_of_Kin_Phone__c')(state),\n        },\n        Education_Level: dataValue('new[0].Education_Level__c')(state),\n        Final_Program: () => {\n          var program = '';\n          if (\n            dataValue('new[0].Active_in_Thrive_Thru_5__c')(state) == 'Yes' ||\n            dataValue('new[0].Active_TT5_Mother__c')(state) == 'Yes'\n          ) {\n            if (dataValue('new[0].Active_in_HAWI__c')(state) == 'Yes') {\n              program = 'Both';\n            } else {\n              program = 'Thrive_Through_5';\n            }\n          } else {\n            if (dataValue('new[0].Active_in_HAWI__c')(state) == 'Yes') {\n              program = 'HAWI';\n            } else {\n              program = 'something else';\n            }\n          }\n          return program;\n        },\n        Active_in_HAWI: dataValue('new[0].Active_in_HAWI__c')(state),\n        Active_in_TT5: dataValue('new[0].Active_in_Thrive_Thru_5__c')(state),\n        Ever_on_Family_Planning: dataValue('new[0].Ever_on_Family_Planning__c')(\n          state\n        ),\n        Currently_on_family_planning: dataValue('new[0].Family_Planning__c')(\n          state\n        ),\n        Family_Planning_Method: dataValue('new[0].Family_Planning_Method__c')(\n          state\n        ),\n      };\n    }),\n    field('TT5', state => {\n      return {\n        Mother_Information: {\n          Pregnant: () => {\n            if (dataValue('new[0].Pregnant__c')(state) === true) {\n              return 'Yes';\n            }\n          },\n          Pregnancy_Information: {\n            Gravida: dataValue('new[0].Gravida__c')(state),\n            Parity: dataValue('new[0].Parity__c')(state),\n          },\n        },\n        Child_Information: {\n          LMP: dataValue('new[0].LMP__c')(state),\n          EDD: dataValue('new[0].EDD__c')(state),\n          ANC_1: dataValue('new[0].ANC_1__c')(state),\n          ANC_2: dataValue('new[0].ANC_2__c')(state),\n          ANC_3: dataValue('new[0].ANC_3__c')(state),\n          ANC_4: dataValue('new[0].ANC_4__c')(state),\n          ANC_5: dataValue('new[0].ANC_5__c')(state),\n          Delivery_Information: {\n            Skilled_Unskilled: () => {\n              var val = '';\n              if (dataValue('new[0].Place_of_Delivery__c')(state) == 'Home') {\n                val = 'Unskilled';\n              } else if (\n                dataValue('new[0].Place_of_Delivery__c')(state) == 'Facility'\n              ) {\n                val = 'Skilled';\n              }\n              return val;\n            },\n            Birth_Facility: dataValue('new[0].Delivery_Facility__c')(state),\n          },\n          Immunizations: {\n            BCG: dataValue('new[0].BCG__c')(state),\n            OPV_0: dataValue('new[0].OPV_0__c')(state),\n            OPV_PCV_Penta_1: dataValue('new[0].OPV_1__c')(state),\n            OPV_PCV_Penta_2: dataValue('new[0].OPV_2__c')(state),\n            OPV_PCV_Penta_3: dataValue('new[0].OPV_3__c')(state),\n            Measles_6: dataValue('new[0].Measles_6__c')(state),\n            Measles_9: dataValue('new[0].Measles_9__c')(state),\n            Measles_18: dataValue('new[0].Measles_18__c')(state),\n          },\n        },\n      };\n    }),\n    field('HAWI', state => {\n      return {\n        Unique_Patient_Code: dataValue('new[0].Unique_Patient_Code__c')(state),\n        Active_in_Support_Group: dataValue('new[0].Active_in_Support_Group__c')(\n          state\n        ),\n        ART: dataValue('new[0].Currently_on_ART_s__c    ')(state),\n        ARVs: dataValue('new[0].ART_Regimen__c')(state),\n        Preferred_Care_Facility: dataValue('new[0].Preferred_Care_Facility__c')(\n          state\n        ),\n        //Need ANC's, etc.\n      };\n    }),\n    field('subcase_0', state => {\n      return {\n        'n0:case': {\n          '@': {\n            case_id: dataValue('new[0].Id')(state),\n            date_modified: new Date().toISOString(),\n            user_id: 'e298884bfb6ee2d2b38591a6e8ae0228',\n            'xmlns:n0': 'http://commcarehq.org/case/transaction/v2',\n          },\n          'n0:create': {\n            'n0:case_name': dataValue('new[0].Name')(state),\n            'n0:owner_id': () => {\n              var id = '';\n              if (\n                (dataValue('new[0].chw_owner_id__c')(state) === undefined &&\n                  dataValue('chw')(state) === undefined) ||\n                dataValue('chw')(state) == 'null'\n              ) {\n                id = 'acf8595692c76095eb5afd809c628091';\n              } else if (\n                dataValue('new[0].chw_owner_id__c')(state) === undefined\n              ) {\n                id = dataValue('chw')(state);\n              } else {\n                id = dataValue('new[0].chw_owner_id__c')(state);\n              }\n              return id;\n            },\n            'n0:case_type': 'Person',\n          },\n          'n0:update': {\n            'n0:ANC_1': dataValue('new[0].ANC_1__c')(state),\n            'n0:ANC_2': dataValue('new[0].ANC_2__c')(state),\n            'n0:ANC_3': dataValue('new[0].ANC_3__c')(state),\n            'n0:ANC_4': dataValue('new[0].ANC_4__c')(state),\n            'n0:ANC_5': dataValue('new[0].ANC_5__c')(state),\n            'n0:Active_in_OSG_Mentoring': dataValue('new[0].Active_in_OSG__c')(\n              state\n            ),\n            'n0:OSG_Mentoring_Group': dataValue('new[0].OSG_Group__c')(state),\n            'n0:sfid': dataValue('new[0].Id')(state),\n            'n0:BCG': dataValue('new[0].BCG__c')(state),\n            'n0:Delivery_Type': () => {\n              var val = '';\n              if (dataValue('new[0].Place_of_Delivery__c')(state) == 'Home') {\n                val = 'Unskilled';\n              } else if (\n                dataValue('new[0].Place_of_Delivery__c')(state) == 'Facility'\n              ) {\n                val = 'Skilled';\n              }\n              return val;\n            },\n            'n0:Delivery_Facility': dataValue('new[0].Delivery_Facility__c')(\n              state\n            ),\n            'n0:Family_Planning_Method': dataValue(\n              'new[0].Family_Planning_Method__c'\n            )(state),\n            'n0:Child_Status': dataValue('new[0].Child_Status__c')(state),\n            'n0:OPV_0': dataValue('new[0].OPV_0__c')(state),\n            'n0:OPV_PCV_Penta_1': dataValue('new[0].OPV_1__c')(state),\n            'n0:OPV_PCV_Penta_2': dataValue('new[0].OPV_2__c')(state),\n            'n0:OPV_PCV_Penta_3': dataValue('new[0].OPV_3__c')(state),\n            'n0:Measles_6': dataValue('new[0].Measles_6__c')(state),\n            'n0:Exclusive_Breastfeeding': dataValue(\n              'new[0].Exclusive_Breastfeeding__c'\n            )(state),\n            'n0:LMP': dataValue('new[0].LMP__c')(state),\n            'n0:EDD': dataValue('new[0].EDD__c')(state),\n            'n0:Measles_9': dataValue('new[0].Measles_9__c')(state),\n            'n0:Measles_18': dataValue('new[0].Measles_18__c')(state),\n            'n0:Pregnant': () => {\n              if (dataValue('new[0].Pregnant__c')(state) === true) {\n                return 'Yes';\n              }\n            },\n            'n0:ART': dataValue('new[0].Currently_on_ART_s__c')(state),\n            'n0:ARVs': dataValue('new[0].ART_Regimen__c')(state),\n            'n0:Active_in_Support_Group': dataValue(\n              'new[0].Active_in_Support_Group__c'\n            )(state),\n            'n0:Client_Program': () => {\n              var program = '';\n              if (\n                dataValue(\n                  'new[0].Active_in_Thrive_Thru_5__c' ||\n                    dataValue('new[0].Active_TT5_Mother__c')(state) == 'Yes'\n                )(state) == 'Yes'\n              ) {\n                if (dataValue('new[0].Active_in_HAWI__c')(state) == 'Yes') {\n                  program = 'Both';\n                } else {\n                  program = 'Thrive_Through_5';\n                }\n              } else {\n                if (dataValue('new[0].Active_in_HAWI__c')(state) == 'Yes') {\n                  program = 'HAWI';\n                }\n              }\n              return program;\n            },\n            'n0:Currently_on_family_planning': dataValue(\n              'new[0].Family_Planning__c'\n            )(state),\n            'n0:DOB': dataValue('new[0].Date_of_Birth__c')(state),\n            'n0:Education_Level': () => {\n              if (dataValue('new[0].Education_Level__c')(state) !== undefined) {\n                return dataValue('new[0].Education_Level__c')(state)\n                  .toString()\n                  .replace(/ /g, '_');\n              }\n            },\n            'n0:Ever_on_Family_Planning': dataValue(\n              'new[0].Ever_on_Family_Planning__c'\n            )(state),\n            'n0:Gender': dataValue('new[0].Gender__c')(state),\n            'n0:Gravida': dataValue('new[0].Gravida__c')(state),\n            'n0:Active_in_TT5': dataValue('new[0].Active_in_Thrive_Thru_5__c')(\n              state\n            ),\n            'n0:Active_in_HAWI__c': dataValue('new[0].Active_in_HAWI__c')(\n              state\n            ),\n            'n0:Marital_Status': dataValue('new[0].Marital_Status__c')(state),\n            'n0:Next_of_Kin': dataValue('new[0].Next_of_Kin__c')(state),\n            'n0:Next_of_Kin_Phone': dataValue('new[0].Next_of_Kin_Phone__c')(\n              state\n            ),\n            'n0:Parity': dataValue('new[0].Parity__c')(state),\n            'n0:Phone_Number': dataValue('new[0].Telephone__c')(state),\n            'n0:Preferred_Care_Facility': dataValue(\n              'new[0].Preferred_Care_Facility__c'\n            )(state),\n            'n0:Record_Type': () => {\n              return dataValue('new[0].Record_Type_Name__c')(state)\n                .toString()\n                .replace(/ /g, '_');\n            },\n            'n0:Unique_Patient_Code': dataValue(\n              'new[0].Unique_Patient_Code__c'\n            )(state),\n          },\n          'n0:index': {\n            'n0:parent': {\n              '@': { case_type: 'Household' },\n              '#': () => {\n                var id = '';\n                if (\n                  dataValue('new[0].CommCare_HH_Code__c')(state) === undefined\n                ) {\n                  id = dataValue('Code')(state);\n                } else {\n                  id = dataValue('new[0].CommCare_HH_Code__c')(state);\n                }\n                return id;\n              },\n            },\n          },\n        },\n      };\n    }),\n    field('n1:case', state => {\n      return {\n        '@': {\n          case_id: () => {\n            var id = '';\n            if (dataValue('new[0].CommCare_HH_Code__c')(state) === undefined) {\n              id = dataValue('Code')(state);\n            } else {\n              id = dataValue('new[0].CommCare_HH_Code__c')(state);\n            }\n            return id;\n          },\n          date_modified: new Date().toISOString(),\n          user_id: 'e298884bfb6ee2d2b38591a6e8ae0228',\n          'xmlns:n1': 'http://commcarehq.org/case/transaction/v2',\n        },\n        'n1:update': {\n          'n1:Female_Head_Name': dataValue('female')(state),\n          'n1:Male_Head_Name': dataValue('male')(state),\n        },\n      };\n    }),\n    field('n2:meta', state => {\n      return {\n        '@': { 'xmlns:n2': 'http://openrosa.org/jr/xforms' },\n        'n2:deviceID': 'Formplayer',\n        'n2:timeStart': new Date().toISOString(),\n        'n2:timeEnd': new Date().toISOString(),\n        'n2:userID': 'e298884bfb6ee2d2b38591a6e8ae0228',\n      };\n    })\n  )\n);\n\n")))}d.isMDXComponent=!0},336:function(e,n,a){"use strict";a.d(n,"a",(function(){return c})),a.d(n,"b",(function(){return p}));var t=a(0),r=a.n(t);function _(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function i(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function l(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?i(Object(a),!0).forEach((function(n){_(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function o(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},_=Object.keys(e);for(t=0;t<_.length;t++)a=_[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(e);for(t=0;t<_.length;t++)a=_[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createContext({}),d=function(e){var n=r.a.useContext(s),a=n;return e&&(a="function"==typeof e?e(n):l(l({},n),e)),a},c=function(e){var n=d(e.components);return r.a.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},m=r.a.forwardRef((function(e,n){var a=e.components,t=e.mdxType,_=e.originalType,i=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),c=d(a),m=t,p=c["".concat(i,".").concat(m)]||c[m]||u[m]||_;return a?r.a.createElement(p,l(l({ref:n},s),{},{components:a})):r.a.createElement(p,l({ref:n},s))}));function p(e,n){var a=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var _=a.length,i=new Array(_);i[0]=m;var l={};for(var o in n)hasOwnProperty.call(n,o)&&(l[o]=n[o]);l.originalType=e,l.mdxType="string"==typeof e?e:t,i[1]=l;for(var s=2;s<_;s++)i[s]=a[s];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,a)}m.displayName="MDXCreateElement"}}]);