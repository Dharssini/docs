"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[39808],{95788:(e,n,t)=>{t.d(n,{Iu:()=>d,yg:()=>y});var a=t(11504);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var p=a.createContext({}),l=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},d=function(e){var n=l(e.components);return a.createElement(p.Provider,{value:n},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},g=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,p=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=l(t),g=o,y=u["".concat(p,".").concat(g)]||u[g]||c[g]||i;return t?a.createElement(y,r(r({ref:n},d),{},{components:t})):a.createElement(y,r({ref:n},d))}));function y(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,r=new Array(i);r[0]=g;var s={};for(var p in n)hasOwnProperty.call(n,p)&&(s[p]=n[p]);s.originalType=e,s[u]="string"==typeof e?e:o,r[1]=s;for(var l=2;l<i;l++)r[l]=t[l];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}g.displayName="MDXCreateElement"},25500:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>r,default:()=>c,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var a=t(45072),o=(t(11504),t(95788));const i={title:"Configure Steps"},r=void 0,s={unversionedId:"build/steps/steps",id:"build/steps/steps",title:"Configure Steps",description:"A Step is a specific task or activity in a workflow. Each Step is linked to an",source:"@site/docs/build/steps/steps.md",sourceDirName:"build/steps",slug:"/build/steps/",permalink:"/documentation/next/build/steps/",draft:!1,editUrl:"https://github.com/openfn/docs/edit/main/docs/build/steps/steps.md",tags:[],version:"current",frontMatter:{title:"Configure Steps"},sidebar:"docs",previous:{title:"Limits",permalink:"/documentation/next/build/limits"},next:{title:"Design your Step",permalink:"/documentation/next/build/steps/step-design-intro"}},p={},l=[{value:"Create or edit a Step",id:"create-or-edit-a-step",level:2},{value:"Configure the Step",id:"configure-the-step",level:2},{value:"Choose an Adaptor",id:"choose-an-adaptor",level:2},{value:"Choose an Adaptor Version",id:"choose-an-adaptor-version",level:3},{value:"Managing Adaptor Versions",id:"managing-adaptor-versions",level:3},{value:"Run &amp; Test Steps",id:"run--test-steps",level:2},{value:"Add business logic or data transformation rules",id:"add-business-logic-or-data-transformation-rules",level:2}],d={toc:l},u="wrapper";function c(e){let{components:n,...i}=e;return(0,o.yg)(u,(0,a.c)({},d,i,{components:n,mdxType:"MDXLayout"}),(0,o.yg)("p",null,"A Step is a specific task or activity in a workflow. Each Step is linked to an\n",(0,o.yg)("a",{parentName:"p",href:"/adaptors/"},"Adaptor")," and contains business logic to perform a specific task or\noperation in that target app. Read on to learn more."),(0,o.yg)("h2",{id:"create-or-edit-a-step"},"Create or edit a Step"),(0,o.yg)("p",null,"Via the Workflow Canvas, click the plus ",(0,o.yg)("inlineCode",{parentName:"p"},"+")," icon to create a ",(0,o.yg)("em",{parentName:"p"},"new")," Step, or\nclick on existing Step to view or configure its key components."),(0,o.yg)("h2",{id:"configure-the-step"},"Configure the Step"),(0,o.yg)("p",null,"When configuring a Step, you must understand its basic anatomy."),(0,o.yg)("p",null,(0,o.yg)("img",{alt:"Step Anatomy",src:t(58912).c,width:"960",height:"540"})),(0,o.yg)("p",null,"A Step includes these key components:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"Name")," - A human-readable name describing the Step and its purpose."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"Adaptor")," - The selected ",(0,o.yg)("a",{parentName:"li",href:"/adaptors/"},"Adaptor")," that is used to provide\napp-specific functionality for this Step (e.g., ",(0,o.yg)("inlineCode",{parentName:"li"},"dhis2")," or ",(0,o.yg)("inlineCode",{parentName:"li"},"commcare"),")."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"Adaptor Version")," - The version of the selected Adaptor, which determines\nwhich API endpoints and Adaptor functions are available. See below section to\nlearn more."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"Credentials")," - The Credential used to authorize connections to the target app\nrelated to this Step."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"Expression"),' - The step "script" or ',(0,o.yg)("inlineCode",{parentName:"li"},"Job expression")," that defines the business\nlogic and/or sequence of operations to be executed")),(0,o.yg)("h2",{id:"choose-an-adaptor"},"Choose an Adaptor"),(0,o.yg)("p",null,"We've got a whole section on creating new ",(0,o.yg)("a",{parentName:"p",href:"/adaptors"},"Adaptors"),", but the\ncritical thing to be aware of when writing a step is that you've got to choose\nan ",(0,o.yg)("strong",{parentName:"p"},"Adaptor"),", and an ",(0,o.yg)("strong",{parentName:"p"},"Adaptor Version"),"."),(0,o.yg)("p",null,"All of the discussion below of helper functions like ",(0,o.yg)("inlineCode",{parentName:"p"},"create")," or ",(0,o.yg)("inlineCode",{parentName:"p"},"findPatient"),"\nrequires some understanding of adaptors. When you run a step, you're borrowing a\nlayer of functionality that's been built to connect with some specific API, type\nof API, or database."),(0,o.yg)("p",null,"For example, ",(0,o.yg)("inlineCode",{parentName:"p"},"create")," means one thing in the ",(0,o.yg)("inlineCode",{parentName:"p"},"salesforce")," Adaptor and another\nthing entirely in ",(0,o.yg)("inlineCode",{parentName:"p"},"dhis2"),". For this reason, before you can begin writing a step\nyou have to decide which ",(0,o.yg)("a",{parentName:"p",href:"/adaptors/"},"Adaptor")," to work with."),(0,o.yg)("h3",{id:"choose-an-adaptor-version"},"Choose an Adaptor Version"),(0,o.yg)("p",null,'Adaptors change over time. They\'re open source, and we encourage as much\ncontribution as possible\u2014releasing new versions for use on OpenFn.org as soon as\nthey pass our security reviews. New features may be added and bugs may be fixed,\nbut in order to make sure that an existing integration is not broken, we\nrecommend that you select a specific version (rather than using the\n"auto-upgrade" feature) when you choose an adaptor. The highest released version\nis the default choice here.'),(0,o.yg)("admonition",{type:"tip"},(0,o.yg)("p",{parentName:"admonition"},"The ",(0,o.yg)("em",{parentName:"p"},"first 4 lines")," in the log of any run on OpenFn will tell you what adaptor\nyou're running. (As well as the version of worker, engine and NodeJs) This is\nincredibly important, particularly if you're trying to troubleshoot steps in\nvarious environments (like your own shell, app.openfn.org etc.).")),(0,o.yg)("p",null,"Pay careful attention to which ",(0,o.yg)("inlineCode",{parentName:"p"},"version")," you're using to write a step. Consider\nthe following run logs:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sh"},"Versions for run f470a3da-8b90-480e-a94f-6dd982c91afe:\n    \u25b8 node.js                     18.19.0\n    \u25b8 worker                      0.5.0\n    \u25b8 engine                      0.2.6\n    \u25b8 @openfn/language-primero    2.9.1\n...more logs here...\n")),(0,o.yg)("h3",{id:"managing-adaptor-versions"},"Managing Adaptor Versions"),(0,o.yg)("p",null,"While it may be beneficial to upgrade as part of your routine maintenance, these\nupgrades should be carefully tested. Most often, customers upgrade to a new\nadaptor version for an existing step when they are making business-drives\nchanges to that step. Some business-driven changes may actually ",(0,o.yg)("em",{parentName:"p"},"require"),"\nupgrading the version in order to use a new feature from the adaptor. Even if\nthose changes don't require and upgrade, if the technical team must spend time\ntesting step-specific changes anyway, it may be an ideal opportunity to test\nalso test an upgrade."),(0,o.yg)("p",null,"Adaptors follow ",(0,o.yg)("a",{parentName:"p",href:"https://semver.org/"},"SEMVER")," so you can be reasonably assured\nthat upgrading from ",(0,o.yg)("inlineCode",{parentName:"p"},"x.1.z")," to ",(0,o.yg)("inlineCode",{parentName:"p"},"x.2.z")," will not lead to existing step code\nfailing, but an upgrade from ",(0,o.yg)("inlineCode",{parentName:"p"},"3.y.z")," to ",(0,o.yg)("inlineCode",{parentName:"p"},"4.y.z")," may\u2014in SEMVER ",(0,o.yg)("em",{parentName:"p"},"major")," upgrades\n(those that change the first number in the ",(0,o.yg)("inlineCode",{parentName:"p"},"x.y.z"),' version number) have\n"breaking" or "non-backwards compatible" changes.'),(0,o.yg)("admonition",{type:"tip"},(0,o.yg)("p",{parentName:"admonition"},"When you configure a Step, you can select a specific ",(0,o.yg)("inlineCode",{parentName:"p"},"Adaptor Version")," to\nversion-lock your Step. Avoid selecting ",(0,o.yg)("inlineCode",{parentName:"p"},"latest")," for Adaptor Version, if you\nwant this and to avoid the risk of accidental upgrades on live Workflows.")),(0,o.yg)("h2",{id:"run--test-steps"},"Run & Test Steps"),(0,o.yg)("p",null,"When running Steps to test the configuration, every Run will have an initial\nstate (which may contain an ",(0,o.yg)("inlineCode",{parentName:"p"},"Input"),") and results in a final state that will\ninclude ",(0,o.yg)("inlineCode",{parentName:"p"},"Logs")," and an ",(0,o.yg)("inlineCode",{parentName:"p"},"Output"),"."),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"Input")," - Data (JSON) that is used as the starting Input for a Step to utilise\nin its run. An Input can exist for a Work Order and individual Steps within a\nRun, though it is possible for either to exist without an Input."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"Output")," - Data (JSON) that is created as the Output of a Step's execution. An\nOutput can exist for a Work Order and individual jobs within a run, and\ntypically contains the data sent to the target app."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"Logs")," - A record generated by the workflow execution engine that details the\nactivities performed when running a Workflow or individual Step.")),(0,o.yg)("p",null,"See ",(0,o.yg)("a",{parentName:"p",href:"/documentation/next/build/steps/step-editor"},"Edit Steps")," for more on making changes\nand testing, and see ",(0,o.yg)("a",{parentName:"p",href:"/documentation/next/build/steps/state"},"this article"),' for more on the\nconcept of "state" when writing Jobs and building OpenFn Workflows.'),(0,o.yg)("h2",{id:"add-business-logic-or-data-transformation-rules"},"Add business logic or data transformation rules"),(0,o.yg)("p",null,"Click the code button ",(0,o.yg)("inlineCode",{parentName:"p"},"</>"),' displayed on the configuration panel to write or\nedit a Job expression to define the "rules" or the specific tasks to be\ncompleted by your Step. See the pages on\n',(0,o.yg)("a",{parentName:"p",href:"/documentation/next/build/steps/step-editor"},"the Inspector")," and\n",(0,o.yg)("a",{parentName:"p",href:"/documentation/next/build/steps/job-expressions"},"writing Job expressions")," to learn more."))}c.isMDXComponent=!0},58912:(e,n,t)=>{t.d(n,{c:()=>a});const a=t.p+"assets/images/step-anatomy-05780d1aaccb7078303f94ec496b771c.png"}}]);