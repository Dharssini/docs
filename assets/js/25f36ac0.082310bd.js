(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{123:function(e,n,a){"use strict";a.r(n),a.d(n,"frontMatter",(function(){return i})),a.d(n,"metadata",(function(){return l})),a.d(n,"toc",(function(){return s})),a.d(n,"default",(function(){return u}));var t=a(3),r=a(8),_=(a(0),a(331)),i={title:"Update Person in CommCare with commcare",sidebar_label:"Update Person in CommCare",id:"Update Person in CommCare-2017-02-03",keywords:["library","job","expression","commcare","dataValue","field","fields","submit"]},l={unversionedId:"jobs/auto/Update Person in CommCare-2017-02-03",id:"jobs/auto/Update Person in CommCare-2017-02-03",isDocsHomePage:!1,title:"Update Person in CommCare with commcare",description:"This job was provided by an OpenFn.org user via the job library API.",source:"@site/library/jobs/auto/Update Person in CommCare-2017-02-03.md",sourceDirName:"jobs/auto",slug:"/jobs/auto/Update Person in CommCare-2017-02-03",permalink:"/library/jobs/auto/Update Person in CommCare-2017-02-03",version:"current",sidebar_label:"Update Person in CommCare",frontMatter:{title:"Update Person in CommCare with commcare",sidebar_label:"Update Person in CommCare",id:"Update Person in CommCare-2017-02-03",keywords:["library","job","expression","commcare","dataValue","field","fields","submit"]},sidebar:"library",previous:{title:"Update Person in CommCare V2 with commcare",permalink:"/library/jobs/auto/Update Person in CommCare V2-2019-10-04"},next:{title:"COVID-19 TEI (dhis2) with dhis2",permalink:"/library/jobs/auto/COVID-19 TEI dhis2-2021-03-22"}},s=[{value:"Metadata",id:"metadata",children:[]},{value:"Key Functions",id:"key-functions",children:[]},{value:"Expression",id:"expression",children:[]}],o={toc:s};function u(e){var n=e.components,a=Object(r.a)(e,["components"]);return Object(_.b)("wrapper",Object(t.a)({},o,a,{components:n,mdxType:"MDXLayout"}),Object(_.b)("em",null,"This job was provided by an OpenFn.org user via the job library API."),Object(_.b)("h2",{id:"metadata"},"Metadata"),Object(_.b)("ul",null,Object(_.b)("li",{parentName:"ul"},"Name: Update Person in CommCare"),Object(_.b)("li",{parentName:"ul"},"Adaptor: ",Object(_.b)("inlineCode",{parentName:"li"},"@openfn/language-commcare")),Object(_.b)("li",{parentName:"ul"},"Adaptor Version: ",Object(_.b)("inlineCode",{parentName:"li"},"latest")),Object(_.b)("li",{parentName:"ul"},"Created over 4 years ago"),Object(_.b)("li",{parentName:"ul"},"Updated 8 months ago")),Object(_.b)("h2",{id:"key-functions"},"Key Functions"),Object(_.b)("p",null,Object(_.b)("inlineCode",{parentName:"p"},"dataValue"),", ",Object(_.b)("inlineCode",{parentName:"p"},"field"),", ",Object(_.b)("inlineCode",{parentName:"p"},"fields"),", ",Object(_.b)("inlineCode",{parentName:"p"},"submit")),Object(_.b)("h2",{id:"expression"},"Expression"),Object(_.b)("pre",null,Object(_.b)("code",{parentName:"pre",className:"language-js"},"submit(\n  fields(\n    field('@', state => {\n      return {\n        'xmlns:jrm': 'http://dev.commcarehq.org/jr/xforms',\n        xmlns:\n          'http://openrosa.org/formdesigner/a34af027a7fa943998c39f64bc84a337a668114a',\n        uiVersion: '1',\n        version: '81',\n        name: 'Update Person',\n      };\n    }),\n    field('Source', 0),\n    field('Status', state => {\n      return {\n        Client_Status: dataValue('new[0].Client_Status__c')(state),\n        Date_of_Transfer_Out: dataValue('new[0].Date_of_Transfer_Out__c')(\n          state\n        ),\n        Date_Last_Seen: dataValue('new[0].Date_Last_Seen__c')(state),\n        Date_of_Death: dataValue('new[0].Date_of_Death__c')(state),\n        Cause_of_Death: dataValue('new[0].Cause_of_Death__c')(state),\n      };\n    }),\n    field('Basic_Information', state => {\n      return {\n        Basic_Information: {\n          Phone_Number: dataValue('new[0].Telephone__c')(state),\n          Final_Program: () => {\n            var program = '';\n            if (\n              dataValue('new[0].Active_In_Thrive_Thru_5__c')(state) == 'Yes' ||\n              dataValue('new[0].Active_TT5_Mother__c')(state) == 'Yes'\n            ) {\n              if (dataValue('new[0].Active_In_HAWI__c')(state) == 'Yes') {\n                program = 'Both';\n              } else {\n                program = 'Thrive_Through_5';\n              }\n            } else {\n              if (dataValue('new[0].Active_In_HAWI__c')(state) == 'Yes') {\n                program = 'HAWI';\n              }\n            }\n            return program;\n          },\n        },\n      };\n    }),\n    field('TT5', state => {\n      return {\n        Child_Information: {\n          ANCs: {\n            ANC_1: dataValue('new[0].ANC_1__c')(state),\n            ANC_2: dataValue('new[0].ANC_2__c')(state),\n            ANC_3: dataValue('new[0].ANC_3__c')(state),\n            ANC_4: dataValue('new[0].ANC_4__c')(state),\n            ANC_5: dataValue('new[0].ANC_5__c')(state),\n          },\n          Delivery_Information: {\n            Person_Name: dataValue('new[0].Name')(state),\n            DOB: dataValue('new[0].Date_of_Birth__c')(state),\n            Delivery_Type: () => {\n              var val = '';\n              if (dataValue('new[0].Place_of_Delivery__c')(state) == 'Home') {\n                val = 'Unskilled';\n              } else if (\n                dataValue('new[0].Place_of_Delivery__c')(state) == 'Facility'\n              ) {\n                val = 'Skilled';\n              }\n              return val;\n            },\n            Delivery_Facility: dataValue('new[0].Delivery_Facility__c')(state),\n          },\n          Immunizations: {\n            BCG: dataValue('new[0].BCG__c')(state),\n            OPV_0: dataValue('new[0].OPV_0__c')(state),\n            OPV_PCV_Penta_1: dataValue('new[0].OPV_1__c')(state),\n            OPV_PCV_Penta_2: dataValue('new[0].OPV_2__c')(state),\n            OPV_PCV_Penta_3: dataValue('new[0].OPV_3__c')(state),\n            Measles_6: dataValue('new[0].Measles_6__c')(state),\n            Measles_9: dataValue('new[0].Measles_9__c')(state),\n            Measles_18: dataValue('new[0].Measles_18__c')(state),\n            Fully_Immunized: dataValue(\n              'new[0].Fully_Immunized_at_12_Months__c'\n            )(state),\n          },\n          /*\"CCMM\":{\n            \"Home_Test_Date\":dataValue(\"new[0].Measles_18__c\")(state),\n            \"Home_Test_Date\":dataValue(\"new[0].Measles_18__c\")(state),\n            \"Home_Test_Date\":dataValue(\"new[0].Measles_18__c\")(state),\n            \"Home_Test_Date\":dataValue(\"new[0].Measles_18__c\")(state),\n            \"Home_Test_Date\":dataValue(\"new[0].Measles_18__c\")(state),\n          }*/\n        },\n        Mother_Information: {\n          Pregnant: () => {\n            if (dataValue('new[0].Pregnant__c')(state) === true) {\n              return 'Yes';\n            }\n          },\n        },\n      };\n    }),\n    field('HAWI', state => {\n      return {\n        Unique_Patient_Code: dataValue('new[0].Unique_Patient_Code__c')(state),\n        Support_Group: dataValue('new[0].Active_in_Support_Group__c')(state),\n        Preferred_Care_F: {\n          Preferred_Care_Facility: dataValue(\n            'new[0].Preferred_Care_Facility__c'\n          )(state),\n        },\n      };\n    }),\n\n    field('n0:case', state => {\n      return {\n        '@': {\n          case_id: dataValue('new[0].CommCare_ID__c')(state),\n          date_modified: new Date().toISOString(),\n          user_id: 'e298884bfb6ee2d2b38591a6e8ae0228',\n          'xmlns:n0': 'http://commcarehq.org/case/transaction/v2',\n        },\n        'n0:create': {\n          'n0:case_name': () => {\n            var name1 = dataValue('new[0].Name')(state);\n            var name2 = name1.replace(/\\w\\S*/g, function (txt) {\n              return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n            });\n            return name2;\n          },\n          'n0:case_type': 'Person',\n          'n0:parent_id': dataValue('new[0].CommCare_HH_Code__c')(state),\n        },\n        'n0:update': {\n          'n0:ANC_1': dataValue('new[0].ANC_1__c')(state),\n\n          'n0:ANC_2': dataValue('new[0].ANC_2__c')(state),\n          'n0:ANC_3': dataValue('new[0].ANC_3__c')(state),\n          'n0:ANC_4': dataValue('new[0].ANC_4__c')(state),\n          'n0:ANC_5': dataValue('new[0].ANC_5__c')(state),\n          'n0:BCG': dataValue('new[0].BCG__c')(state),\n          'n0:Fully_Immunized': dataValue(\n            'new[0].Fully_Immunized_at_12_Months__c'\n          )(state),\n          'n0:Delivery_Type': () => {\n            var val = '';\n            if (dataValue('new[0].Place_of_Delivery__c')(state) == 'Home') {\n              val = 'Unskilled';\n            } else if (\n              dataValue('new[0].Place_of_Delivery__c')(state) == 'Facility'\n            ) {\n              val = 'Skilled';\n            }\n            return val;\n          },\n          'n0:Delivery_Facility': dataValue('new[0].Delivery_Facility__c')(\n            state\n          ),\n          'n0:Family_Planning_Method': dataValue(\n            'new[0].Family_Planning_Method__c'\n          )(state),\n          'n0:Child_Status': dataValue('new[0].Child_Status__c')(state),\n          'n0:Active_in_OSG_Mentoring': dataValue('new[0].Active_in_OSG__c')(\n            state\n          ),\n          'n0:OSG_Mentoring_Group': dataValue('new[0].OSG_Group__c')(state),\n          'n0:OPV_0': dataValue('new[0].OPV_0__c')(state),\n          'n0:OPV_PCV_Penta_1': dataValue('new[0].OPV_1__c')(state),\n          'n0:OPV_PCV_Penta_2': dataValue('new[0].OPV_2__c')(state),\n          'n0:OPV_PCV_Penta_3': dataValue('new[0].OPV_3__c')(state),\n          'n0:Current_Height': dataValue('new[0].Current_Height__c')(state),\n          'n0:Current_Weight': dataValue('new[0].Current_Weight__c')(state),\n          'n0:Current_MUAC': dataValue('new[0].Current_MUAC__c')(state),\n          'n0:Measles_6': dataValue('new[0].Measles_6__c')(state),\n          'n0:Measles_9': dataValue('new[0].Measles_9__c')(state),\n          'n0:LMP': dataValue('new[0].LMP__c')(state),\n          'n0:EDD': dataValue('new[0].EDD__c')(state),\n          'n0:Measles_18': dataValue('new[0].Measles_18__c')(state),\n          'n0:Pregnant': () => {\n            if (dataValue('new[0].Pregnant__c')(state) === true) {\n              return 'Yes';\n            }\n          },\n          'n0:ART': dataValue('new[0].Currently_on_ART_s__c')(state),\n          'n0:ARVs': dataValue('new[0].ART_Regimen__c')(state),\n          'n0:Active_in_Support_Group': dataValue(\n            'new[0].Active_in_Support_Group__c'\n          )(state),\n          'n0:Client_Program': () => {\n            var program = '';\n            if (\n              dataValue('new[0].Active_in_Thrive_Thru_5__c')(state) == 'Yes' ||\n              dataValue('new[0].Active_TT5_Mother__c')(state) == 'Yes'\n            ) {\n              if (dataValue('new[0].Active_in_HAWI__c')(state) == 'Yes') {\n                program = 'Both';\n              } else {\n                program = 'Thrive_Through_5';\n              }\n            } else {\n              if (dataValue('new[0].Active_in_HAWI__c')(state) == 'Yes') {\n                program = 'HAWI';\n              }\n            }\n            return program;\n          },\n          'n0:Currently_on_family_planning': dataValue(\n            'new[0].Family_Planning__c'\n          )(state),\n          'n0:DOB': dataValue('new[0].Date_of_Birth__c')(state),\n          'n0:Education_Level': () => {\n            if (dataValue('new[0].Education_Level__c')(state) !== undefined) {\n              return dataValue('new[0].Education_Level__c')(state)\n                .toString()\n                .replace(/ /g, '_');\n            }\n          },\n          'n0:Ever_on_Family_Planning': dataValue(\n            'new[0].Ever_on_Family_Planning__c'\n          )(state),\n          'n0:Gender': dataValue('new[0].Gender__c')(state),\n          'n0:Gravida': dataValue('new[0].Gravida__c')(state),\n          'n0:Active_in_TT5': dataValue('new[0].Active_in_Thrive_Thru_5__c')(\n            state\n          ),\n          'n0:Active_in_HAWI': dataValue('new[0].Active_in_HAWI__c')(state),\n          'n0:Marital_Status': dataValue('new[0].Marital_Status__c')(state),\n          'n0:Exclusive_Breastfeeding': dataValue(\n            'new[0].Exclusive_Breastfeeding__c'\n          )(state),\n          'n0:Next_of_Kin': dataValue('new[0].Next_of_Kin__c')(state),\n          'n0:Next_of_Kin_Phone': dataValue('new[0].Next_of_Kin_Phone__c')(\n            state\n          ),\n          'n0:Parity': dataValue('new[0].Parity__c')(state),\n\n          'n0:Phone_Number': dataValue('new[0].Telephone__c')(state),\n          'n0:Preferred_Care_Facility': dataValue(\n            'new[0].Preferred_Care_Facility__c'\n          )(state),\n          'n0:Record_Type': () => {\n            return dataValue('new[0].Record_Type_Name__c')(state)\n              .toString()\n              .replace(/ /g, '_');\n          },\n          'n0:Unique_Patient_Code': dataValue('new[0].Unique_Patient_Code__c')(\n            state\n          ),\n        },\n        'n0:index': {\n          'n0:parent': {\n            '@': {\n              case_type: 'Household',\n            },\n            '#': dataValue('new[0].CommCare_HH_Code__c')(state),\n          },\n        },\n      };\n    }),\n\n    field('n2:meta', state => {\n      return {\n        '@': { 'xmlns:n2': 'http://openrosa.org/jr/xforms' },\n        'n2:deviceID': 'Formplayer',\n        'n2:timeStart': new Date().toISOString(),\n        'n2:timeEnd': new Date().toISOString(),\n        'n2:userID': 'e298884bfb6ee2d2b38591a6e8ae0228',\n      };\n    })\n  )\n);\n\n")))}u.isMDXComponent=!0},331:function(e,n,a){"use strict";a.d(n,"a",(function(){return c})),a.d(n,"b",(function(){return p}));var t=a(0),r=a.n(t);function _(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function i(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function l(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?i(Object(a),!0).forEach((function(n){_(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function s(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},_=Object.keys(e);for(t=0;t<_.length;t++)a=_[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(e);for(t=0;t<_.length;t++)a=_[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=r.a.createContext({}),u=function(e){var n=r.a.useContext(o),a=n;return e&&(a="function"==typeof e?e(n):l(l({},n),e)),a},c=function(e){var n=u(e.components);return r.a.createElement(o.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},m=r.a.forwardRef((function(e,n){var a=e.components,t=e.mdxType,_=e.originalType,i=e.parentName,o=s(e,["components","mdxType","originalType","parentName"]),c=u(a),m=t,p=c["".concat(i,".").concat(m)]||c[m]||d[m]||_;return a?r.a.createElement(p,l(l({ref:n},o),{},{components:a})):r.a.createElement(p,l({ref:n},o))}));function p(e,n){var a=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var _=a.length,i=new Array(_);i[0]=m;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:t,i[1]=l;for(var o=2;o<_;o++)i[o]=a[o];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,a)}m.displayName="MDXCreateElement"}}]);