"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[28263],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},s=Object.keys(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=o.createContext({}),p=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=p(e.components);return o.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=p(n),m=r,f=c["".concat(l,".").concat(m)]||c[m]||d[m]||s;return n?o.createElement(f,a(a({ref:t},u),{},{components:n})):o.createElement(f,a({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,a=new Array(s);a[0]=c;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:r,a[1]=i;for(var p=2;p<s;p++)a[p]=n[p];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},80133:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>p});var o=n(87462),r=(n(67294),n(3905));const s={title:"Moodle"},a=void 0,i={unversionedId:"apps/moodle",id:"apps/moodle",title:"Moodle",description:"Aper\xe7u",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/apps/moodle.md",sourceDirName:"apps",slug:"/apps/moodle",permalink:"/fr/documentation/apps/moodle",draft:!1,editUrl:"https://github.com/openfn/docs/edit/main/docs/apps/moodle.md",tags:[],version:"current",frontMatter:{title:"Moodle"},sidebar:"docs",previous:{title:"Magpi",permalink:"/fr/documentation/apps/magpi"},next:{title:"Open Data Kit (ODK)",permalink:"/fr/documentation/apps/odk"}},l={},p=[{value:"Aper\xe7u",id:"aper\xe7u",level:2},{value:"Cas d&#39;utilisation d&#39;int\xe9gration",id:"cas-dutilisation-dint\xe9gration",level:3},{value:"Plus d&#39;info",id:"plus-dinfo",level:3},{value:"Options d&#39;int\xe9gration",id:"options-dint\xe9gration",level:2},{value:"Plus d&#39;informations sur l&#39;API Moodle",id:"plus-dinformations-sur-lapi-moodle",level:3},{value:"Connexion \xe0 OpenFn",id:"connexion-\xe0-openfn",level:2},{value:"Exemples d&#39;impl\xe9mentations",id:"exemples-dimpl\xe9mentations",level:2}],u={toc:p};function d(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"aper\xe7u"},"Aper\xe7u"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://moodle.org/"},"Moodle")," est un syst\xe8me de gestion libre et gratuit d'apprentissage en ligne."),(0,r.kt)("h3",{id:"cas-dutilisation-dint\xe9gration"},"Cas d'utilisation d'int\xe9gration"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"En tant qu'enseignant sur Moodle, je souhaiterai envoyer les mises \xe0 jour de profil, d'inscription et de notes \xe0 CommCare afin que je puisse continuer \xe0 soutenir les \xe9tudiants en mode hors connexion."),(0,r.kt)("li",{parentName:"ol"},"En tant qu'enseignant sur Moodle, je souhaite envoyer automatiquement les donn\xe9es relatives \xe0 l'engagement des \xe9tudiants \xe0 CommCare afin que je puisse int\xe9grer des notifications par SMS pour augmenter leur participation."),(0,r.kt)("li",{parentName:"ol"},"En tant qu'\xe9tudiant sur Moodle, je souhaite acc\xe9der \xe0 mes donn\xe9es de cours et \xe0 mes notes m\xeame lorsque je ne suis pas connect\xe9 \xe0 Internet.")),(0,r.kt)("h3",{id:"plus-dinfo"},"Plus d'info"),(0,r.kt)("p",null,"Liens utiles..."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Documentation Moodle \u2013 ",(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/310/fr/Main_page"},"https://docs.moodle.org/310/fr/Main_page")),(0,r.kt)("li",{parentName:"ol"},"Documentation de l'API Moodle - ",(0,r.kt)("a",{parentName:"li",href:"https://moodle.org/plugins/webservice_restful"},"https://moodle.org/plugins/webservice_restful"))),(0,r.kt)("h2",{id:"options-dint\xe9gration"},"Options d'int\xe9gration"),(0,r.kt)("p",null,"Int\xe9gration des donn\xe9es via l'API Web de Moodle\xa0: ",(0,r.kt)("a",{parentName:"p",href:"https://moodle.org/plugins/webservice_restful"},"https://moodle.org/plugins/webservice_restful")),(0,r.kt)("p",null,"Transfert de donn\xe9es en utilisant un Webhook\xa0: ",(0,r.kt)("a",{parentName:"p",href:"https://moodle.org/plugins/local_webhooks"},"https://moodle.org/plugins/local_webhooks")),(0,r.kt)("h3",{id:"plus-dinformations-sur-lapi-moodle"},"Plus d'informations sur l'API Moodle"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Exemples de requ\xeates HTTP")),(0,r.kt)("p",null,"Authentification\xa0:",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("inlineCode",{parentName:"p"},"GET mymoodlesite.com/login/token.php?service=moodle_mobile_app &username=USERNAME&password=PASSWORD")),(0,r.kt)("p",null,"R\xe9cup\xe9rer les informations sur les cours pour tous les cours :",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("inlineCode",{parentName:"p"},"GET /cv_dgdp/webservice/rest/server.php?wstoken=TOKEN&wsfunction= core_course_get_courses&moodlewsrestformat=json HTTP/1.1")),(0,r.kt)("p",null,"R\xe9cup\xe9rer les utilisateurs inscrits dans un cours sp\xe9cifique :",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("inlineCode",{parentName:"p"},"GET /cv_dgdp/webservice/rest/server.php?wstoken=TOKEN&wsfunction= core_enrol_get_enrolled_users&courseid=225&moodlewsrestformat=json HTTP/1.1")),(0,r.kt)("p",null,"R\xe9cup\xe9rer toutes les notes finales d'un \xe9tudiant :",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("inlineCode",{parentName:"p"},"GET /cv_dgdp/webservice/rest/server.php?wstoken=TOKEN&wsfunction= gradereport_user_get_grade_items&userid=46580&courseid=225&moodlewsrestformat=json HTTP/1.1")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Astuces d'int\xe9gration")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Le point de terminaison ",(0,r.kt)("inlineCode",{parentName:"li"},"get_enrolled_users")," ne retourne pas tous les d\xe9tails du profil utilisateur. Nous avons d\xfb acc\xe9der \xe0 ",(0,r.kt)("inlineCode",{parentName:"li"},"core_user_get_users_by_field")," et filtrer par un utilisateur sp\xe9cifique pour r\xe9cup\xe9rer les informations du profil comme le num\xe9ro de t\xe9l\xe9phone et l'adresse ."),(0,r.kt)("li",{parentName:"ol"},"La recherche sur Google du point de terminaison que vous utilisez est tr\xe8s utile\xa0!")),(0,r.kt)("h2",{id:"connexion-\xe0-openfn"},"Connexion \xe0 OpenFn"),(0,r.kt)("p",null,"Le ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/OpenFn/language-http#language-http-"},(0,r.kt)("inlineCode",{parentName:"a"},"language-http"))," peut \xeatre utilis\xe9 pour faire des requ\xeates HTTP \xe0 l'API Moodle."),(0,r.kt)("h2",{id:"exemples-dimpl\xe9mentations"},"Exemples d'impl\xe9mentations"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Moodle -> Int\xe9gration de CommCare\xa0:")),(0,r.kt)("p",null,"Dans le cadre de la mise en oeuvre d'un projet de cr\xe9ation d'une application \xe9ducative (bas\xe9e sur CommCare), nous extrayons quotidiennement des donn\xe9es \xe0 partir d'un syst\xe8me de gestion de d'apprentissage Moodle, puis nous t\xe9l\xe9chargeons les donn\xe9es des \xe9tudiants ",(0,r.kt)("inlineCode",{parentName:"p"},"user")," (utilisateur) de Moodle en tant qu'enregistrements de ",(0,r.kt)("inlineCode",{parentName:"p"},"case")," (cas) dans Commcare."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Exemple d'histoire d'utilisateur : en tant que qu'encadreur utilisant CommCare, quand le profil d'un \xe9tudiant et ses notes sont mises \xe0 jour dans Moodle, je voudrais que ces donn\xe9es apparaissent automatiquement dans mon application mobile afin que je puisse faire un suivi appropri\xe9 et m'assurer qu'il obtient de bons r\xe9sultats.")),(0,r.kt)("p",null,"Exemple de job visant \xe0 r\xe9cup\xe9rer les utilisateurs inscrits via le point de terminaison de l'API Moodle (aussi appel\xe9 ",(0,r.kt)("inlineCode",{parentName:"p"},"web service function"),")\xa0: ",(0,r.kt)("inlineCode",{parentName:"p"},"core_enrol_get_enrolled_users")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"alterState(state => {\n  const { loginUrl, username, password, host } = state.configuration;\n  return get(\n    `${loginUrl}&username=${username}&password=${password}`,\n    {},\n    state => {\n      const { token } = state.data;\n      const courseIds = [224, 225];\n      const enrolledUsers = [];\n      return each(\n        courseIds,\n        alterState(state => {\n          let courseid = state.data;\n          return get(\n            `${host}`,\n            {\n              query: {\n                wstoken: token,\n                wsfunction: 'core_enrol_get_enrolled_users',\n                courseid,\n                moodlewsrestformat: 'json',\n              },\n              headers: { 'content-type': 'application/json' },\n            },\n            state => {\n              console.log(\n                `Getting users enrolled in the course with ${courseid}...`\n              );\n              enrolledUsers.push(state.data);\n              return { ...state, enrolledUsers };\n            }\n          )(state);\n        })\n      )(state);\n    }\n  )(state);\n});\n")))}d.isMDXComponent=!0}}]);