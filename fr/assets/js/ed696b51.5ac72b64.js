(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[5460],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return c},kt:function(){return m}});var a=t(67294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var u=a.createContext({}),l=function(e){var n=a.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},c=function(e){var n=l(e.components);return a.createElement(u.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,u=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),d=l(t),m=i,f=d["".concat(u,".").concat(m)]||d[m]||p[m]||r;return t?a.createElement(f,s(s({ref:n},c),{},{components:t})):a.createElement(f,s({ref:n},c))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,s=new Array(r);s[0]=d;var o={};for(var u in n)hasOwnProperty.call(n,u)&&(o[u]=n[u]);o.originalType=e,o.mdxType="string"==typeof e?e:i,s[1]=o;for(var l=2;l<r;l++)s[l]=t[l];return a.createElement.apply(null,s)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},86303:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return s},metadata:function(){return o},toc:function(){return u},default:function(){return c}});var a=t(22122),i=t(19756),r=(t(67294),t(3905)),s={layout:"post",title:"Formulaires et cas : CommCare et int\xe9gration bas\xe9e sur les \xe9v\xe9nements",author:"Taylor Downs",author_url:"https://github.com/taylordowns2000",author_image_url:"https://avatars.githubusercontent.com/taylordowns2000",tags:["comment faire","astuces"],featured:!0},o={permalink:"/fr/articles/2021/05/24/commcare-events",editUrl:"https://github.com/openfn/docs/edit/main/articles/2021-05-24-commcare-events.md",source:"@site/i18n/fr/docusaurus-plugin-content-blog-articles/2021-05-24-commcare-events.md",title:"Formulaires et cas : CommCare et int\xe9gration bas\xe9e sur les \xe9v\xe9nements",description:"C'est rapide, mais je viens de passer un appel passionnant avec une organisation qui va mettre en place des jobs pour d\xe9placer des donn\xe9es dans Salesforce \xe0 partir de CommCare et j'ai r\xe9alis\xe9 que bien que cela soit l'une de nos exigences d'int\xe9gration les plus courantes, nous n'avons pas fait un article des \xabastuces\xbb pour ce type de projet. Jusqu'\xe0 pr\xe9sent.",date:"2021-05-24T00:00:00.000Z",formattedDate:"24 mai 2021",tags:[{label:"comment faire",permalink:"/fr/articles/tags/comment-faire"},{label:"astuces",permalink:"/fr/articles/tags/astuces"}],readingTime:9.53,truncated:!0,nextItem:{title:"Synchroniser comme vous le voulez : Penser \xe0 travers le syst\xe8me de protocoles de \xab Synchronisation \xbb",permalink:"/fr/articles/2021/02/17/syncing-options"}},u=[{value:"La plupart des gens utilisent le &quot;Transfert de donn\xe9es&quot; dans CommCare",id:"la-plupart-des-gens-utilisent-le-transfert-de-donn\xe9es-dans-commcare",children:[]},{value:"Travailler avec les donn\xe9es en provenance de CommCare",id:"travailler-avec-les-donn\xe9es-en-provenance-de-commcare",children:[]},{value:"Les instructions pour notre employ\xe9",id:"les-instructions-pour-notre-employ\xe9",children:[]},{value:"Traduire ceci dans un projet OpenFn",id:"traduire-ceci-dans-un-projet-openfn",children:[{value:"Cr\xe9er un identifiant Salesforce",id:"cr\xe9er-un-identifiant-salesforce",children:[]},{value:"Cr\xe9er un trigger filtre de message",id:"cr\xe9er-un-trigger-filtre-de-message",children:[]},{value:"Cr\xe9er un job",id:"cr\xe9er-un-job",children:[]}]},{value:"Et ensuite",id:"et-ensuite",children:[]},{value:"Une derni\xe8re id\xe9e",id:"une-derni\xe8re-id\xe9e",children:[]}],l={toc:u};function c(e){var n=e.components,t=(0,i.Z)(e,["components"]);return(0,r.kt)("wrapper",(0,a.Z)({},l,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"C'est rapide, mais je viens de passer un appel passionnant avec une organisation qui va mettre en place des jobs pour d\xe9placer des donn\xe9es dans Salesforce \xe0 partir de CommCare et j'ai r\xe9alis\xe9 que bien que cela soit l'une de nos exigences d'int\xe9gration les plus courantes, nous n'avons pas fait un article des \xabastuces\xbb pour ce type de projet. Jusqu'\xe0 pr\xe9sent."),(0,r.kt)("p",null,"Alors voil\xe0. Bien qu'il ne s'agisse en aucun cas d'un mod\xe8le de planification de projet exhaustif, voici quelques \xe9l\xe9ments \xe0 garder \xe0 l'esprit si vous envisagez de mettre en \u0153uvre vous-m\xeame une int\xe9gration CommCare \xe0 Salesforce."),(0,r.kt)("h2",{id:"la-plupart-des-gens-utilisent-le-transfert-de-donn\xe9es-dans-commcare"},'La plupart des gens utilisent le "Transfert de donn\xe9es" dans CommCare'),(0,r.kt)("p",null,"Tout d'abord, la plupart des gens utilisent la fonction \xab Transmission de donn\xe9es \xbb de CommCare pour envoyer des soumissions de formulaires et des changements de cas (cr\xe9ation, mise \xe0 jour, fermeture, etc.) \xe0 OpenFn en temps r\xe9el. Vous pouvez en savoir plus \xe0 ce sujet ",(0,r.kt)("a",{parentName:"p",href:"/documentation/apps/commcare#forward-cases-andor-forms-from-commcare-to-openfn"},"ici")," mais la principale consid\xe9ration \xe0 ce stade de planification est ",(0,r.kt)("em",{parentName:"p"},"quand")," vous effectuerez les op\xe9rations \u2014",(0,r.kt)("inlineCode",{parentName:"p"},"cr\xe9er(...)"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"update(...)"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"upsert(...)"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"query(...)"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"(massif(...)"),", etc.\u2014dans Salesforce et \xe0 quelles donn\xe9es vous aurez acc\xe8s."),(0,r.kt)("p",null,"Chaque fois qu'une soumission de formulaire arrive dans CommCare, nous obtenons une copie de cette soumission chez OpenFn et pouvons utiliser ces donn\xe9es pour cr\xe9er ou modifier certains enregistrements dans Salesforce."),(0,r.kt)("p",null,'De m\xeame, chaque fois qu\'un cas est mis \xe0 jour (ou cr\xe9\xe9 ou ferm\xe9), nous obtiendrons une copie du cas avec toutes les "propri\xe9t\xe9s" du cas et nous pouvons utiliser ces donn\xe9es pour ',(0,r.kt)("em",{parentName:"p"},"faire quelque chose")," dans Salesforce."),(0,r.kt)("p",null,'Si vous utilisez "Transfert de formulaire", le ',(0,r.kt)("inlineCode",{parentName:"p"},"trigger")," que vous cr\xe9ez dans OpenFn pourrait ressembler \xe0 ceci ",(0,r.kt)("inlineCode",{parentName:"p"},'{"form":{"@name":"ART Adherence Self-Reporting Tool"}}')," et il d\xe9clencherait votre ",(0,r.kt)("inlineCode",{parentName:"p"},"job")," \xe0 chaque fois qu'une soumission \"ART Adherence Self-Reporting Tool\" est arriv\xe9e de CommCare, en donnant acc\xe8s \xe0 toutes les donn\xe9es \xe0 l'int\xe9rieur de cette soumission."),(0,r.kt)("h2",{id:"travailler-avec-les-donn\xe9es-en-provenance-de-commcare"},"Travailler avec les donn\xe9es en provenance de CommCare"),(0,r.kt)("p",null,"En supposant que vous utilisez la gestion de cas, les donn\xe9es qui arrivent de CommCare ressembleront \xe0 ceci :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "__query_params": {\n    "app_id": "some-long-id"\n  },\n  "app_id": "some-long-id",\n  "archived": false,\n  "attachments": {\n    "1621866020043.jpg": {\n      "content_type": "image/jpeg",\n      "length": 16423,\n      "url": "https://www.commcarehq.org/a/your-project/api/form/attachment/some-uuid/1621866020043.jpg"\n    },\n    "form.xml": {\n      "content_type": "text/xml",\n      "length": 2727,\n      "url": "https://www.commcarehq.org/a/your-project/api/form/attachment/some-uuid/form.xml"\n    }\n  },\n  "build_id": "0ec83881cd0e420dad5c24ed3a5452fe",\n  "domain": "your-project",\n  "edited_by_user_id": null,\n  "edited_on": null,\n  "form": {\n    "#type": "data",\n    "@name": "ART Adherence Self-Reporting Tool",\n    "@uiVersion": "1",\n    "@version": "2783",\n    "@xmlns": "http://openrosa.org/formdesigner/59E1207B-969F-402D-9EEE-675504036F78",\n    "administrative": {\n      "coach_verification": "v\xe9rifier_ici",\n      "visit_notes": "",\n      "vist_notes_to_save": ""\n    },\n    "case": {\n      "@case_id": "1ec51ee9-5aef-4bd2-b7eb-7599856251bc",\n      "@date_modified": "2021-05-24T14:20:28.693000Z",\n      "@user_id": "332e893dcd1b413686621bd80aae0cd3",\n      "@xmlns": "http://commcarehq.org/case/transaction/v2",\n      "update": {\n        "consent_received": "oui",\n        "home_visit_notes": ""\n      }\n    },\n    "meta": {\n      "@xmlns": "http://openrosa.org/jr/xforms",\n      "appVersion": "CommCare Android, version \\"2.51.2\\"(463994). App v2798. CommCare Version 2.51.2. Build 463994, built on: 2021-03-17",\n      "app_build_version": 2798,\n      "commcare_version": "2.51.2",\n      "deviceID": "commcare_a39f55a5-c744-4e33-8e01-d17e7698894f",\n      "drift": "0",\n      "geo_point": null,\n      "instanceID": "130c68c5-7d17-4086-8a85-27d7d7da2216",\n      "timeEnd": "2021-05-24T14:20:28.693000Z",\n      "timeStart": "2021-05-24T14:18:46.856000Z",\n      "userID": "332e893dcd1b413686621bd80aae0cd3",\n      "username": "some-chw"\n    },\n    "participant_information": {\n      "participant_id": "007",\n      "name": "taylor downs",\n      "gender": "masculin",\n      "guardian_information": {\n        "guardians_name": "Fake Data",\n        "guardians_phone_number": "8675309",\n        "guardians_signature": "1621866020043.jpg",\n        "relationship_to_participant": "father"\n      },\n      "current_medications": [\n        { "name": "generic-1", "actif": vrai },\n        { "name": "fakelyn-notrealiol", "actif": faux },\n        { "name": "sasstra-zenica", "actif": faux},\n        { "name": "ibuprofen", "active": vrai }\n      ]\n    },\n    "tested_for_hiv_status_tested_for_hiv": "OK",\n    "visit_information": {\n      "consent_given": "oui",\n      "date_consent_given": "2021-05-23",\n      "visit_date": "2021-05-23"\n    }\n  },\n  "id": "130c68c5-7d17-4086-8a85-27d7d7da2216",\n  "indexed_on": "2021-05-24T14:20:39.045971",\n  "initial_processing_complete": vrai,\n  "is_phone_submission": vrai,\n  "metadata": {\n    "appVersion": "CommCare Android, version \\"2.51.2\\"(463994). App v2798. CommCare Version 2.51.2. "app_build_version": 2798,\n    "commcare_version": "2.51.2",\n    "deviceID": "commcare_a39f55a5-c744-4e33-8e01-d17e7698894f",\n    "drift": "0",\n    "geo_point": null,\n    "instanceID": "130c68c5-7d17-4086-8a85-27d7d7da2216",\n    "location": null,\n    "timeEnd": "2021-05-24T14:20:28.693000Z",\n    "timeStart": "2021-05-24T14:18:46.856000Z",\n    "userID": "332e893dcd1b413686621bd80aae0cd3",\n    "username": "some-chw"\n  },\n  "problem": null,\n  "received_on": "2021-05-24T14:20:37.976363Z",\n  "resource_uri": "",\n  "server_modified_on": "2021-05-24T14:20:38.111789Z",\n  "type": "data",\n  "uiversion": "1",\n  "version": "2783"\n}\n')),(0,r.kt)("p",null,"Il s'agit d'un gros bloc de ",(0,r.kt)("inlineCode",{parentName:"p"},"JSON"),'- le corps du message qui est re\xe7u \xe0 OpenFn lorsque ce formulaire particulier ("ART Adherence Self-Reporting Tool") est soumis dans CommCare - sera remis \xe0 la t\xe2che pour commencer le traitement. La question est : que devons-nous faire ?'),(0,r.kt)("p",null,"Lors de la configuration d'une impl\xe9mentation en libre-service sur OpenFn, la chose la plus importante que vous puissiez faire en ce moment est d'\xe9num\xe9rer soigneusement le processus de saisie de donn\xe9es que vous aimeriez qu'un vrai humain suive. Vous pouvez le traduire ult\xe9rieurement en script de travail."),(0,r.kt)("p",null,"Vous devrez \xe9crire ceci pour votre propre cas, mais dans cet exemple fictif, voici le processus de saisie des donn\xe9es."),(0,r.kt)("h2",{id:"les-instructions-pour-notre-employ\xe9"},"Les instructions pour notre employ\xe9"),(0,r.kt)("p",null,":::astuce"),(0,r.kt)("p",null,'D\xe8s le d\xe9but, remarquez que nous sommes incroyablement explicites avec ces instructions ! Nous utilisons le "API Name" (au lieu de simplement le "libell\xe9", qui peut \xeatre ambigu) de chaque champ que nous voulons remplir dans Salesforce et nous utilisons le "chemin" sp\xe9cifique aux donn\xe9es que nous voulons que cette personne entre depuis CommCare.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Pourquoi sommes-nous si sp\xe9cifiques ?")," Parce que, finalement, un ordinateur devra interpr\xe9ter cela \u2014 et sont d'une ambigu\xeft\xe9 ",(0,r.kt)("em",{parentName:"p"},"incroyable")," !"),(0,r.kt)("p",null,":::"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Chaque fois qu'un message est re\xe7u avec ",(0,r.kt)("inlineCode",{parentName:"li"},'{"form":{"@name":"ART Adherence Self-Reporting Tool"}}')," dans le corps (c'est notre trigger)"),(0,r.kt)("li",{parentName:"ol"},"Connectez-vous \xe0 Salesforce et cr\xe9ez un nouveau participant avec le ",(0,r.kt)("inlineCode",{parentName:"li"},"participant_id")," que vous trouvez dans la section",(0,r.kt)("inlineCode",{parentName:"li"},"form. articipant_information")," comme leur ",(0,r.kt)("inlineCode",{parentName:"li"},"Participant_Code__c"),". (Si quelqu'un existe d\xe9j\xe0 dans Salesforce avec ce code, puis mettre \xe0 jour l'enregistrement existant.)"),(0,r.kt)("li",{parentName:"ol"},"Remplissez les champs suivants dans Salesforce en fonction des donn\xe9es de CommCare dans ce message :",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Nom__c")," avec les donn\xe9es de ",(0,r.kt)("inlineCode",{parentName:"li"},"form.participant_information.name")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Sex__c")," avec les donn\xe9es de ",(0,r.kt)("inlineCode",{parentName:"li"},"form.participant_information.gender")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"CommCare_Case_ID__c")," avec les donn\xe9es de ",(0,r.kt)("inlineCode",{parentName:"li"},"form.case.@case_id")))),(0,r.kt)("li",{parentName:"ol"},"Apr\xe8s avoir cr\xe9\xe9 (ou mis \xe0 jour) ce participant dans Salesforce, cr\xe9er un enregistrement de la visite avec l' ",(0,r.kt)("inlineCode",{parentName:"li"},"instanceID")," \xe0 partir de la section ",(0,r.kt)("inlineCode",{parentName:"li"},"m\xe9tadonn\xe9es")," en tant que identifiant unique ",(0,r.kt)("inlineCode",{parentName:"li"},"Visit_Code__c"),". (Une fois encore, s'il y a d\xe9j\xe0 une visite avec cet ID, veuillez mettre \xe0 jour l'enregistrement existant.)"),(0,r.kt)("li",{parentName:"ol"},'Remplissez les champs suivants pour la visite avec les donn\xe9es de CommCare"',(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Date__c")," avec ",(0,r.kt)("inlineCode",{parentName:"li"},"form.visit_information.visit_date"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Consented__c")," avec ",(0,r.kt)("inlineCode",{parentName:"li"},"form.visit_information.consent_given"),"."),(0,r.kt)("li",{parentName:"ul"},"Toujours d\xe9finir ",(0,r.kt)("inlineCode",{parentName:"li"},"Test_Status__c")," \xe0 ",(0,r.kt)("inlineCode",{parentName:"li"},"vrai"),", ind\xe9pendamment de ce qui se trouve dans le message de CommCare."),(0,r.kt)("li",{parentName:"ul"},"Et connectez cet enregistrement avec la ",(0,r.kt)("inlineCode",{parentName:"li"},"Community_Health_Worker")," par son nom d'utilisateur dans ",(0,r.kt)("inlineCode",{parentName:"li"},"form.metadata.username"),"."))),(0,r.kt)("li",{parentName:"ol"},"Enfin, ajoutez un dossier pour chaque m\xe9dicament list\xe9 dans le formulaire ",(0,r.kt)("inlineCode",{parentName:"li"},"form.participant_information.current_medications")," \u2014 correspondant \xe0 un ID unique form\xe9 par une combinaison du ",(0,r.kt)("inlineCode",{parentName:"li"},"nom")," du m\xe9dicament et du ",(0,r.kt)("inlineCode",{parentName:"li"},"participant_id")," afin que nous puissions mettre \xe0 jour les dossiers de m\xe9dicaments existants s'ils sont pr\xe9sents."),(0,r.kt)("li",{parentName:"ol"},"Remplissez les champs suivants pour le m\xe9dicament :",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Generic_Name__c")," avec ",(0,r.kt)("inlineCode",{parentName:"li"},"nom")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Status__c")," avec ",(0,r.kt)("inlineCode",{parentName:"li"},"actif")),(0,r.kt)("li",{parentName:"ul"},"Et associez cet enregistrement avec le participant que vous avez cr\xe9\xe9 ou mis \xe0 jour \xe0 l'\xe9tape 2 via le champ ",(0,r.kt)("inlineCode",{parentName:"li"},"participant_id"),".")))),(0,r.kt)("p",null,"Ouf... c'est \xe7a la t\xe2che. C'est juste un exemple fictif et les choses pourraient \xeatre plus simples, ou beaucoup plus compliqu\xe9es que cela, mais il est important de se rappeler que si vous pouvez atteindre ce niveau de ",(0,r.kt)("strong",{parentName:"p"},"pr\xe9cision et granularit\xe9")," dans votre processus de saisie de donn\xe9es, un outil comme OpenFn peut automatiser cela pour vous dans un \xe9clat."),(0,r.kt)("h2",{id:"traduire-ceci-dans-un-projet-openfn"},"Traduire ceci dans un projet OpenFn"),(0,r.kt)("p",null,'Si vous diffusez des donn\xe9es depuis CommCare et que vous avez votre syst\xe8me Salesforce tous mis en place pour que cette personne de saisie de donn\xe9es puisse compl\xe9ter les \xe9tapes ci-dessus (tous les objets et champs sont-ils cr\xe9\xe9s ? les bons champs sont-ils marqu\xe9s comme "uniques" et d\xe9finis \xe0 \xeatre utiliser comme "external id" dans la section administration de Salesforce ? avez-vous activ\xe9 le transfert de donn\xe9es dans CommCare ?) alors il est temps de les transformer en un projet OpenFn !'),(0,r.kt)("p",null,":::astuce"),(0,r.kt)("p",null,"Un plugin rapide : ",(0,r.kt)("strong",{parentName:"p"},"Saviez-vous qu'il y a un ",(0,r.kt)("a",{parentName:"strong",href:"https://community.openfn.org"},"forum de la communaut\xe9 OpenFn"))," o\xf9 vous pouvez poster des trucs comme les \"\xe9tapes\" ci-dessus et obtenir de l'aide des autres utilisateurs et du personnel d'OpenFn pour convertir convertir ces \xe9tapes en un vrai travail OpenFn ?"),(0,r.kt)("p",null,"Eh bien, vous savez ! Allez voir sur ",(0,r.kt)("a",{parentName:"p",href:"https://community.openfn.org"},"community.openfn.org")),(0,r.kt)("p",null,":::"),(0,r.kt)("h3",{id:"cr\xe9er-un-identifiant-salesforce"},"Cr\xe9er un identifiant Salesforce"),(0,r.kt)("p",null,"Nous n'avons pas besoin d'un mot de passe CommCare, car il nous enverra des donn\xe9es. Cr\xe9ez un identifiant Salesforce qui permettra au travailleur OpenFn de se connecter \xe0 votre syst\xe8me Salesforce."),(0,r.kt)("p",null,"En savoir plus sur les credentials",(0,r.kt)("a",{parentName:"p",href:"/documentation/build/credentials"},"ici"),"."),(0,r.kt)("h3",{id:"cr\xe9er-un-trigger-filtre-de-message"},"Cr\xe9er un trigger filtre de message"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"S\xe9lectionnez ",(0,r.kt)("inlineCode",{parentName:"li"},"Message Filter")," pour le type ``"),(0,r.kt)("li",{parentName:"ul"},"Entrez ",(0,r.kt)("inlineCode",{parentName:"li"},'{"form":{"@name":"ART Adherence Self-Reporting Tool"}}')," pour les crit\xe8res d'inclusion ``")),(0,r.kt)("p",null,"En savoir plus sur les triggers",(0,r.kt)("a",{parentName:"p",href:"/documentation/build/triggers"},"ici"),"."),(0,r.kt)("h3",{id:"cr\xe9er-un-job"},"Cr\xe9er un job"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Donnez-en un nom"),(0,r.kt)("li",{parentName:"ul"},"S\xe9lectionnez le trigger que vous venez de cr\xe9er"),(0,r.kt)("li",{parentName:"ul"},"S\xe9lectionnez l'adaptateur ",(0,r.kt)("inlineCode",{parentName:"li"},"salesforce")),(0,r.kt)("li",{parentName:"ul"},"S\xe9lectionnez le credential que vous venez de cr\xe9er")),(0,r.kt)("p",null,"Et convertissez les instructions ci-dessus en \"op\xe9rations\" en utilisant l'aide en ligne fournie par l'adaptateur Salesforce :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// Utilisez upsert pour cr\xe9er ou mettre \xe0 jour un participant en fonction de son code de participant.\nupsert(\n  'Participant__c',\n  'Participant_Code__c',\n  fields(\n    field(\n      'Participant_Code__c',\n      dataValue('form.participant_information.participant_id')\n    ),\n    field('Name__c', dataValue('form.participant_information.name')),\n    field('Sex__c', dataValue('form.participant_information.gender')),\n    field('CommCare_Case_ID__c', dataValue('form.case[@case_id]'))\n  )\n);\n\n// Ensuite, ins\xe9rez une visite en utilisant le code de visite.\nupsert(\n  'Visit__c',\n  'Visit_Code__c',\n  fields(\n    field('Visit_Code__c', dataValue('metadata.instanceID')),\n    field('Date__c', dataValue('form.visit_information.visit_date')),\n    field('Consented__c', dataValue('form.visit_information.consent_given')),\n    // Always set status to true\n    field('Test_Status__c', true),\n    //Et li\xe9 cette visite au participant que nous venons de cr\xe9er par son \"code\"\n    relationship(\n      'Participant__r',\n      'Participant_Code__c',\n      dataValue('form.participant_information.participant_id')\n    )\n  )\n);\n\n// Et enfin pour CHAQUE m\xe9diation r\xe9pertori\xe9e, cr\xe9ez un dossier de m\xe9dicament avec un statut\neach(\n  merge(\n    dataPath('form.participant_information.current_medications[*]'),\n    fields(\n      field('pID', dataValue('form.participant_information.participant_id'))\n    )\n  ),\n  upsert(\n    'Medication_Tx__c',\n    'Medication_Tx_ID__c',\n    fields(\n      field(Medication_Tx_ID__c, state => {\n        // Ici, \xe0 l'int\xe9rieur du tableau des m\xe9dicaments, nous avons \"scoped\" l'\xe9tat de sorte que\n        // state.data, pour chaque \xe9l\xe9ment du tableau, ressemble \xe0 ceci : \n        // { pID: 007, name: \"sasstra-zenica\", active: false }\n\n        // Nous concat\xe9nerons l'identifiant du participant avec le nom du m\xe9dicament.\n        return state.data.pID + state.data.name;\n      }),\n      field('Generic_Name__c', dataValue('name')),\n      field('Status__c', dataValue('status')),\n      relationship('Participant__r', 'Participant_Code__c', dataValue('pID'))\n    )\n  )\n);\n")),(0,r.kt)("p",null,"Maintenant, chaque fois que cette t\xe2che est ex\xe9cut\xe9e (ce qui est \xe0 chaque fois qu'un formulaire CommCare est soumis) votre travailleur OpenFn mettra \xe0 jour un ",(0,r.kt)("inlineCode",{parentName:"p"},"Participant"),", upsert une ",(0,r.kt)("inlineCode",{parentName:"p"},"Visite"),"et exploite une liste compl\xe8te de ",(0,r.kt)("inlineCode",{parentName:"p"},"M\xe9dicaments")," en Salesforce."),(0,r.kt)("h2",{id:"et-ensuite"},"Et ensuite"),(0,r.kt)("p",null,"Eh bien, dans notre petit exemple, vous allumeriez la t\xe2che \"allum\xe9e\" (en la mettant sur les messages entrants de CommCare) et laissez-la fonctionner. Chaque fois qu'il y avait un \xe9chec (peut-\xeatre votre administrateur Salesforce a ajout\xe9 un nouveau champ requis sur l'objet personnalis\xe9",(0,r.kt)("inlineCode",{parentName:"p"},"M\xe9dication"),") vous recevrez un e-mail et vous devrez revenir \xe0 OpenFn pour mettre \xe0 jour votre job, y compris ce nouveau champ."),(0,r.kt)("p",null,"Si vous \xeates en train de concevoir vos syst\xe8mes CommCare et Salesforce en ce moment, ce va-et-vient sera assez courant. Gardez \xe0 l'esprit que vous voulez autant de simplicit\xe9 que possible dans ces syst\xe8mes utilisateurs finaux... eh bien parce que les ",(0,r.kt)("em",{parentName:"p"},"humains")," interagissent avec eux tous les jours !"),(0,r.kt)("p",null,"Tant que vos processus sont bien d\xe9finis, OpenFn peut g\xe9rer un peu de complexit\xe9 (nettoyage de donn\xe9es, transformation, flux logiques complexes, etc.). mais vous ne devriez jamais faire de sacrifices \xe0 l'exp\xe9rience utilisateur dans CommCare et Salesforce\u2014c'est un moyen rapide de perdre l'adoption."),(0,r.kt)("p",null,"Donc, id\xe9alement, vous avez con\xe7u vos flux de travail dans CommCare et Salesforce pour rendre vos utilisateurs heureux et obtenir les informations dont ils ont besoin pour bien faire leur travail et ",(0,r.kt)("em",{parentName:"p"},"puis")," vous revenez sur OpenFn et \xe9noncez nos instructions de saisie de donn\xe9es comme nous l'avons fait ci-dessus."),(0,r.kt)("h2",{id:"une-derni\xe8re-id\xe9e"},"Une derni\xe8re id\xe9e"),(0,r.kt)("p",null,"Les deux ressources les plus importantes que vous avez \xe0 votre disposition si vous d\xe9finissez tout cela seul sont :"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"ce site (docs.openfn.org), et"),(0,r.kt)("li",{parentName:"ol"},"le ",(0,r.kt)("a",{parentName:"li",href:"https://community.openfn.org"},"forum ")," (community.openfn.org)")),(0,r.kt)("p",null,"Lisez dans les sections ",(0,r.kt)("a",{parentName:"p",href:"/documentation/getting-started/overview"},'"D\xe9marrer"')," et ",(0,r.kt)("a",{parentName:"p",href:"/documentation/build/jobs"},'"Cr\xe9er"')," si vous \xeates un apprenant, en arri\xe8re-plan. Si vous avez envie d'extraits et d'exemples de code de travail, acc\xe9dez directement \xe0 la",(0,r.kt)("a",{parentName:"p",href:"/library"},"Job Library")," pour voir comment les autres utilisateurs d'OpenFn cr\xe9ent leurs jobs."),(0,r.kt)("p",null,"Dans tous les cas, tenez la communaut\xe9 au courant de vos progr\xe8s dans le forum. Vous trouverez beaucoup de gens serviables pr\xeats \xe0 vous aider dans votre parcours d'int\xe9gration."))}c.isMDXComponent=!0}}]);