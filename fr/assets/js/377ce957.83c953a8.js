"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[7036],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>c});var i=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=i.createContext({}),u=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=u(e.components);return i.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),m=u(n),c=o,v=m["".concat(l,".").concat(c)]||m[c]||d[c]||r;return n?i.createElement(v,s(s({ref:t},p),{},{components:n})):i.createElement(v,s({ref:t},p))}));function c(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,s=new Array(r);s[0]=m;var a={};for(var l in t)hasOwnProperty.call(t,l)&&(a[l]=t[l]);a.originalType=e,a.mdxType="string"==typeof e?e:o,s[1]=a;for(var u=2;u<r;u++)s[u]=n[u];return i.createElement.apply(null,s)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},943:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>a,toc:()=>u});var i=n(87462),o=(n(67294),n(3905));const r={title:"Limites"},s=void 0,a={unversionedId:"jobs/limits",id:"jobs/limits",title:"Limites",description:"Microservice et OpenFn.org (l'iPaaS) ont tous deux des limites pr\xe9-configur\xe9es pour assurer un fonctionnement fluide. Vous trouverez ci-dessous une explication d\xe9taill\xe9e de ces valeurs par d\xe9faut et comment ajuster les limites.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/jobs/limits.md",sourceDirName:"jobs",slug:"/jobs/limits",permalink:"/fr/documentation/jobs/limits",draft:!1,editUrl:"https://github.com/openfn/docs/edit/main/docs/jobs/limits.md",tags:[],version:"current",frontMatter:{title:"Limites"},sidebar:"docs",previous:{title:"Codes de sortie et erreurs",permalink:"/fr/documentation/jobs/errors"},next:{title:"Informations sur cette publication",permalink:"/fr/documentation/release-notes"}},l={},u=[{value:"Limites de la m\xe9moire NodeVM",id:"limites-de-la-m\xe9moire-nodevm",level:2},{value:"Augmenter la limite de m\xe9moire pour une ex\xe9cution individuelle",id:"augmenter-la-limite-de-m\xe9moire-pour-une-ex\xe9cution-individuelle",level:3},{value:"Augmenter la limite de m\xe9moire pour tous les jobs sur cette machine",id:"augmenter-la-limite-de-m\xe9moire-pour-tous-les-jobs-sur-cette-machine",level:3},{value:"Limitation du corps des requ\xeates dans les inbox",id:"limitation-du-corps-des-requ\xeates-dans-les-inbox",level:2},{value:"Limites du Job state",id:"limites-du-job-state",level:2}],p={toc:u};function d(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,i.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Microservice et OpenFn.org (l'iPaaS) ont tous deux des limites pr\xe9-configur\xe9es pour assurer un fonctionnement fluide. Vous trouverez ci-dessous une explication d\xe9taill\xe9e de ces valeurs par d\xe9faut et comment ajuster les limites."),(0,o.kt)("p",null,":::astuce"),(0,o.kt)("p",null,"Si vous n'avez pas envie de lire beaucoup, voici le r\xe9sum\xe9\xa0:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"N'envoyez pas plus de ",(0,o.kt)("inlineCode",{parentName:"li"},"8 Mo")," \xe0 l'API ",(0,o.kt)("inlineCode",{parentName:"li"},"/inbox")," en une seule requ\xeate."),(0,o.kt)("li",{parentName:"ol"},"Assurez-vous que votre ",(0,o.kt)("inlineCode",{parentName:"li"},"expression.js")," et votre ",(0,o.kt)("inlineCode",{parentName:"li"},"state.json")," ne totalisent pas plus de ",(0,o.kt)("inlineCode",{parentName:"li"},"10 Mo")," lorsque vous ",(0,o.kt)("em",{parentName:"li"},"d\xe9marrez")," ou ",(0,o.kt)("em",{parentName:"li"},"terminez")," un run."),(0,o.kt)("li",{parentName:"ol"},"Conserver l'utilisation de la m\xe9moire en dessous de ",(0,o.kt)("inlineCode",{parentName:"li"},"512 Mo")," ",(0,o.kt)("em",{parentName:"li"},"pendant")," le run.")),(0,o.kt)("p",null,":::"),(0,o.kt)("h2",{id:"limites-de-la-m\xe9moire-nodevm"},"Limites de la m\xe9moire NodeVM"),(0,o.kt)("p",null,"La limite de m\xe9moire par d\xe9faut pour un processus Node est de ",(0,o.kt)("inlineCode",{parentName:"p"},"512 Mo")," et \xe0 moins que vous ne l'ayez personnalis\xe9 pour un usage sur le core ou que vous ayez accept\xe9 une offre de m\xe9moire \xe9lev\xe9e sur OpenFn.org, les runs de jobs seront supprim\xe9s par Node (",(0,o.kt)("inlineCode",{parentName:"p"},"JavaScript heap out of memory"),") quand ils atteignent ce seuil."),(0,o.kt)("h3",{id:"augmenter-la-limite-de-m\xe9moire-pour-une-ex\xe9cution-individuelle"},"Augmenter la limite de m\xe9moire pour une ex\xe9cution individuelle"),(0,o.kt)("p",null,"Pour une limite de ",(0,o.kt)("inlineCode",{parentName:"p"},"1 Go")," pour un job individuel, utilisez\xa0:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"node --max-old-space-size=1024 core execute ...arguments\n")),(0,o.kt)("h3",{id:"augmenter-la-limite-de-m\xe9moire-pour-tous-les-jobs-sur-cette-machine"},"Augmenter la limite de m\xe9moire pour tous les jobs sur cette machine"),(0,o.kt)("p",null,"Pour une limite de ",(0,o.kt)("inlineCode",{parentName:"p"},"4 Go")," pour tous les jobs, d\xe9finissez une variable d'environnement avec\xa0:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"export NODE_OPTIONS=--max_old_space_size=4096\n")),(0,o.kt)("h2",{id:"limitation-du-corps-des-requ\xeates-dans-les-inbox"},"Limitation du corps des requ\xeates dans les inbox"),(0,o.kt)("p",null,"La taille maximale du corps de message JSON accept\xe9 sur le point de terminaison ",(0,o.kt)("inlineCode",{parentName:"p"},"/inbox/your-uuid")," est de ",(0,o.kt)("inlineCode",{parentName:"p"},"8 Mo"),". Notez que les charges utiles doivent \xeatre maintenues en dessous de cette limite afin de s'assurer que ",(0,o.kt)("a",{parentName:"p",href:"#job-state-limits"},"Job state limits")," ne soient pas atteintes lors de l'ex\xe9cution du run job suivant."),(0,o.kt)("p",null,":::remarque"),(0,o.kt)("p",null,"Si vous utilisez OpenFn pour le traitement de donn\xe9es en masse ou des jobs p\xe9riodiques par lots, vous pouvez soit reconfigurer ces limites sur votre d\xe9ploiement de microservice ou contacter ",(0,o.kt)("a",{parentName:"p",href:"mailto:enterprise@openfn.org"},"enterprise@openfn.org")," pour que des dispositions sp\xe9ciales soient prises pour votre projet OpenFn.org. ."),(0,o.kt)("p",null,":::"),(0,o.kt)("h2",{id:"limites-du-job-state"},"Limites du Job state"),(0,o.kt)("p",null,"Lorsqu'un job doit \xeatre envoy\xe9 pour \xeatre trait\xe9, la taille totale de tous les artefacts de job (votre job ",(0,o.kt)("inlineCode",{parentName:"p"},"expression")," et le ",(0,o.kt)("inlineCode",{parentName:"p"},"state")," initial) ne peut pas exc\xe9der ",(0,o.kt)("inlineCode",{parentName:"p"},"10 Mo"),". En d'autres termes, votre code (",(0,o.kt)("inlineCode",{parentName:"p"},"expression.js"),") plus vos donn\xe9es et votre configuration (",(0,o.kt)("inlineCode",{parentName:"p"},"\xe9tat. fils"),") ne peuvent pas d\xe9passer ",(0,o.kt)("inlineCode",{parentName:"p"},"10 Mo")," au total."),(0,o.kt)("p",null,"De m\xeame, lorsque state est sauvegard\xe9 sur le stockage/disque du cloud ",(0,o.kt)("em",{parentName:"p"},"apr\xe8s")," l'ex\xe9cution, il y a une limite de ",(0,o.kt)("inlineCode",{parentName:"p"},"10 Mo")," \xe0 la taille du ",(0,o.kt)("inlineCode",{parentName:"p"},"state")," final d'un job."),(0,o.kt)("p",null,"Si vous traitez de grandes quantit\xe9s de donn\xe9es, vous devez (a) maintenir l'utilisation totale de votre m\xe9moire en dessous de ",(0,o.kt)("inlineCode",{parentName:"p"},"512 Mo")," pendant l'ex\xe9cution et (b) nettoyer state de sorte que tout ce que vous transmettez au prochain job, que ce soit via FLOW ou par saved state pour une job CRON, reste en dessous de ",(0,o.kt)("inlineCode",{parentName:"p"},"10 Mo"),"."),(0,o.kt)("p",null,"Parfois, cela n\xe9cessite la diffusion des donn\xe9es de A -> B dans le m\xeame job. Parfois, il faudra stocker les donn\xe9es en tant que variables locales, puis afficher les donn\xe9es dans votre inbox par morceaux avant de nettoyer state."))}d.isMDXComponent=!0}}]);