"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[4556],{15938:function(e,t,n){n.r(t),n.d(t,{assets:function(){return j},contentTitle:function(){return w},default:function(){return O},frontMatter:function(){return y},metadata:function(){return C},toc:function(){return T}});var a=n(83117),o=n(80102),i=n(67294),r=n(3905),s=n(25710),l=n(22004),p=n(72389),d=n(67392),u=n(7094),c=n(12466),m=n(86010),h="tabList_uSqn",k="tabItem_LplD";function g(e){var t,n,o,r=e.lazy,s=e.block,l=e.defaultValue,p=e.values,g=e.groupId,f=e.className,v=i.Children.map(e.children,(function(e){if((0,i.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),N=null!=p?p:v.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),b=(0,d.l)(N,(function(e,t){return e.value===t.value}));if(b.length>0)throw new Error('Docusaurus error: Duplicate values "'+b.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var y=null===l?l:null!=(t=null!=l?l:null==(n=v.find((function(e){return e.props.default})))?void 0:n.props.value)?t:null==(o=v[0])?void 0:o.props.value;if(null!==y&&!N.some((function(e){return e.value===y})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+y+'" but none of its children has the corresponding value. Available values are: '+N.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var w=(0,u.U)(),C=w.tabGroupChoices,j=w.setTabGroupChoices,T=(0,i.useState)(y),x=T[0],O=T[1],I=[],F=(0,c.o5)().blockElementScrollPositionUntilNextRender;if(null!=g){var A=C[g];null!=A&&A!==x&&N.some((function(e){return e.value===A}))&&O(A)}var S=function(e){var t=e.currentTarget,n=I.indexOf(t),a=N[n].value;a!==x&&(F(t),O(a),null!=g&&j(g,a))},_=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a=I.indexOf(e.currentTarget)+1;n=I[a]||I[0];break;case"ArrowLeft":var o=I.indexOf(e.currentTarget)-1;n=I[o]||I[I.length-1]}null==(t=n)||t.focus()};return i.createElement("div",{className:(0,m.Z)("tabs-container",h)},i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,m.Z)("tabs",{"tabs--block":s},f)},N.map((function(e){var t=e.value,n=e.label,o=e.attributes;return i.createElement("li",(0,a.Z)({role:"tab",tabIndex:x===t?0:-1,"aria-selected":x===t,key:t,ref:function(e){return I.push(e)},onKeyDown:_,onFocus:S,onClick:S},o,{className:(0,m.Z)("tabs__item",k,null==o?void 0:o.className,{"tabs__item--active":x===t})}),null!=n?n:t)}))),r?(0,i.cloneElement)(v.filter((function(e){return e.props.value===x}))[0],{className:"margin-top--md"}):i.createElement("div",{className:"margin-top--md"},v.map((function(e,t){return(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==x})}))))}function f(e){var t=(0,p.Z)();return i.createElement(g,(0,a.Z)({key:String(t)},e))}var v="tabItem_OmH5";function N(e){var t=e.children,n=e.hidden,a=e.className;return i.createElement("div",{role:"tabpanel",className:(0,m.Z)(v,a),hidden:n},t)}var b=["components"],y={title:"Devtools"},w=void 0,C={unversionedId:"devtools/home",id:"devtools/home",title:"Devtools",description:"OpenFn/Devtools is a set of tools for writing & testing job expressions, managing OpenFn projects, and developing new adaptors. It's how most people work with OpenFn from their own command lines, outside of OpenFn.org, Microservice, or Lightning.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/devtools/home.md",sourceDirName:"devtools",slug:"/devtools/home",permalink:"/fr/documentation/devtools/home",draft:!1,editUrl:"https://github.com/openfn/docs/edit/main/docs/devtools/home.md",tags:[],version:"current",frontMatter:{title:"Devtools"},sidebar:"docs",previous:{title:"Sources g\xe9n\xe9riques",permalink:"/fr/documentation/source-apps"},next:{title:"Adaptateurs",permalink:"/fr/documentation/build/adaptors"}},j={},T=[{value:"Op\xe9rationnel",id:"op\xe9rationnel",level:2},{value:"Utilisation",id:"utilisation",level:2},{value:"Run a job using bash",id:"run-a-job-using-bash",level:3},{value:"More on Devtools",id:"more-on-devtools",level:3},{value:"Install a specific adaptor version",id:"install-a-specific-adaptor-version",level:3},{value:"The <code>--test</code> option",id:"the---test-option",level:3},{value:"<code>.FakeAdaptor</code>",id:"fakeadaptor",level:4},{value:"Tests hors ligne pour d&#39;autres adaptateurs",id:"tests-hors-ligne-pour-dautres-adaptateurs",level:4},{value:"Hands-on with devtools and the command line",id:"hands-on-with-devtools-and-the-command-line",level:2},{value:"Configure an OpenFn project",id:"configure-an-openfn-project",level:2},{value:"Pre-Requisites",id:"pre-requisites",level:2},{value:"Scripts",id:"scripts",level:2},{value:"bootstrap",id:"bootstrap",level:3},{value:"generate-project.js",id:"generate-projectjs",level:3},{value:"generate-doclets",id:"generate-doclets",level:3},{value:"analyse-doclets",id:"analyse-doclets",level:3},{value:"Building adaptors for platform",id:"building-adaptors-for-platform",level:2},{value:"Troubleshooting",id:"troubleshooting",level:3},{value:"Git config issues",id:"git-config-issues",level:3},{value:"SSH key issues",id:"ssh-key-issues",level:3},{value:"Github token sharing",id:"github-token-sharing",level:3},{value:"Using a new adaptor in an OpenFn/platform instance",id:"using-a-new-adaptor-in-an-openfnplatform-instance",level:2}],x={toc:T};function O(e){var t=e.components,i=(0,o.Z)(e,b);return(0,r.kt)("wrapper",(0,a.Z)({},x,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"OpenFn/Devtools is a set of tools for writing & testing job expressions, managing OpenFn projects, and developing new adaptors. It's how most people work with OpenFn from their own command lines, outside of OpenFn.org, Microservice, or Lightning."),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Are you a developer?")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/OpenFn/devtools"},"Devtools")," repo is a collection of bash and Node scripts, as well as a ",(0,r.kt)("em",{parentName:"p"},"suggested")," (but not necessary) directory structure for working with OpenFn jobs and adaptors."),(0,r.kt)("p",{parentName:"div"},"To run OpenFn jobs locally, you only need ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/OpenFn/core"},"Core")," and at least one adaptor, e.g. ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/OpenFn/language-http"},"language-http")," and you may prefer to install core globally via ",(0,r.kt)("inlineCode",{parentName:"p"},"npm install -g @openfn/core")))),(0,r.kt)("h2",{id:"op\xe9rationnel"},"Op\xe9rationnel"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Install ",(0,r.kt)("a",{parentName:"p",href:"https://git-scm.com/downloads"},"git")," and ",(0,r.kt)("a",{parentName:"p",href:"https://nodejs.org/en/download/"},"Node.js")," (version 14 or greater)")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Clone and install devtools to setup core, language-common, and language-http using either SSH or HTTPS:"))),(0,r.kt)(f,{defaultValue:"ssh",values:[{label:"SSH",value:"ssh"},{label:"HTTPS",value:"https"}],mdxType:"Tabs"},(0,r.kt)(N,{value:"ssh",mdxType:"TabItem"},(0,r.kt)(s.Z,{mdxType:"CodeBlock"},"git clone git@github.com:OpenFn/devtools.git","\n","cd devtools","\n","./install.sh ssh")),(0,r.kt)(N,{value:"https",mdxType:"TabItem"},(0,r.kt)(s.Z,{mdxType:"CodeBlock"},"git clone https://github.com/OpenFn/devtools.git","\n","cd devtools","\n","./install.sh https"))),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},'Note: If you get a "permission denied" message when running ',(0,r.kt)("inlineCode",{parentName:"em"},"./install.sh"),", try ",(0,r.kt)("inlineCode",{parentName:"em"},"run chmod +x ./install.sh")," then retry the install command.")),(0,r.kt)("h2",{id:"utilisation"},"Utilisation"),(0,r.kt)("p",null,"Execute takes:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"-l [language-package].Adaptor"),": L'adaptateur \xe9tant utilis\xe9"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"-e [expression.js]:")," L'expression en cours de test"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"-s [state.json]"),": Le message ",(0,r.kt)("inlineCode",{parentName:"li"},"donn\xe9es : {...}")," et ",(0,r.kt)("inlineCode",{parentName:"li"},"configuration : {...}")," du credential"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"-o [output.json]"),": Le fichier dans lequel la sortie sera \xe9crite")),(0,r.kt)("h3",{id:"run-a-job-using-bash"},"Run a job using bash"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"~/devtools/core/bin/core execute \\\n  -l ~/devtools/adaptors/language-http \\\n  -s ./tmp/state.json \\\n  -o ./tmp/output.json \\\n  -e ./tmp/expression.js\n")),(0,r.kt)("h3",{id:"more-on-devtools"},"More on Devtools"),(0,r.kt)(l.Z,{url:"https://www.youtube.com/watch?v=fkGI5YLp18s",mdxType:"ReactPlayer"}),(0,r.kt)("h3",{id:"install-a-specific-adaptor-version"},"Install a specific adaptor version"),(0,r.kt)("p",null,"To install specific adaptors, run ",(0,r.kt)("inlineCode",{parentName:"p"},"./install.sh ${ssh || https} language-${name}")),(0,r.kt)("p",null,"When you install a new adaptor, the latest version will be enabled by default. To switch the adaptor version when running jobs locally, in the root of the adaptor directory, run:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"git checkout tags/v2.4.15")," (substitute ",(0,r.kt)("inlineCode",{parentName:"p"},"2.4.15")," with the adaptor version you want)"),(0,r.kt)("h3",{id:"the---test-option"},"The ",(0,r.kt)("inlineCode",{parentName:"h3"},"--test")," option"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"~/devtools/core/bin/core execute \\\n  -l ~/devtools/adaptors/language-http \\\n  -s ./tmp/state.json \\\n  -o ./tmp/output.json \\\n  -e ./tmp/expression.js \\\n  --test\n")),(0,r.kt)("p",null,"This intercepts all HTTP requests and displays the request information for debugging."),(0,r.kt)("h4",{id:"fakeadaptor"},(0,r.kt)("inlineCode",{parentName:"h4"},".FakeAdaptor")),(0,r.kt)("p",null,"Adaptors may provide dummy modules for testing. ",(0,r.kt)("inlineCode",{parentName:"p"},"language-salesforce")," has a built-in ",(0,r.kt)("inlineCode",{parentName:"p"},".FakeAdaptor")," which allows a user to test expressions on data without sending them to a real Salesforce server."),(0,r.kt)("p",null,"Instead of using ",(0,r.kt)("inlineCode",{parentName:"p"},"-l ./language-salesforce.Adaptor"),", use ",(0,r.kt)("inlineCode",{parentName:"p"},"-l./language-salesforce.FakeAdaptor")," to test expressions offline: ",(0,r.kt)("inlineCode",{parentName:"p"},"./core/bin/core execute -l ./language-salesforce.FakeAdaptor -s ./tmp/state.json -o ./tmp/output.json -e ./tmp/expression.js")),(0,r.kt)("h4",{id:"tests-hors-ligne-pour-dautres-adaptateurs"},"Tests hors ligne pour d'autres adaptateurs"),(0,r.kt)("p",null,"For most standard adaptors which make use of HTTP requests, you can add ",(0,r.kt)("inlineCode",{parentName:"p"},"--test")," to the execute command to intercept all HTTP requests and return a ",(0,r.kt)("inlineCode",{parentName:"p"},"200"),"."),(0,r.kt)("h2",{id:"hands-on-with-devtools-and-the-command-line"},"Hands-on with devtools and the command line"),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Check out this example workflow for using devtools in your day-to-day."))),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"cd")," in the folder containing the repo you're working on."),(0,r.kt)("li",{parentName:"ol"},"You can keep your job scripts anywhere, but store ",(0,r.kt)("inlineCode",{parentName:"li"},"state.json")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"output.json")," in a ",(0,r.kt)("inlineCode",{parentName:"li"},"tmp")," folder. In our repos we always add the ",(0,r.kt)("inlineCode",{parentName:"li"},"tmp")," directory in our ",(0,r.kt)("inlineCode",{parentName:"li"},".gitignore")," file that tells Github to ignore the specified paths. Make sure you have your ",(0,r.kt)("inlineCode",{parentName:"li"},".gitignore")," file and you know what's tracked by Github and what's not. ",(0,r.kt)("inlineCode",{parentName:"li"},"state")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"config")," may contain sensitive configuration information and project data so never upload them to Github!"),(0,r.kt)("li",{parentName:"ol"},"The devtools command is a mouthful. You can search your command line history with ",(0,r.kt)("inlineCode",{parentName:"li"},"Ctl-r")," and typing core to pull it up the devtools command. Notice that it\u2019s got line breaks and a flag for all the important bits\u2026 ",(0,r.kt)("inlineCode",{parentName:"li"},"-l")," for language-package (adaptor), ",(0,r.kt)("inlineCode",{parentName:"li"},"-s")," for state, ",(0,r.kt)("inlineCode",{parentName:"li"},"-o")," for output, and ",(0,r.kt)("inlineCode",{parentName:"li"},"-e")," for expression. You can also save your frequently used devtools commands in a document and just copy-paste."),(0,r.kt)("li",{parentName:"ol"},"It's quick the change job names or the adaptor in the command. If you put all your adaptors in the same folder ",(0,r.kt)("inlineCode",{parentName:"li"},"~/devtools/adaptors/language-_________")," you can quickly swap them in the command, as you can see in the video below. The Backspace key deletes characters behind your cursor, Delete deletes them in front."),(0,r.kt)("li",{parentName:"ol"},"You can use the TAB key to auto-complete the file path as you search for a job."),(0,r.kt)("li",{parentName:"ol"},"Once you've changed a couple of characters for the adaptor and expression (in the video ",(0,r.kt)("inlineCode",{parentName:"li"},"state")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"output")," stayed the same because we're using the ",(0,r.kt)("inlineCode",{parentName:"li"},"tmp")," convention) press enter and see the results.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"devtools",src:n(47644).Z,width:"1678",height:"796"})),(0,r.kt)("h2",{id:"configure-an-openfn-project"},"Configure an OpenFn project"),(0,r.kt)("p",null,"You can use YAML project configuration files to define projects both on the ",(0,r.kt)("a",{parentName:"p",href:"/documentation/deploy/platform"},"OpenFn platform")," and in ",(0,r.kt)("a",{parentName:"p",href:"https://openfn.github.io/microservice/readme.html#content"},"OpenFn microservice"),". Running ",(0,r.kt)("inlineCode",{parentName:"p"},"./scripts/generate-project.js")," helps you build a project config YAML interactively, adding your triggers, credentials and jobs to the config. You can read more about the config file ",(0,r.kt)("a",{parentName:"p",href:"https://openfn.github.io/microservice/readme.html#sample-configuration"},"here")),(0,r.kt)("p",null,"If you choose ",(0,r.kt)("inlineCode",{parentName:"p"},"monolith")," mode, all your job code will be included in the YAML. In ",(0,r.kt)("inlineCode",{parentName:"p"},"URI")," mode, you\u2019ll get a config file with URI-s to your defined jobs."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Generate Project",src:n(78018).Z,width:"720",height:"550"})),(0,r.kt)("h2",{id:"pre-requisites"},"Pre-Requisites"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://nodejs.org/en/download/"},"Node")," is required to run jobs and use many of the scripts in Devtools (e.g., ",(0,r.kt)("inlineCode",{parentName:"p"},"npm run build")," is required after changes to adaptors).")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"A basic working knowledge of NodeJs, promises and asynchronous functions is essential for writing adaptors."))),(0,r.kt)("h2",{id:"scripts"},"Scripts"),(0,r.kt)("p",null,"Devtools comes with a collection of scripts to aid in setting up a development environment for adaptor work, and include commands to quickly clone a large number of adaptors, create tarballs of adaptors with only production dependencies included, etc."),(0,r.kt)("p",null,"For the kitchen sink, run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"./install ssh\n./scripts/bootstrap npm-install\n")),(0,r.kt)("p",null,"In order to run the scripts, ensure you have cd'd into the project directory and enter ",(0,r.kt)("inlineCode",{parentName:"p"},"./scripts/<script-name>")),(0,r.kt)("h3",{id:"bootstrap"},"bootstrap"),(0,r.kt)("p",null,"Installs all adaptors in ",(0,r.kt)("inlineCode",{parentName:"p"},"repos")," file to the ",(0,r.kt)("inlineCode",{parentName:"p"},"/adaptors")," directory and prepares the working directory. This needs to be run before running any of the other scripts. Pass ",(0,r.kt)("inlineCode",{parentName:"p"},"npm-install")," to run npm install for each adaptor also."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"./scripts/bootstrap npm-install")," - to clone, set up hooks and npm install in each ",(0,r.kt)("inlineCode",{parentName:"p"},"./scripts/bootstrap"),"- to clone and set up hooks in each"),(0,r.kt)("h3",{id:"generate-projectjs"},"generate-project.js"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"./scripts/generate-project.js")," interactively generates a YAML project configuration file that can be used both on the OpenFn platform and in OpenFn microservice to define projects."),(0,r.kt)("h3",{id:"generate-doclets"},"generate-doclets"),(0,r.kt)("p",null,"Iterates overs all language pack folder names found in the ",(0,r.kt)("inlineCode",{parentName:"p"},"repos")," list and creates a doclet json file in the ",(0,r.kt)("inlineCode",{parentName:"p"},"doclets")," directory."),(0,r.kt)("h3",{id:"analyse-doclets"},"analyse-doclets"),(0,r.kt)("p",null,"Iterates overs all doclets found in ",(0,r.kt)("inlineCode",{parentName:"p"},"doclets")," and gives a tree view of the doclet structure using ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/OpenFn/jsdoc-query"},"jsdoc-query"),"."),(0,r.kt)("h2",{id:"building-adaptors-for-platform"},"Building adaptors for platform"),(0,r.kt)("p",null,"All adaptor releases are built inside a ",(0,r.kt)("inlineCode",{parentName:"p"},"docker container"),". The importance of running the build and release process through a container is to standardize the build environment across the team. While adaptors can be built and run on lots of different operating systems and architectures, when we run the platform on Kubernetes it expects linux boxes running x86... so that's where we build these official releases."),(0,r.kt)("p",null,"Here's how to build and release adaptors:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Reopen your package in ",(0,r.kt)("strong",{parentName:"li"},"dev-container")," by typing ",(0,r.kt)("inlineCode",{parentName:"li"},"ctrl+shift+p")," (or ",(0,r.kt)("inlineCode",{parentName:"li"},"cmd+shift+p")," on mac) and choosing ",(0,r.kt)("strong",{parentName:"li"},"Remote-Container: Rebuild and Reopen in Container"),"."),(0,r.kt)("li",{parentName:"ol"},"After the build is finished, open a terminal in vscode and run ",(0,r.kt)("inlineCode",{parentName:"li"},"openfn-devtools release .")," to build, tag, and push to ",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.com/"},"npm"),"."),(0,r.kt)("li",{parentName:"ol"},"Run ",(0,r.kt)("inlineCode",{parentName:"li"},"openfn-devtools package-release .")," to package everything with production dependencies and push to ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/openfn"},"Github"),".")),(0,r.kt)("p",null,"Depending on how you've configured your local environment and your VSCode installation, you might encounter access issues preventing connections to NPM and GitHub."),(0,r.kt)("h3",{id:"troubleshooting"},"Troubleshooting"),(0,r.kt)("p",null,"There are a number of issues that you may encounter related to sharing settings that are responsible for passing ssh keys and local configurations from your host machine into the VSCode container."),(0,r.kt)("h3",{id:"git-config-issues"},"Git config issues"),(0,r.kt)("p",null,"An issue can pop up about git config not set, To solve this, you should probably set your email and name globally using the commands below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},'git config --global user.email "youremail@something.com"\ngit config --global user.name "Your Name"\n')),(0,r.kt)("h3",{id:"ssh-key-issues"},"SSH key issues"),(0,r.kt)("p",null,"You may find that you are unable to access your ",(0,r.kt)("inlineCode",{parentName:"p"},"ssh")," keys from inside the container."),(0,r.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"Error")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"permission denied (publickey)"))),(0,r.kt)("p",null,"To solve this, first make sure the ",(0,r.kt)("inlineCode",{parentName:"p"},"ssh agent")," is ",(0,r.kt)("a",{parentName:"p",href:"https://code.visualstudio.com/docs/remote/containers#_sharing-git-credentials-with-your-container"},"up and running"),". In MacOS, it is running by default. On Linux you can start the agent using the command"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"eval $(ssh-agent -s)\n")),(0,r.kt)("p",null,"Then you can add these line your ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.bash_profile")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.zprofile")," (for Zsh) to make it run by default."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},'if [ -z "$SSH_AUTH_SOCK" ]; then\n   RUNNING_AGENT="`ps -ax | grep \'ssh-agent -s\' | grep -v grep | wc -l | tr -d \'[:space:]\'`"\n   if [ "$RUNNING_AGENT" = "0" ]; then\n      # Launch a new instance of the agent\n      ssh-agent -s &> $HOME/.ssh/ssh-agent\n   fi\n   eval `cat $HOME/.ssh/ssh-agent`\nfi\n')),(0,r.kt)("p",null,"Next, run the command below to add your identity to the ssh agent:"),(0,r.kt)(f,{defaultValue:"linux",values:[{label:"Linux",value:"linux"},{label:"MacOS",value:"macos"}],mdxType:"Tabs"},(0,r.kt)(N,{value:"linux",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"  ssh-add <path-to-your-ssh-file>\n"))),(0,r.kt)(N,{value:"macos",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"  ssh-add -A\n")))),(0,r.kt)("p",null,"Finally, configure VSCode to share your local ssh keys with the dev container. In VSCode, go to ",(0,r.kt)("inlineCode",{parentName:"p"},"Settings"),", and in the search bar, type ",(0,r.kt)("inlineCode",{parentName:"p"},"terminal.integrated.inherit"),". You should see the option in the image below and check it if it's unchecked."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"vscode settings",src:n(78697).Z,width:"2688",height:"418"})),(0,r.kt)("h3",{id:"github-token-sharing"},"Github token sharing"),(0,r.kt)("p",null,"Our release process relies on a ",(0,r.kt)("inlineCode",{parentName:"p"},"GH_TOKEN")," variable. Set up an ",(0,r.kt)("a",{parentName:"p",href:"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token"},"access token")," in Github."),(0,r.kt)("p",null,"In your ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.bash_profile")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.zshrc")," file, export the newly created token by adding this line:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"export GH_TOKEN=<TOKEN>\n")),(0,r.kt)("h2",{id:"using-a-new-adaptor-in-an-openfnplatform-instance"},"Using a new adaptor in an OpenFn/platform instance"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Add your release to the ",(0,r.kt)("inlineCode",{parentName:"li"},"scripts/install-lp")," script."),(0,r.kt)("li",{parentName:"ol"},"Add the version number to ",(0,r.kt)("inlineCode",{parentName:"li"},"priv/adaptors.json"),"."),(0,r.kt)("li",{parentName:"ol"},"Add the ",(0,r.kt)("inlineCode",{parentName:"li"},"bodySchema")," to ",(0,r.kt)("inlineCode",{parentName:"li"},"CredentialView.js"),".")))}O.isMDXComponent=!0},47644:function(e,t,n){t.Z=n.p+"assets/images/devtools-d9d74f314be912295da4d6ff02b9112a.gif"},78018:function(e,t,n){t.Z=n.p+"assets/images/generate-project-40444c4a75e8e0b63a1cbe1e02d7f49d.gif"},78697:function(e,t,n){t.Z=n.p+"assets/images/vscode-settings-41387d833ade3295b22b17fbd500c692.png"}}]);