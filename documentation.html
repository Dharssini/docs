


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="README, Getting Started, Documentation, and Release Notes for OpenFn">
      
      
        <link rel="canonical" href="https://openfn.github.io/docs/documentation.html">
      
      
        <meta name="author" content="OpenFn">
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.4">
    
    
      
        <title>Platform Docs - OpenFn Documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.c4007cdc.min.css">
      
        <link rel="stylesheet" href="assets/stylesheets/palette.8435c73a.min.css">
      
      
        
        
        <meta name="theme-color" content="#03a9f4">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7C&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
        
<link rel="preconnect dns-prefetch" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-57118569-4","openfn.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview")})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="light-blue" data-md-color-accent="deep-purple">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#platform-docs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://openfn.github.io/docs" title="OpenFn Documentation" class="md-header-nav__button md-logo" aria-label="OpenFn Documentation">
      
  <img src="images/logo.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            OpenFn Documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Platform Docs
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/OpenFn/docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
          

  

<nav class="md-tabs md-tabs--active" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="index.html" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="documentation.html" class="md-tabs__link md-tabs__link--active">
          The Platform
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="core.html" class="md-tabs__link">
          Writing Jobs
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="source-apps.html" class="md-tabs__link">
          Connecting Data Sources
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://openfn.github.io/docs" title="OpenFn Documentation" class="md-nav__button md-logo" aria-label="OpenFn Documentation">
      
  <img src="images/logo.svg" alt="logo">

    </a>
    OpenFn Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/OpenFn/docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="index.html" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="faqs.html" title="FAQs" class="md-nav__link">
      FAQs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="quick-start.html" title="Quick Start Guide" class="md-nav__link">
      Quick Start Guide
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      The Platform
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="The Platform" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        The Platform
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Platform Docs
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="documentation.html" title="Platform Docs" class="md-nav__link md-nav__link--active">
      Platform Docs
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#connecting-source-applications" class="md-nav__link">
    Connecting Source Applications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-compatible-notifications-service" class="md-nav__link">
    Creating a compatible notifications service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#triggers" class="md-nav__link">
    Triggers
  </a>
  
    <nav class="md-nav" aria-label="Triggers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filter-matching" class="md-nav__link">
    Filter Matching
  </a>
  
    <nav class="md-nav" aria-label="Filter Matching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filter-1" class="md-nav__link">
    Filter 1:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-a-match" class="md-nav__link">
    Message a (MATCH):
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-b-no-match" class="md-nav__link">
    Message b (NO MATCH):
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processing-time-triggered-jobs" class="md-nav__link">
    Processing time-triggered jobs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#credentials" class="md-nav__link">
    Credentials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jobs" class="md-nav__link">
    Jobs
  </a>
  
    <nav class="md-nav" aria-label="Jobs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#composing-job-expressions" class="md-nav__link">
    Composing Job Expressions
  </a>
  
    <nav class="md-nav" aria-label="Composing Job Expressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-job-expression" class="md-nav__link">
    Basic Job Expression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#job-expression-with-custom-javascript" class="md-nav__link">
    Job Expression with Custom Javascript
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#available-javascript-globals" class="md-nav__link">
    Available Javascript Globals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selected-named-functions" class="md-nav__link">
    Selected Named Functions
  </a>
  
    <nav class="md-nav" aria-label="Selected Named Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#language-common" class="md-nav__link">
    language-common
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#betaeachjson_path-operation" class="md-nav__link">
    beta.each(JSON_path, operation(...))
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#salesforce" class="md-nav__link">
    Salesforce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhis2" class="md-nav__link">
    dhis2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmrs" class="md-nav__link">
    OpenMRS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inbox" class="md-nav__link">
    Inbox
  </a>
  
    <nav class="md-nav" aria-label="Inbox">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filter-messages-in-your-inbox" class="md-nav__link">
    Filter messages in your inbox
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-reprocess-messages" class="md-nav__link">
    Bulk reprocess messages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-messages-to-csv" class="md-nav__link">
    Export messages to CSV
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#activity" class="md-nav__link">
    Activity
  </a>
  
    <nav class="md-nav" aria-label="Activity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#runs" class="md-nav__link">
    Runs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-runs-in-the-activity-view" class="md-nav__link">
    Filter runs in the Activity view
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-retry-runs" class="md-nav__link">
    Bulk retry runs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-runs-to-csv" class="md-nav__link">
    Export runs to CSV
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github-version-control" class="md-nav__link">
    GitHub version control
  </a>
  
    <nav class="md-nav" aria-label="GitHub version control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivation" class="md-nav__link">
    Motivation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-steps" class="md-nav__link">
    Setup Steps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-version-control" class="md-nav__link">
    Advanced Version Control
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-error-messages" class="md-nav__link">
    Common Error Messages
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diy" class="md-nav__link">
    DIY
  </a>
  
    <nav class="md-nav" aria-label="DIY">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#statejson" class="md-nav__link">
    State.json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    Appendix
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-code-for-diy-section" class="md-nav__link">
    Sample code for DIY section
  </a>
  
    <nav class="md-nav" aria-label="Sample code for DIY section">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#messagejson" class="md-nav__link">
    message.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expressionjs" class="md-nav__link">
    expression.js
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configjson" class="md-nav__link">
    config.json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filters-cont" class="md-nav__link">
    Filters (cont.)
  </a>
  
    <nav class="md-nav" aria-label="Filters (cont.)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#match-messages-where-the-formid-is-robot_photo_21042015" class="md-nav__link">
    Match messages WHERE the formId is "Robot_Photo_21.04.2015":
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-a-message-where-this-and-that-are-both-included" class="md-nav__link">
    Match a message WHERE this AND that are both included:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-a-message-with-two-fragments-inside-an-array-called-data" class="md-nav__link">
    Match a message with two fragments inside an array called data:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-a-message-with-a-fragment-inside-another-object-called-form" class="md-nav__link">
    Match a message with a fragment inside another object called form:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jobs-cont" class="md-nav__link">
    Jobs (cont.)
  </a>
  
    <nav class="md-nav" aria-label="Jobs (cont.)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#job-expression-for-commcare-to-sf" class="md-nav__link">
    Job expression (for CommCare to SF)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-the-data-array-in-open-data-kit-submissions" class="md-nav__link">
    Accessing the "data array" in Open Data Kit submissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#odk-to-salesforce-create-parent-record-with-many-children-from-parent-data" class="md-nav__link">
    ODK to Salesforce: create parent record with many children from parent data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-many-child-records-without-a-repeat-group-in-odk" class="md-nav__link">
    Create many child records WITHOUT a repeat group in ODK
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#salesforce-perform-an-update" class="md-nav__link">
    Salesforce: perform an update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#salesforce-set-record-type-using-relationship" class="md-nav__link">
    Salesforce: Set record type using 'relationship(...)'
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#salesforce-set-record-type-using-record-type-id" class="md-nav__link">
    Salesforce: Set record type using record Type ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#telerivet-send-sms-based-on-salesforce-workflow-alert" class="md-nav__link">
    Telerivet: Send SMS based on Salesforce workflow alert
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-fetch-but-dont-fail" class="md-nav__link">
    HTTP: fetch but don't fail!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-dhis2-events-api-job" class="md-nav__link">
    Sample DHIS2 events API job:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-dhis2-data-value-sets-api-job" class="md-nav__link">
    Sample DHIS2 data value sets API job:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-openmrs-expression-creates-a-person-and-then-a-patient" class="md-nav__link">
    sample openMRS expression, creates a person and then a patient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merge-many-values-into-a-child-path" class="md-nav__link">
    merge many values into a child path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arraytostring" class="md-nav__link">
    arrayToString
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-an-image-url-from-an-odk-submission" class="md-nav__link">
    access an image URL from an ODK submission
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alterstate-alter-state-to-make-sure-data-is-in-an-array" class="md-nav__link">
    alterState (alter state) to make sure data is in an array
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-functions-cont" class="md-nav__link">
    Anonymous Functions (cont.)
  </a>
  
    <nav class="md-nav" aria-label="Anonymous Functions (cont.)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-replacer" class="md-nav__link">
    Custom replacer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-arraytostring" class="md-nav__link">
    Custom arrayToString
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-concatenation" class="md-nav__link">
    Custom concatenation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concatenation-of-null-values" class="md-nav__link">
    Concatenation of null values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-nth-reference-id" class="md-nav__link">
    Custom Nth reference ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-date-string-to-standard-iso-date-for-salesforce" class="md-nav__link">
    Convert date string to standard ISO date for Salesforce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-external-id-fields-for-relationships-during-a-bulk-load-in-salesforce" class="md-nav__link">
    Use external ID fields for relationships during a bulk load in Salesforce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-upsert-with-an-external-id-in-salesforce" class="md-nav__link">
    Bulk upsert with an external ID in salesforce
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-errors-and-how-to-handle-them" class="md-nav__link">
    Common errors and how to handle them
  </a>
  
    <nav class="md-nav" aria-label="Common errors and how to handle them">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#are-master-detail-relationships-in-salesforce-reparentable" class="md-nav__link">
    Are Master-detail relationships in Salesforce reparentable?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="release-notes.html" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Writing Jobs
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Writing Jobs" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Writing Jobs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="core.html" title="Job Execution" class="md-nav__link">
      Job Execution
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Connecting Data Sources
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Connecting Data Sources" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Connecting Data Sources
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="source-apps.html" title="Source Apps" class="md-nav__link">
      Source Apps
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#connecting-source-applications" class="md-nav__link">
    Connecting Source Applications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-compatible-notifications-service" class="md-nav__link">
    Creating a compatible notifications service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#triggers" class="md-nav__link">
    Triggers
  </a>
  
    <nav class="md-nav" aria-label="Triggers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filter-matching" class="md-nav__link">
    Filter Matching
  </a>
  
    <nav class="md-nav" aria-label="Filter Matching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filter-1" class="md-nav__link">
    Filter 1:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-a-match" class="md-nav__link">
    Message a (MATCH):
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-b-no-match" class="md-nav__link">
    Message b (NO MATCH):
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processing-time-triggered-jobs" class="md-nav__link">
    Processing time-triggered jobs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#credentials" class="md-nav__link">
    Credentials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jobs" class="md-nav__link">
    Jobs
  </a>
  
    <nav class="md-nav" aria-label="Jobs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#composing-job-expressions" class="md-nav__link">
    Composing Job Expressions
  </a>
  
    <nav class="md-nav" aria-label="Composing Job Expressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-job-expression" class="md-nav__link">
    Basic Job Expression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#job-expression-with-custom-javascript" class="md-nav__link">
    Job Expression with Custom Javascript
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#available-javascript-globals" class="md-nav__link">
    Available Javascript Globals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selected-named-functions" class="md-nav__link">
    Selected Named Functions
  </a>
  
    <nav class="md-nav" aria-label="Selected Named Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#language-common" class="md-nav__link">
    language-common
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#betaeachjson_path-operation" class="md-nav__link">
    beta.each(JSON_path, operation(...))
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#salesforce" class="md-nav__link">
    Salesforce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhis2" class="md-nav__link">
    dhis2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmrs" class="md-nav__link">
    OpenMRS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inbox" class="md-nav__link">
    Inbox
  </a>
  
    <nav class="md-nav" aria-label="Inbox">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filter-messages-in-your-inbox" class="md-nav__link">
    Filter messages in your inbox
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-reprocess-messages" class="md-nav__link">
    Bulk reprocess messages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-messages-to-csv" class="md-nav__link">
    Export messages to CSV
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#activity" class="md-nav__link">
    Activity
  </a>
  
    <nav class="md-nav" aria-label="Activity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#runs" class="md-nav__link">
    Runs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-runs-in-the-activity-view" class="md-nav__link">
    Filter runs in the Activity view
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-retry-runs" class="md-nav__link">
    Bulk retry runs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-runs-to-csv" class="md-nav__link">
    Export runs to CSV
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github-version-control" class="md-nav__link">
    GitHub version control
  </a>
  
    <nav class="md-nav" aria-label="GitHub version control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivation" class="md-nav__link">
    Motivation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-steps" class="md-nav__link">
    Setup Steps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-version-control" class="md-nav__link">
    Advanced Version Control
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-error-messages" class="md-nav__link">
    Common Error Messages
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diy" class="md-nav__link">
    DIY
  </a>
  
    <nav class="md-nav" aria-label="DIY">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#statejson" class="md-nav__link">
    State.json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    Appendix
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-code-for-diy-section" class="md-nav__link">
    Sample code for DIY section
  </a>
  
    <nav class="md-nav" aria-label="Sample code for DIY section">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#messagejson" class="md-nav__link">
    message.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expressionjs" class="md-nav__link">
    expression.js
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configjson" class="md-nav__link">
    config.json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filters-cont" class="md-nav__link">
    Filters (cont.)
  </a>
  
    <nav class="md-nav" aria-label="Filters (cont.)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#match-messages-where-the-formid-is-robot_photo_21042015" class="md-nav__link">
    Match messages WHERE the formId is "Robot_Photo_21.04.2015":
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-a-message-where-this-and-that-are-both-included" class="md-nav__link">
    Match a message WHERE this AND that are both included:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-a-message-with-two-fragments-inside-an-array-called-data" class="md-nav__link">
    Match a message with two fragments inside an array called data:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-a-message-with-a-fragment-inside-another-object-called-form" class="md-nav__link">
    Match a message with a fragment inside another object called form:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jobs-cont" class="md-nav__link">
    Jobs (cont.)
  </a>
  
    <nav class="md-nav" aria-label="Jobs (cont.)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#job-expression-for-commcare-to-sf" class="md-nav__link">
    Job expression (for CommCare to SF)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-the-data-array-in-open-data-kit-submissions" class="md-nav__link">
    Accessing the "data array" in Open Data Kit submissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#odk-to-salesforce-create-parent-record-with-many-children-from-parent-data" class="md-nav__link">
    ODK to Salesforce: create parent record with many children from parent data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-many-child-records-without-a-repeat-group-in-odk" class="md-nav__link">
    Create many child records WITHOUT a repeat group in ODK
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#salesforce-perform-an-update" class="md-nav__link">
    Salesforce: perform an update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#salesforce-set-record-type-using-relationship" class="md-nav__link">
    Salesforce: Set record type using 'relationship(...)'
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#salesforce-set-record-type-using-record-type-id" class="md-nav__link">
    Salesforce: Set record type using record Type ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#telerivet-send-sms-based-on-salesforce-workflow-alert" class="md-nav__link">
    Telerivet: Send SMS based on Salesforce workflow alert
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-fetch-but-dont-fail" class="md-nav__link">
    HTTP: fetch but don't fail!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-dhis2-events-api-job" class="md-nav__link">
    Sample DHIS2 events API job:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-dhis2-data-value-sets-api-job" class="md-nav__link">
    Sample DHIS2 data value sets API job:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-openmrs-expression-creates-a-person-and-then-a-patient" class="md-nav__link">
    sample openMRS expression, creates a person and then a patient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merge-many-values-into-a-child-path" class="md-nav__link">
    merge many values into a child path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arraytostring" class="md-nav__link">
    arrayToString
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-an-image-url-from-an-odk-submission" class="md-nav__link">
    access an image URL from an ODK submission
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alterstate-alter-state-to-make-sure-data-is-in-an-array" class="md-nav__link">
    alterState (alter state) to make sure data is in an array
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-functions-cont" class="md-nav__link">
    Anonymous Functions (cont.)
  </a>
  
    <nav class="md-nav" aria-label="Anonymous Functions (cont.)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-replacer" class="md-nav__link">
    Custom replacer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-arraytostring" class="md-nav__link">
    Custom arrayToString
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-concatenation" class="md-nav__link">
    Custom concatenation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concatenation-of-null-values" class="md-nav__link">
    Concatenation of null values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-nth-reference-id" class="md-nav__link">
    Custom Nth reference ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-date-string-to-standard-iso-date-for-salesforce" class="md-nav__link">
    Convert date string to standard ISO date for Salesforce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-external-id-fields-for-relationships-during-a-bulk-load-in-salesforce" class="md-nav__link">
    Use external ID fields for relationships during a bulk load in Salesforce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-upsert-with-an-external-id-in-salesforce" class="md-nav__link">
    Bulk upsert with an external ID in salesforce
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-errors-and-how-to-handle-them" class="md-nav__link">
    Common errors and how to handle them
  </a>
  
    <nav class="md-nav" aria-label="Common errors and how to handle them">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#are-master-detail-relationships-in-salesforce-reparentable" class="md-nav__link">
    Are Master-detail relationships in Salesforce reparentable?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/OpenFn/docs/edit/master/docs/documentation.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="platform-docs">Platform Docs<a class="headerlink" href="#platform-docs" title="Permanent link">#</a></h1>
<h2 id="connecting-source-applications">Connecting Source Applications<a class="headerlink" href="#connecting-source-applications" title="Permanent link">#</a></h2>
<p>Most modern web applications have a feature that allows you to <code>push</code>, <code>publish</code>, or <code>post</code> data to another URL when a certain <strong>event</strong> takes place. This event could be a form submission, mobile payment, patient registration, or barcode scan submission from a mobile app. The key is that your source application will notify OpenFn when <em>something happens</em>.</p>
<ol>
<li>
<p>Go to the "settings" or "administration" page for your source app, and look for a <code>Webhook API</code>, <code>Data Forwarding API</code>, or <code>Notifications API</code>. Write to the developers of your application if none is provided out of the box.</p>
</li>
<li>
<p>When setting up forwarding, select to send messages in <code>JSON</code> to your project's <code>inbox URL</code>. This is a UUID that serves as your API token. You can find and copy your secure inbox URL by clicking on the "copy URL" link in the bottom-right corner of the project in question on your <strong><a href="https://www.openfn.org/projects">project dashboard</a></strong> page or by using the "Copy URL" button on your project's "Inbox" page..</p>
</li>
<li>
<p>Soon you'll see new messages arrive in your <strong>Inbox</strong>.</p>
</li>
</ol>
<h2 id="creating-a-compatible-notifications-service">Creating a compatible notifications service<a class="headerlink" href="#creating-a-compatible-notifications-service" title="Permanent link">#</a></h2>
<p>If you are a developer, looking to set up a compatible notifications API for OpenFn, please see our <a href="/source-applications/#application-developers">Application Developers</a> section.</p>
<h2 id="triggers">Triggers<a class="headerlink" href="#triggers" title="Permanent link">#</a></h2>
<p>Triggers run jobs. They can either be "filter" triggers or "timer" triggers. Filter triggers watch incoming messages and run them through jobs when they match the filter criteria. Timer triggers run jobs after a recurring interval has elapsed.</p>
<p>You, as a user, specify the filter <strong>criteria</strong> which determines which messages in your inbox should trigger job runs. This means that if any segment of a message body <strong>matches</strong> the string of <code>JSON</code> you gave as a filter, the filter will run and trigger a job (assuming you created one).</p>
<p>The filter criteria takes the form of a string of valid <code>JSON</code>. In a SQL query, this string will be used in the WHERE clause, for example:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">receipts</span>
  <span class="k">WHERE</span> <span class="n">body</span><span class="p">::</span><span class="n">jsonb</span> <span class="o">@&gt;</span>
    <span class="s1">&#39;{&quot;Name&quot;:&quot;Aleksa Iwobi&quot;}&#39;</span><span class="p">::</span><span class="n">jsonb</span><span class="p">;</span>
</code></pre></div>
</td></tr></table>

<h3 id="filter-matching">Filter Matching<a class="headerlink" href="#filter-matching" title="Permanent link">#</a></h3>
<p>To illustrate filter matching, refer to the <code>JSON</code> strings below. Message "a" will match filter '1', but message "b" will not.</p>
<h4 id="filter-1">Filter 1:<a class="headerlink" href="#filter-1" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;formID&quot;</span><span class="p">:</span><span class="s2">&quot;patient_registration_v7&quot;</span><span class="p">}</span>
</code></pre></div>
</td></tr></table>

<h4 id="message-a-match">Message a (MATCH):<a class="headerlink" href="#message-a-match" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;submissionDate&quot;</span><span class="p">:</span><span class="s2">&quot;2016-01-15&quot;</span><span class="p">,</span> <span class="nt">&quot;formID&quot;</span><span class="p">:</span><span class="s2">&quot;patient_registration_v7&quot;</span><span class="p">,</span> <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Jack Wilshere&quot;</span><span class="p">,</span> <span class="nt">&quot;dob&quot;</span><span class="p">:</span><span class="s2">&quot;1986-05-16&quot;</span><span class="p">,</span> <span class="nt">&quot;medications&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;anaphlene&quot;</span><span class="p">,</span><span class="s2">&quot;zaradood&quot;</span><span class="p">,</span><span class="s2">&quot;morphofast&quot;</span><span class="p">]}</span>
</code></pre></div>
</td></tr></table>

<h4 id="message-b-no-match">Message b (NO MATCH):<a class="headerlink" href="#message-b-no-match" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;submissionDate&quot;</span><span class="p">:</span><span class="s2">&quot;2016-01-16&quot;</span><span class="p">,</span> <span class="nt">&quot;formID&quot;</span><span class="p">:</span><span class="s2">&quot;patient_registration_v8&quot;</span><span class="p">,</span> <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Larry Bird&quot;</span><span class="p">,</span> <span class="nt">&quot;dob&quot;</span><span class="p">:</span><span class="s2">&quot;1982-03-21&quot;</span><span class="p">,</span> <span class="nt">&quot;medications&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;anaphlene&quot;</span><span class="p">,</span><span class="s2">&quot;zaradood&quot;</span><span class="p">,</span><span class="s2">&quot;morphofast&quot;</span><span class="p">]}</span>
</code></pre></div>
</td></tr></table>

<p>Message 'b' does not include <code>"formID":"patient_registration_v7"</code> and will not match filter '1'.</p>
<h3 id="processing-time-triggered-jobs">Processing time-triggered jobs<a class="headerlink" href="#processing-time-triggered-jobs" title="Permanent link">#</a></h3>
<p><strong>On-demand processing for jobs triggered by timers.</strong> If you’re leveraging timer triggers to run jobs at specific time intervals, you can now run a time triggered job on demand. This way you don’t have to wait for the timer to expire before testing! Simply click the process/ “play” button now available via the Job, Run, and Activity History pages.</p>
<p><img alt="Runs list run time trigger button" src="/docs/images/timetriggerunslist.png" /></p>
<p><img alt="Run history time trigger button" src="/docs/images/runtimetrigger1.png" /></p>
<h2 id="credentials">Credentials<a class="headerlink" href="#credentials" title="Permanent link">#</a></h2>
<p>Credentials are used to authorize connections to destination systems. In the future, our adaptors will use credentials to fetch meta-data from source and destination applications and make the job writing process easier.</p>
<p>Some systems (Salesforce, OpenMRS, DHIS2) require an instanceUrl, host, or ApiUrl. Leave off the final "/" in these Urls:
<code>https://login.salesforce.com</code> or <code>http://demo.openmrs.org/openmrs</code> or <code>https://play.dhis2.org</code>.</p>
<p>Credentials can only be viewed, or edited by a single user — their "owner" (or the person that created that credential). All the collaborators on a particular project can choose those credentials for use when defining a job.</p>
<h2 id="jobs">Jobs<a class="headerlink" href="#jobs" title="Permanent link">#</a></h2>
<p>A job defines the specific series of tasks or database actions to be performed when a triggering message is received or a timer interval has elapsed.</p>
<h3 id="composing-job-expressions">Composing Job Expressions<a class="headerlink" href="#composing-job-expressions" title="Permanent link">#</a></h3>
<p>In most cases, a job expression is a series of <code>create</code> or <code>upsert</code> actions that
are run after a message arrives, using data from that message. It could look
like this:</p>
<h4 id="basic-job-expression">Basic Job Expression<a class="headerlink" href="#basic-job-expression" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Patient__c&#39;</span><span class="p">,</span> <span class="nx">fields</span><span class="p">(</span>
  <span class="nx">field</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s1">&#39;form.surname&#39;</span><span class="p">)),</span>
  <span class="nx">field</span><span class="p">(</span><span class="s1">&#39;Age__c&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="p">));</span>
</code></pre></div>
</td></tr></table>

<p>That would create a new <code>Patient__c</code> in some other system. The patient's <code>Name</code>
will be determined by the triggering message (the value inside <code>form.surname</code>,
specifically) and the patient's <code>Age__c</code> will <em>always</em> be 7. See how we hard
coded it?</p>
<p>What you see above is OpenFn's own syntax, and you've got access to dozens of
common "helper functions" like <code>dataValue(path)</code> and destination specific
functions like <code>create(object,attributes)</code>. While most cases are covered
out-of-the-box, jobs are <strong>evaluated as Javascript</strong>. This means that you can
write your own custom, anonymous functions to do whatever your heart desires:</p>
<h4 id="job-expression-with-custom-javascript">Job Expression with Custom Javascript<a class="headerlink" href="#job-expression-with-custom-javascript" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Patient__c&#39;</span><span class="p">,</span> <span class="nx">fields</span><span class="p">(</span>
  <span class="nx">field</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="nx">state</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Manipulate state to get your desired output.&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">state</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">names</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">);</span>
  <span class="p">}),</span>
  <span class="nx">field</span><span class="p">(</span><span class="s1">&#39;Age__c&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="p">));</span>
</code></pre></div>
</td></tr></table>

<p>Here, the patient's name will be a comma separated concatenation of all the values in the <code>patient_names</code> array from our source message.</p>
<h3 id="available-javascript-globals">Available Javascript Globals<a class="headerlink" href="#available-javascript-globals" title="Permanent link">#</a></h3>
<p>For security reasons, users start with access to the following standard Javascript globals, and can request more by opening an issue on Github:</p>
<ul>
<li>Array</li>
<li>console</li>
<li>JSON</li>
<li>Number</li>
<li>Promise</li>
<li>String</li>
</ul>
<p>*N.B. The runtime environment on the server is Node v6.5.0.</p>
<p>Other than the expression tree, Jobs have certain attributes that must be set:</p>
<ol>
<li><strong>Filter</strong> - The message filter that will triggers the job.</li>
<li><strong>Adaptor</strong> - The adaptor for the destination system you're connecting to.</li>
<li><strong>Credential</strong> - The credential that will be used to gain access to that destination system.</li>
<li><strong>Active?</strong> - A boolean which determines whether the job runs in real-time when matching messages arrive.</li>
</ol>
<h3 id="selected-named-functions">Selected Named Functions<a class="headerlink" href="#selected-named-functions" title="Permanent link">#</a></h3>
<p>There are lots more available in the language-packs.</p>
<h4 id="language-common">language-common<a class="headerlink" href="#language-common" title="Permanent link">#</a></h4>
<ul>
<li><code>field('destination_field_name__c', 'value')</code> Returns a key, value pair in an array. <a href="https://github.com/OpenFn/language-common/blob/master/src/index.js#L248">(source)</a></li>
<li><code>fields(list_of_fields)</code> zips key value pairs into an object. <a href="https://github.com/OpenFn/language-common/blob/master/src/index.js#L258">(source)</a></li>
<li><code>dataValue('JSON_path')</code> Picks out a single value from source data. <a href="https://github.com/OpenFn/language-common/blob/master/src/index.js#L71">(source)</a></li>
<li><code>each(JSON_path, operation(...))</code> Scopes an array of data based on a JSONPath <a href="https://github.com/OpenFn/language-common/blob/master/src/index.js#L194">(source)</a>. See beta.each when using multiple each()'s in an expression.</li>
<li><code>each(merge(dataPath("CHILD_ARRAY[*]"),fields(field("metaId", dataValue("*meta-instance-id*")),field("parentId", lastReferenceValue("id")))), create(...))</code> merges data into an array then creates for each item in the array <a href="https://github.com/OpenFn/language-common/blob/master/src/index.js#L272">(source)</a></li>
<li><code>lastReferenceValue('id')</code> gets the sfID of the last item created <a href="https://github.com/OpenFn/language-common/blob/master/src/index.js#L96-L100">(source)</a></li>
<li><code>function(state){return state.references[state.references.length-N].id})</code> gets the sfID of the nth item created</li>
</ul>
<h4 id="betaeachjson_path-operation"><code>beta.each(JSON_path, operation(...))</code><a class="headerlink" href="#betaeachjson_path-operation" title="Permanent link">#</a></h4>
<p>Scopes an array of data based on a JSONPath but then returns to the state it was given upon completion <a href="https://github.com/OpenFn/language-common/blob/master/src/beta.js#L44">(source)</a>. This is necessary if you string multiple <code>each(...)</code> functions together in-line in the same expression. (E.g., Given data which has multiple separate 'repeat groups' in a form which are rendered as arrays, you want to create new records for each item inside the first repeat group, then <em>RETURN TO THE TOP LEVEL</em> of the data, and then create new records for each item in the second repeat group. Using <code>beta.each(...)</code> lets you enter the first array, create your records, then return to the top level and be able to enter the second array.</p>
<h4 id="salesforce">Salesforce<a class="headerlink" href="#salesforce" title="Permanent link">#</a></h4>
<ul>
<li><code>create("DEST_OBJECT_NAME__C", fields(...))</code> Create a new object. Takes 2 parameters: An object and attributes. <a href="https://github.com/OpenFn/language-salesforce/blob/master/src/Adaptor.js#L42-L63">(source)</a></li>
<li><code>upsert("DEST_OBJECT_NAME__C", "DEST_OBJECT_EXTERNAL_ID__C", fields(...))</code> Creates or updates an object. Takes 3 paraneters: An object, an ID field and attributes. <a href="https://github.com/OpenFn/language-salesforce/blob/master/src/Adaptor.js#L65-L80">(source)</a></li>
<li><code>relationship("DEST_RELATIONSHIP_NAME__r", "EXTERNAL_ID_ON_RELATED_OBJECT__C", "SOURCE_DATA_OR_VALUE")</code> Adds a lookup or 'dome insert' to a record. <a href="https://github.com/OpenFn/language-salesforce/blob/master/src/sourceHelpers.js#L21-L40">(source)</a></li>
</ul>
<h4 id="dhis2">dhis2<a class="headerlink" href="#dhis2" title="Permanent link">#</a></h4>
<ul>
<li><code>event(...)</code> Creates an event. <a href="https://github.com/OpenFn/language-dhis2/blob/master/src/Adaptor.js#L31-L60">(source)</a></li>
<li><code>dataValueSet(...)</code> Send data values using the dataValueSets resource <a href="https://github.com/OpenFn/language-dhis2/blob/master/src/Adaptor.js#L62-L82">(source)</a></li>
</ul>
<h4 id="openmrs">OpenMRS<a class="headerlink" href="#openmrs" title="Permanent link">#</a></h4>
<ul>
<li><code>person(...)</code> Takes a payload of data to create a person <a href="https://github.com/OpenFn/language-openmrs/blob/master/src/Adaptor.js#L31-L60">(source)</a></li>
<li><code>patient(...)</code> Takes a payload of data to create a patient <a href="https://github.com/OpenFn/language-openmrs/blob/master/src/Adaptor.js#L62-L90">(source)</a></li>
</ul>
<p><strong>For code block examples of job expressions, go to the <a href="#appendix">Appendix</a>.</strong></p>
<h2 id="inbox">Inbox<a class="headerlink" href="#inbox" title="Permanent link">#</a></h2>
<p>Your inbox contains the history of all messages that have passed in to your project, which may or may not have triggered a specific job. Messages are stored payloads or data that were sent via HTTP post to your inbox. They can be viewed in formatted JSON, edited, or manually processed (if they did not match a filter when they were originally delivered.)</p>
<p>To edit a message, click the "pencil and paper" icon next to that receipt. Be careful, as no original copy will be persisted.</p>
<h3 id="filter-messages-in-your-inbox">Filter messages in your inbox<a class="headerlink" href="#filter-messages-in-your-inbox" title="Permanent link">#</a></h3>
<p>To help you more quickly find relevant messages, you can now filter your inbox by:</p>
<ul>
<li><strong>Body Text</strong> - Search your messages for specific text (e.g., find surveys that contain “India” in the body). As individual projects may have millions of messages containing tens of thousands of lines of JSON each, we’ve implemented a “tsvector” search strategy. Please be patient and note that this text-based search may take a moment to return results.. If you’re curious about how tsvector works from a technical perspective, check out the <a href="https://www.postgresql.org/docs/10/datatype-textsearch.html#DATATYPE-TSVECTOR">official documentation</a>.</li>
<li><strong>Date</strong> - Choose a relative date range (e.g., “Last 90 Days”) or define a custom date range yourself. Note that the default inbox view shows “Last 30 Days”.</li>
</ul>
<p><img alt="Image of Inbox Filters" src="/docs/images/inbox_filter.png" /></p>
<h3 id="bulk-reprocess-messages">Bulk reprocess messages<a class="headerlink" href="#bulk-reprocess-messages" title="Permanent link">#</a></h3>
<p>Need to re-run a series of messages? If you had a job fail because of an error for multiple messages, or need to re-process the data in OpenFn to re-send to a destination application, then this feature will help you do so more quickly!</p>
<ol>
<li>
<p>Simply click on the new <strong>Reprocess</strong> button via the Inbox view.
<img alt="Reprocess button" src="/docs/images/reprocess_msgs.png" /></p>
</li>
<li>
<p>Specify the <strong>ID range</strong> for messages that you want to re-run (e.g., messages with IDs 4622741 through 4622749 → 9 messages to reprocess).
<img alt="Bulk reprocess screen" src="/docs/images/bulk_reprocess.png" /></p>
</li>
</ol>
<p><strong>Note when bulk reprocessing messages:</strong></p>
<ul>
<li>
<p>This will trigger any jobs that would have run when the given  messages first arrived in your OpenFn inbox. In other words, any jobs that are have the autoprocess setting “on” will automatically be run if triggered by one of the reprocessed messages.</p>
</li>
<li>
<p>Remember that OpenFn plans are run-based, and you can monitor usage in <strong>Project Settings</strong> to ensure that you don’t hit any run limits when bulk reprocessing!
<img alt="Usage stats chart" src="/docs/images/usage.png" /></p>
</li>
</ul>
<h3 id="export-messages-to-csv">Export messages to CSV<a class="headerlink" href="#export-messages-to-csv" title="Permanent link">#</a></h3>
<p>You can now download and review OpenFn message data by exporting to a CSV file.</p>
<ol>
<li>
<p>In your inbox, filter the messages you’d like to export to CSV. Choose to filter by text, date, trigger, and run state.</p>
</li>
<li>
<p>Click the <strong>Export as CSV</strong> button to generate an export. The link to download this file will be sent to your email address.</p>
</li>
</ol>
<p><img alt="Export CSV button" src="/docs/images/exportcsv.png" /></p>
<h2 id="activity">Activity<a class="headerlink" href="#activity" title="Permanent link">#</a></h2>
<p>In this section of the portal, you can view a list of all "runs" - i.e. individual job runs. This list is essentially a compilation of all jobs, messages and credentials flowing through your OpenFn account towards your destination system(s).</p>
<h3 id="runs">Runs<a class="headerlink" href="#runs" title="Permanent link">#</a></h3>
<p>Runs are attempts made on a destination system by running a receipt through a Job Description. Runs can be viewed and re-processed. Each submission has a <code>success</code>, <code>started_at</code>, <code>finsihed_at</code>, <code>job_description_id</code>, and <code>receipt_id</code> attribute. <code>Started_at</code> and <code>finished_at</code> are the timestamps when the submission began and ended.</p>
<blockquote>
<p><strong>Note:</strong> Some runs may take a really long time, particularly if they are performing multiple actions in a destination system or if they are fetching lots of data from a REST api at the start of a migration. They will appear as red if they have failed. In the case of failure, refer to our <a href="#troubleshooting">Troubleshooting</a> section below.</p>
</blockquote>
<h3 id="filter-runs-in-the-activity-view">Filter runs in the Activity view<a class="headerlink" href="#filter-runs-in-the-activity-view" title="Permanent link">#</a></h3>
<p>You can filter the run logs in the Activity View by:</p>
<ul>
<li>
<p><strong>Text</strong> - Remember to be patient as a full log text search can take time process. Leverage this feature to search for runs with specific error messages to support with troubleshooting any failed runs.</p>
</li>
<li>
<p><strong>Date</strong> - Filter the view to only show runs that failed in the last few hours/ days/ year – or a custom date range! Note that the default activity history view shows runs from the last 30 days.</p>
</li>
</ul>
<h3 id="bulk-retry-runs">Bulk retry runs<a class="headerlink" href="#bulk-retry-runs" title="Permanent link">#</a></h3>
<p>Need to re-process a series of runs? This could be helpful if you had multiple runs fail due to an error message.</p>
<ol>
<li>
<p>Simply click on the new <strong>Retry</strong> button via the Runs view.
<img alt="Retry run button" src="/docs/images/retrybutton.png" /></p>
</li>
<li>
<p>Specify the <strong>ID range</strong> for the runs that you want to re-process. Choose to filter by Job and/or Status to only reprocess runs associated with a specific job or runs that have failed/ succeeded.
<img alt="Bulk retry runs" src="/docs/images/runs_retry.png" /></p>
</li>
</ol>
<p>Remember that OpenFn plans are run-based, and you can monitor usage in <strong>Project Settings</strong> to ensure that you don’t hit any run limits when bulk reprocessing!</p>
<h3 id="export-runs-to-csv">Export runs to CSV<a class="headerlink" href="#export-runs-to-csv" title="Permanent link">#</a></h3>
<p>You can download your run logs by exporting to a CSV file.</p>
<ol>
<li>
<p>Via the Runs Activity History view, filter the runs you’d like to export. Choose to filter by text, date, job, and status.</p>
</li>
<li>
<p>Click the <strong>Export as CSV</strong> button to generate an export. The link to download this file will be sent to your email address.
<img alt="Export runs button" src="/docs/images/exportruns.png" /></p>
</li>
</ol>
<h2 id="github-version-control">GitHub version control<a class="headerlink" href="#github-version-control" title="Permanent link">#</a></h2>
<p>You're ready to manage your jobs via GitHub, the leading hosted version control software on the web? Great, this section describes the steps necessary to get going.</p>
<p><strong><em>N.B.: GitHub integration is currently only available for enterprise users. Contact <a href="mailto:enterprise@openfn.org">enterprise@openfn.org</a> to build a custom plan for your needs.</em></strong></p>
<h3 id="motivation">Motivation<a class="headerlink" href="#motivation" title="Permanent link">#</a></h3>
<p>Managing large numbers of jobs with multiple contributors is complicated. We developed the GitHub integration so that OpenFn projects can be linked to GitHub repositories. You can work collaboratively on your jobs. When commits are made to a particular branch OpenFn will automatically update the linked job with the new job file from GitHub.</p>
<h3 id="setup-steps">Setup Steps<a class="headerlink" href="#setup-steps" title="Permanent link">#</a></h3>
<ol>
<li>Github: Settings -&gt; Personal Access Tokens -&gt; <a href="https://github.com/settings/tokens/new">Generate New Token</a>: This token should have full control of private repositories.</li>
<li>OpenFn: <a href="https://www.openfn.org/account">User Settings</a>: Once the token is generated, copy and paste it into the "GitHub Access Token" field on your user settings page.</li>
<li>OpenFn: Project -&gt; Version Control: Specify the repository owner, repository name and branch for automatic deploys. You'd also select to turn on or off automatic deploys.</li>
<li>GitHub: Repoistory -&gt; Settings -&gt; Webhooks -&gt; Add webhook</li>
<li>Copy Payload URL from OpenFn Version Control page and paste into GitHub.</li>
<li>Select <code>application/json</code> as the Content Type.</li>
<li>Copy Secret from OpenFn Version Control page into GitHub.</li>
<li>Leave "Just the push event" and "Active" selected, then click "Add Webook".</li>
<li>OpenFn: Project -&gt; Jobs -&gt; Job Edit: To link an individual job to a file in a GitHub repo, edit that job and paste in the path to the job from the root of your GitHub repo. If your repo looks like this, you'd type <code>sample_job_1.js</code> or <code>some_folder/some_other_job.js</code> to link your OpenFn job to the select file in your repo.</li>
</ol>
<h3 id="advanced-version-control">Advanced Version Control<a class="headerlink" href="#advanced-version-control" title="Permanent link">#</a></h3>
<p>Using this GitHub integration, you can revert to previous version of jobs quickly by resending old GitHub Webhook Events. Access the "Manage Webhook" interface on GitHub to see a list of all past events and send whichever version of the job you'd like deployed to your OpenFn project.</p>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">#</a></h2>
<blockquote>
<p>What happens if my survey data from ODK needs to link to existing records in my Salesforce system but a respondent enters or selects an invalid <code>external ID</code>?</p>
</blockquote>
<p>Great question, and don't worry, it happens all the time. Assuming you've already taken all possible measures to either pre-load external IDs in your ODK form or use more human-proof IDs (like barcodes and fingerprints) here's the flow of work:</p>
<ol>
<li>
<p>Read the email, and inspect the reason for failure.</p>
</li>
<li>
<p>99% of failed runs on OpenFn are due to <code>value mismatches</code>. The <em>collected</em> <code>id</code> in ODK doesn't match the <em>expected</em> <code>id</code> in Salesforce. You must now chose to either:</p>
<p>A. Edit the source <code>id</code> in your <code>receipt</code> &amp; retry the attempt.</p>
<p>B. Edit the related <code>id</code> in your destination system &amp; retry the attempt.</p>
<p>C. Ignore the attempt—this source data will never reach your destination system. (There have been reports of ODK Aggregate's JSON publisher sending dupliate values. If that happens and your run fails due to "duplicate values" on a particular unique field you can safely ignore the run in OpenFn.)</p>
</li>
</ol>
<p>Editing data in your destination system can be done through that system's interface. Many tools that act as <code>sources</code> (like ODK) do not allow for easy editing and re-submission of data. You can use OpenFn to edit the source data before retrying the attempt.</p>
<h3 id="common-error-messages">Common Error Messages<a class="headerlink" href="#common-error-messages" title="Permanent link">#</a></h3>
<p>The most common error messages with English explanations are:</p>
<ul>
<li><code>DUPLICATE_VALUE: duplicate value found: ODK_uuid__c duplicates value on record with id: a0524000005wNw0</code> - The insert is blocked because you are attempting to create a new record with a unique field with the same value as an existing record.</li>
<li><code>Required value missing</code></li>
<li><code>ExternalId not found</code></li>
</ul>
<h2 id="diy">DIY<a class="headerlink" href="#diy" title="Permanent link">#</a></h2>
<p>OpenFn's core ETL tools are all open-source, and here we will explain how those tools can be used to perform ETL operations from your command line. You can even take this further and wrap them together in your own hosted service!</p>
<p>To create an integration service like OpenFn.org, you will need to build a REST endpoint that allows JSON or XML to be posted to it, returning a <code>2XX</code> and checking the body of that message to see if it matches some criteria. If the criteria match for that message, you must perform <code>execute</code> from fn-lang, using the message data and some stored configuration as state. See a sample state.json below:</p>
<h3 id="statejson">State.json<a class="headerlink" href="#statejson" title="Permanent link">#</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;word_count&quot;</span><span class="p">:</span> <span class="mi">284</span><span class="p">,</span>
      <span class="nt">&quot;last_update&quot;</span><span class="p">:</span> <span class="s2">&quot;2016-11-10 13:58:47&quot;</span><span class="p">,</span>
      <span class="nt">&quot;folder_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Civil Disobedience&quot;</span><span class="p">,</span>
      <span class="nt">&quot;file_owner&quot;</span><span class="p">:</span> <span class="s2">&quot;student@school.org.za&quot;</span><span class="p">,</span>
      <span class="nt">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Mock Journal Article&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;configuration&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;109.XXX.11X.2XX&quot;</span><span class="p">,</span>
      <span class="nt">&quot;port&quot;</span><span class="p">:</span> <span class="s2">&quot;5432&quot;</span><span class="p">,</span>
      <span class="nt">&quot;database&quot;</span><span class="p">:</span> <span class="s2">&quot;data-warehouse&quot;</span><span class="p">,</span>
      <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;postgres&quot;</span><span class="p">,</span>
      <span class="nt">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;secret-password&quot;</span><span class="p">,</span>
      <span class="nt">&quot;ssl&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>

<p>Make sure to store your logs. If you'd like to be able to retry transactions, persist the message data and provide an interface for manipulating that data by hand, or re-running certain transactions after the job expression has been altered.</p>
<p>Make sure that a single inbound message can kick off the running of multiple jobs.</p>
<p>To get started, or just run fn-lang manually, from your command line, check out <a href="https://github.com/OpenFn/openfn-devtools">openfn-devtools</a>. With windows and linux install scripts, it's the fastest way to get up and running with OpenFn on your local machine.</p>
<h2 id="appendix">Appendix<a class="headerlink" href="#appendix" title="Permanent link">#</a></h2>
<h3 id="sample-code-for-diy-section">Sample code for DIY section<a class="headerlink" href="#sample-code-for-diy-section" title="Permanent link">#</a></h3>
<p>Below you can find sample code to fill the 3 files required to run fn-lang - <code>message.json</code>, <code>expression.js</code> and <code>config.json</code>.</p>
<h4 id="messagejson">message.json<a class="headerlink" href="#messagejson" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="p">{</span>
  <span class="nt">&quot;xform_ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="nt">&quot;user_id&quot;</span><span class="p">:</span> <span class="s2">&quot;user1&quot;</span><span class="p">,</span>
  <span class="nt">&quot;server_date_opened&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="nt">&quot;server_date_modified&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;prop_c&quot;</span><span class="p">:</span> <span class="s2">&quot;2013-05-18&quot;</span><span class="p">,</span>
    <span class="nt">&quot;prop_b&quot;</span><span class="p">:</span> <span class="s2">&quot;Female&quot;</span><span class="p">,</span>
    <span class="nt">&quot;prop_a&quot;</span><span class="p">:</span> <span class="mi">99</span><span class="p">,</span>
    <span class="nt">&quot;owner_id&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;external_id&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;date_opened&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;2013-05-17&quot;</span><span class="p">,</span>
    <span class="nt">&quot;case_type&quot;</span><span class="p">:</span> <span class="s2">&quot;case_type&quot;</span><span class="p">,</span>
    <span class="nt">&quot;case_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Demo&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;indices&quot;</span><span class="p">:</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>

<h4 id="expressionjs">expression.js<a class="headerlink" href="#expressionjs" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">event</span><span class="p">(</span>
  <span class="nx">fields</span><span class="p">(</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;program&quot;</span><span class="p">,</span> <span class="s2">&quot;eBAyeGv0exc&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;orgUnit&quot;</span><span class="p">,</span> <span class="s2">&quot;DiszpKrYNg8&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;eventDate&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;properties.date&quot;</span><span class="p">)),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;COMPLETED&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;storedBy&quot;</span><span class="p">,</span> <span class="s2">&quot;admin&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;coordinate&quot;</span><span class="p">,</span> <span class="p">{</span>
      <span class="s2">&quot;latitude&quot;</span><span class="o">:</span> <span class="s2">&quot;59.8&quot;</span><span class="p">,</span>
      <span class="s2">&quot;longitude&quot;</span><span class="o">:</span> <span class="s2">&quot;10.9&quot;</span>
    <span class="p">}),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;dataValues&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;dataElement&quot;</span><span class="o">:</span> <span class="s2">&quot;qrur9Dvnyt5&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;properties.prop_a&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;dataElement&quot;</span><span class="o">:</span> <span class="s2">&quot;oZg33kd9taw&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;properties.prop_b&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;dataElement&quot;</span><span class="o">:</span> <span class="s2">&quot;msodh3rEMJa&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;properties.prop_c&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span> <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">})</span>
  <span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>

<h4 id="configjson">config.json<a class="headerlink" href="#configjson" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="p">{</span>
  <span class="nt">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span>
  <span class="nt">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;district&quot;</span><span class="p">,</span>
  <span class="nt">&quot;apiUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;https://play.dhis2.org/demo&quot;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>

<h3 id="filters-cont">Filters (cont.)<a class="headerlink" href="#filters-cont" title="Permanent link">#</a></h3>
<h4 id="match-messages-where-the-formid-is-robot_photo_21042015">Match messages <code>WHERE</code> the <code>formId</code> is <code>"Robot_Photo_21.04.2015"</code>:<a class="headerlink" href="#match-messages-where-the-formid-is-robot_photo_21042015" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;formId&quot;</span><span class="p">:</span><span class="s2">&quot;Robot_Photo_21.04.2015&quot;</span><span class="p">}</span>
</code></pre></div>
</td></tr></table>

<h4 id="match-a-message-where-this-and-that-are-both-included">Match a message <code>WHERE</code> this <code>AND</code> that are both included:<a class="headerlink" href="#match-a-message-where-this-and-that-are-both-included" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;formId&quot;</span><span class="p">:</span><span class="s2">&quot;Robot_Photo_21.04.2015&quot;</span><span class="p">,</span> <span class="nt">&quot;secret_number&quot;</span><span class="p">:</span><span class="mi">8</span><span class="p">}</span>
</code></pre></div>
</td></tr></table>

<h4 id="match-a-message-with-two-fragments-inside-an-array-called-data">Match a message with two fragments inside an array called <code>data</code>:<a class="headerlink" href="#match-a-message-with-two-fragments-inside-an-array-called-data" title="Permanent link">#</a></h4>
<p>(This is useful when gathering data via ODK)</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;data&quot;</span><span class="p">:[{</span><span class="nt">&quot;outlet_call&quot;</span><span class="p">:</span><span class="s2">&quot;TRUE&quot;</span><span class="p">,</span><span class="nt">&quot;new_existing&quot;</span><span class="p">:</span><span class="s2">&quot;Existing&quot;</span><span class="p">}]}</span>
</code></pre></div>
</td></tr></table>

<h4 id="match-a-message-with-a-fragment-inside-another-object-called-form">Match a message with a fragment inside another object called <code>form</code>:<a class="headerlink" href="#match-a-message-with-a-fragment-inside-another-object-called-form" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;form&quot;</span><span class="p">:{</span><span class="nt">&quot;@xmlns&quot;</span><span class="p">:</span><span class="s2">&quot;http://openrosa.org/formdesigner/F732194-3278-nota-ReAL-one&quot;</span><span class="p">}}</span>
</code></pre></div>
</td></tr></table>

<h3 id="jobs-cont">Jobs (cont.)<a class="headerlink" href="#jobs-cont" title="Permanent link">#</a></h3>
<p>Below you can find some examples of block code for different functions and data handling contexts.</p>
<h4 id="job-expression-for-commcare-to-sf">Job expression (for CommCare to SF)<a class="headerlink" href="#job-expression-for-commcare-to-sf" title="Permanent link">#</a></h4>
<p>The following job expression will take a matching receipt and use data from that receipt to upsert a <code>Patient__c</code> record in Salesforce and create multiple new <code>Patient_Visit__c</code> (child to Patient) records.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">upsert</span><span class="p">(</span><span class="s2">&quot;Patient__c&quot;</span><span class="p">,</span> <span class="s2">&quot;Patient_Id__c&quot;</span><span class="p">,</span> <span class="nx">fields</span><span class="p">(</span>
  <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Patient_Id__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;form.patient_ID&quot;</span><span class="p">)),</span>
  <span class="nx">relationship</span><span class="p">(</span><span class="s2">&quot;Nurse__r&quot;</span><span class="p">,</span> <span class="s2">&quot;Nurse_ID_code__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;form.staff_id&quot;</span><span class="p">)),</span>
  <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Phone_Number__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;form.mobile_phone&quot;</span><span class="p">))</span>
<span class="p">)),</span>
<span class="nx">each</span><span class="p">(</span>
  <span class="nx">join</span><span class="p">(</span><span class="s2">&quot;$.data.form.visits[*]&quot;</span><span class="p">,</span> <span class="s2">&quot;$.references[0].id&quot;</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">),</span>
  <span class="nx">create</span><span class="p">(</span><span class="s2">&quot;Visit__c&quot;</span><span class="p">,</span> <span class="nx">fields</span><span class="p">(</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Patient__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;Id&quot;</span><span class="p">)),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Date__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Reason__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;why_did_they_see_doctor&quot;</span><span class="p">))</span>
  <span class="p">))</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>

<h4 id="accessing-the-data-array-in-open-data-kit-submissions">Accessing the "data array" in Open Data Kit submissions<a class="headerlink" href="#accessing-the-data-array-in-open-data-kit-submissions" title="Permanent link">#</a></h4>
<p>Notice how we use "each" to get data from each item inside the "data array" in ODK.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">each</span><span class="p">(</span>
  <span class="s2">&quot;$.data.data[*]&quot;</span><span class="p">,</span>
  <span class="nx">create</span><span class="p">(</span><span class="s2">&quot;ODK_Submission__c&quot;</span><span class="p">,</span> <span class="nx">fields</span><span class="p">(</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Site_School_ID_Number__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;school&quot;</span><span class="p">)),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Date_Completed__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;comments__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;comments&quot;</span><span class="p">)),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;ODK_Key__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;*meta-instance-id*&quot;</span><span class="p">))</span>
  <span class="p">))</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>

<h4 id="odk-to-salesforce-create-parent-record-with-many-children-from-parent-data">ODK to Salesforce: create parent record with many children from parent data<a class="headerlink" href="#odk-to-salesforce-create-parent-record-with-many-children-from-parent-data" title="Permanent link">#</a></h4>
<p>Here, the user brings <code>time_end</code> and <code>parentId</code> onto the line items from the parent object.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">each</span><span class="p">(</span>
  <span class="nx">dataPath</span><span class="p">(</span><span class="s2">&quot;data[*]&quot;</span><span class="p">),</span>
  <span class="nx">combine</span><span class="p">(</span>
    <span class="nx">create</span><span class="p">(</span><span class="s2">&quot;transaction__c&quot;</span><span class="p">,</span> <span class="nx">fields</span><span class="p">(</span>
      <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Transaction_Date__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;today&quot;</span><span class="p">)),</span>
      <span class="nx">relationship</span><span class="p">(</span><span class="s2">&quot;Person_Responsible__r&quot;</span><span class="p">,</span> <span class="s2">&quot;Staff_ID_Code__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;person_code&quot;</span><span class="p">)),</span>
      <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;metainstanceid__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;*meta-instance-id*&quot;</span><span class="p">))</span>
    <span class="p">)),</span>
    <span class="nx">each</span><span class="p">(</span>
      <span class="nx">merge</span><span class="p">(</span><span class="nx">dataPath</span><span class="p">(</span><span class="s2">&quot;line_items[*]&quot;</span><span class="p">),</span> <span class="nx">fields</span><span class="p">(</span>
        <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;time_end&quot;</span><span class="p">)),</span>
        <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;parentId&quot;</span><span class="p">,</span> <span class="nx">lastReferenceValue</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">))</span>
      <span class="p">)),</span>
      <span class="nx">create</span><span class="p">(</span><span class="s2">&quot;line_item__c&quot;</span><span class="p">,</span> <span class="nx">fields</span><span class="p">(</span>
        <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;transaction__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;parentId&quot;</span><span class="p">)),</span>
        <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Barcode__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;product_barcode&quot;</span><span class="p">)),</span>
        <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;ODK_Form_Completed__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">))</span>
      <span class="p">))</span>
    <span class="p">)</span>
  <span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>

<blockquote>
<p><strong>NB - there was a known bug with the <code>combine</code> function which has been resolved. <code>combine</code> can be used to combine two operations into one and is commonly used to run multiple <code>create</code>'s inside an <code>each(path, operation)</code>. The source code for combine can be found here: <a href="https://github.com/OpenFn/language-common/blob/master/src/index.js#L204-L222">language-common: combine</a></strong></p>
</blockquote>
<h4 id="create-many-child-records-without-a-repeat-group-in-odk">Create many child records WITHOUT a repeat group in ODK<a class="headerlink" href="#create-many-child-records-without-a-repeat-group-in-odk" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">beta</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span>
  <span class="s2">&quot;$.data.data[*]&quot;</span><span class="p">,</span>
  <span class="nx">upsert</span><span class="p">(</span><span class="s2">&quot;Outlet__c&quot;</span><span class="p">,</span> <span class="s2">&quot;Outlet_Code__c&quot;</span><span class="p">,</span> <span class="nx">fields</span><span class="p">(</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Outlet_Code__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;outlet_code&quot;</span><span class="p">)),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Location__Latitude__s&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;gps:Latitude&quot;</span><span class="p">)),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Location__Longitude__s&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;gps:Longitude&quot;</span><span class="p">))</span>
  <span class="p">))</span>
<span class="p">),</span>
<span class="nx">beta</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span>
    <span class="s2">&quot;$.data.data[*]&quot;</span><span class="p">,</span>
    <span class="nx">upsert</span><span class="p">(</span><span class="s2">&quot;Outlet_Call__c&quot;</span><span class="p">,</span> <span class="s2">&quot;Invoice_Number__c&quot;</span><span class="p">,</span> <span class="nx">fields</span><span class="p">(</span>
      <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Invoice_Number__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;invoice_number&quot;</span><span class="p">)),</span>
      <span class="nx">relationship</span><span class="p">(</span><span class="s2">&quot;Outlet__r&quot;</span><span class="p">,</span> <span class="s2">&quot;Outlet_Code__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;outlet_code&quot;</span><span class="p">)),</span>
      <span class="nx">relationship</span><span class="p">(</span><span class="s2">&quot;RecordType&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;No Call Card&quot;</span><span class="p">),</span>
      <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Trip__c&quot;</span><span class="p">,</span> <span class="s2">&quot;a0FN0000008jPue&quot;</span><span class="p">),</span>
      <span class="nx">relationship</span><span class="p">(</span><span class="s2">&quot;Sales_Person__r&quot;</span><span class="p">,</span> <span class="s2">&quot;Sales_Rep_Code__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;sales_rep_code&quot;</span><span class="p">)),</span>
      <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Date__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)),</span>
      <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Comments__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;comments&quot;</span><span class="p">))</span>
  <span class="p">))</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>

<h4 id="salesforce-perform-an-update">Salesforce: perform an update<a class="headerlink" href="#salesforce-perform-an-update" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">update</span><span class="p">(</span><span class="s2">&quot;Patient__c&quot;</span><span class="p">,</span> <span class="nx">fields</span><span class="p">(</span>
  <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;pathToSalesforceId&quot;</span><span class="p">)),</span>
  <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Name__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;patient.first_name&quot;</span><span class="p">)),</span>
  <span class="nx">field</span><span class="p">(...)</span>
<span class="p">));</span>
</code></pre></div>
</td></tr></table>

<h4 id="salesforce-set-record-type-using-relationship">Salesforce: Set record type using 'relationship(...)'<a class="headerlink" href="#salesforce-set-record-type-using-relationship" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">create</span><span class="p">(</span><span class="s2">&quot;custom_obj__c&quot;</span><span class="p">,</span> <span class="nx">fields</span><span class="p">(</span>
            <span class="nx">relationship</span><span class="p">(</span><span class="s2">&quot;RecordType&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;submission_type&quot;</span><span class="p">),</span>
            <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">))</span>
            <span class="p">)</span>
      <span class="p">))</span>
</code></pre></div>
</td></tr></table>

<h4 id="salesforce-set-record-type-using-record-type-id">Salesforce: Set record type using record Type ID<a class="headerlink" href="#salesforce-set-record-type-using-record-type-id" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">each</span><span class="p">(</span>
  <span class="s2">&quot;$.data.data[*]&quot;</span><span class="p">,</span>
  <span class="nx">create</span><span class="p">(</span><span class="s2">&quot;fancy_object__c&quot;</span><span class="p">,</span> <span class="nx">fields</span><span class="p">(</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;RecordTypeId&quot;</span><span class="p">,</span> <span class="s2">&quot;012110000008s19&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;site_size&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">))</span>
  <span class="p">))</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>

<h4 id="telerivet-send-sms-based-on-salesforce-workflow-alert">Telerivet: Send SMS based on Salesforce workflow alert<a class="headerlink" href="#telerivet-send-sms-based-on-salesforce-workflow-alert" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">send</span><span class="p">(</span>
  <span class="nx">fields</span><span class="p">(</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;to_number&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;Envelope.Body.notifications.Notification.sObject.phone_number__c&quot;</span><span class="p">)),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;message_type&quot;</span><span class="p">,</span> <span class="s2">&quot;sms&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;route_id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">(</span>
        <span class="s2">&quot;Hey there. Your name is &quot;</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span>
          <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;Envelope.Body.notifications.Notification.sObject.name__c&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">),</span>
          <span class="s2">&quot;.&quot;</span>
        <span class="p">)</span>
      <span class="p">)</span>
    <span class="p">})</span>
  <span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
</td></tr></table>

<h4 id="http-fetch-but-dont-fail">HTTP: fetch but don't fail!<a class="headerlink" href="#http-fetch-but-dont-fail" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// =============</span>
<span class="c1">// We use &quot;fetchWithErrors(...)&quot; so that when the</span>
<span class="c1">// SMS gateway returns an error the run does not &quot;fail&quot;.</span>
<span class="c1">// It &quot;succeeds&quot; and then delivers that error message</span>
<span class="c1">// back to Salesforce with the &quot;Update SMS Status&quot; job.</span>
<span class="c1">// =============</span>
<span class="nx">fetchWithErrors</span><span class="p">({</span>
  <span class="s2">&quot;getEndpoint&quot;</span><span class="o">:</span> <span class="s2">&quot;send_to_contact&quot;</span><span class="p">,</span>
  <span class="s2">&quot;query&quot;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;msisdn&quot;</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">Envelope</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">sObject</span><span class="p">.</span><span class="nx">SMS__Phone_Number__c</span><span class="p">,</span>
        <span class="s2">&quot;message&quot;</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">Envelope</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">sObject</span><span class="p">.</span><span class="nx">SMS__Message__c</span><span class="p">,</span>
        <span class="s2">&quot;api_key&quot;</span><span class="o">:</span> <span class="s2">&quot;some-secret-key&quot;</span>
      <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;externalId&quot;</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">Envelope</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">notifications</span><span class="p">.</span><span class="nx">Notification</span><span class="p">.</span><span class="nx">sObject</span><span class="p">.</span><span class="nx">Id</span><span class="p">,</span>
  <span class="s2">&quot;postUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;https://www.openfn.org/inbox/another-secret-key&quot;</span><span class="p">,</span>
<span class="p">})</span>
</code></pre></div>
</td></tr></table>

<h4 id="sample-dhis2-events-api-job">Sample DHIS2 events API job:<a class="headerlink" href="#sample-dhis2-events-api-job" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">event</span><span class="p">(</span>
  <span class="nx">fields</span><span class="p">(</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;program&quot;</span><span class="p">,</span> <span class="s2">&quot;eBAyeGv0exc&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;orgUnit&quot;</span><span class="p">,</span> <span class="s2">&quot;DiszpKrYNg8&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;eventDate&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;properties.date&quot;</span><span class="p">)),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;COMPLETED&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;storedBy&quot;</span><span class="p">,</span> <span class="s2">&quot;admin&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;coordinate&quot;</span><span class="p">,</span> <span class="p">{</span>
      <span class="s2">&quot;latitude&quot;</span><span class="o">:</span> <span class="s2">&quot;59.8&quot;</span><span class="p">,</span>
      <span class="s2">&quot;longitude&quot;</span><span class="o">:</span> <span class="s2">&quot;10.9&quot;</span>
    <span class="p">}),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;dataValues&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;dataElement&quot;</span><span class="o">:</span> <span class="s2">&quot;qrur9Dvnyt5&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;properties.prop_a&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;dataElement&quot;</span><span class="o">:</span> <span class="s2">&quot;oZg33kd9taw&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;properties.prop_b&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;dataElement&quot;</span><span class="o">:</span> <span class="s2">&quot;msodh3rEMJa&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;properties.prop_c&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span> <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">})</span>
  <span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>

<h4 id="sample-dhis2-data-value-sets-api-job">Sample DHIS2 data value sets API job:<a class="headerlink" href="#sample-dhis2-data-value-sets-api-job" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">dataValueSet</span><span class="p">(</span>
  <span class="nx">fields</span><span class="p">(</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;dataSet&quot;</span><span class="p">,</span> <span class="s2">&quot;pBOMPrpg1QX&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;orgUnit&quot;</span><span class="p">,</span> <span class="s2">&quot;DiszpKrYNg8&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="s2">&quot;201401&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;completeData&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;dataValues&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;dataElement&quot;</span><span class="o">:</span> <span class="s2">&quot;f7n9E0hX8qk&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;prop_a&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;dataElement&quot;</span><span class="o">:</span> <span class="s2">&quot;Ix2HsbDMLea&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;prop_b&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;dataElement&quot;</span><span class="o">:</span> <span class="s2">&quot;eY5ehpbEsB7&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;prop_c&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span> <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">})</span>
  <span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>

<h4 id="sample-openmrs-expression-creates-a-person-and-then-a-patient">sample openMRS expression, creates a person and then a patient<a class="headerlink" href="#sample-openmrs-expression-creates-a-person-and-then-a-patient" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">person</span><span class="p">(</span>
  <span class="nx">fields</span><span class="p">(</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">[{</span>
        <span class="s2">&quot;givenName&quot;</span><span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;form.first_name&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">),</span>
        <span class="s2">&quot;familyName&quot;</span><span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;form.last_name&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span>
      <span class="p">}]</span>
    <span class="p">})</span>
  <span class="p">)</span>
<span class="p">),</span>
<span class="nx">patient</span><span class="p">(</span>
  <span class="nx">fields</span><span class="p">(</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;person&quot;</span><span class="p">,</span> <span class="nx">lastReferenceValue</span><span class="p">(</span><span class="s2">&quot;uuid&quot;</span><span class="p">)),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;identifiers&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">[{</span>
        <span class="s2">&quot;identifier&quot;</span><span class="o">:</span> <span class="s2">&quot;1234&quot;</span><span class="p">,</span>
        <span class="s2">&quot;identifierType&quot;</span><span class="o">:</span> <span class="s2">&quot;8d79403a-c2cc-11de-8d13-0010c6dffd0f&quot;</span><span class="p">,</span>
        <span class="s2">&quot;location&quot;</span><span class="o">:</span> <span class="s2">&quot;8d6c993e-c2cc-11de-8d13-0010c6dffd0f&quot;</span><span class="p">,</span>
        <span class="s2">&quot;preferred&quot;</span><span class="o">:</span> <span class="kc">true</span>
      <span class="p">}]</span>
    <span class="p">})</span>
  <span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>

<h4 id="merge-many-values-into-a-child-path">merge many values into a child path<a class="headerlink" href="#merge-many-values-into-a-child-path" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">each</span><span class="p">(</span>
  <span class="nx">merge</span><span class="p">(</span>
    <span class="nx">dataPath</span><span class="p">(</span><span class="s2">&quot;CHILD_ARRAY[*]&quot;</span><span class="p">),</span>
    <span class="nx">fields</span><span class="p">(</span>
      <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;metaId&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;*meta-instance-id*&quot;</span><span class="p">)),</span>
      <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;parentId&quot;</span><span class="p">,</span> <span class="nx">lastReferenceValue</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="p">),</span>
  <span class="nx">create</span><span class="p">(...)</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>

<h4 id="arraytostring">arrayToString<a class="headerlink" href="#arraytostring" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">arrayToString</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="nx">separator_string</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>

<h4 id="access-an-image-url-from-an-odk-submission">access an image URL from an ODK submission<a class="headerlink" href="#access-an-image-url-from-an-odk-submission" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// In ODK the image URL is inside an image object...</span>
<span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Photo_URL_text__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;image.url&quot;</span><span class="p">)),</span>
</code></pre></div>
</td></tr></table>

<h4 id="alterstate-alter-state-to-make-sure-data-is-in-an-array">alterState (alter state) to make sure data is in an array<a class="headerlink" href="#alterstate-alter-state-to-make-sure-data-is-in-an-array" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">// Here, we make sure CommCare gives us an array to use in each(merge(...), ...)</span>
<span class="nx">alterState</span><span class="p">((</span><span class="nx">state</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">idCards</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">ID_cards_given_to_vendor</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">idCards</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">state</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">ID_cards_given_to_vendor</span> <span class="o">=</span> <span class="p">[</span><span class="nx">idCards</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">state</span><span class="p">;</span>
<span class="p">});</span>

<span class="c1">// Now state has been changed, and we carry on...</span>
<span class="nx">each</span><span class="p">(</span>
  <span class="nx">merge</span><span class="p">(</span><span class="nx">dataPath</span><span class="p">(</span><span class="s2">&quot;form.ID_cards_given_to_vendor[*]&quot;</span><span class="p">),</span> <span class="nx">fields</span><span class="p">(</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Vendor_Id&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;form.ID_vendor&quot;</span><span class="p">)),</span>
    <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;form_finished_time&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;form.meta.timeEnd&quot;</span><span class="p">))</span>
  <span class="p">)),</span>
  <span class="nx">upsert</span><span class="p">(</span><span class="s2">&quot;Small_Packet__c&quot;</span><span class="p">,</span> <span class="s2">&quot;sp_id__c&quot;</span><span class="p">,</span> <span class="nx">fields</span><span class="p">(</span>
     <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;sp_id__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;ID_cards_given_to_vendor&quot;</span><span class="p">)),</span>
     <span class="nx">relationship</span><span class="p">(</span><span class="s2">&quot;Vendor__r&quot;</span><span class="p">,</span> <span class="s2">&quot;Badge_Code__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;Vendor_Id&quot;</span><span class="p">)),</span>
     <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Small_Packet_Distribution_Date__c&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;form_finished_time&quot;</span><span class="p">))</span>
  <span class="p">))</span>
<span class="p">);</span>
</code></pre></div>
</td></tr></table>

<h3 id="anonymous-functions-cont">Anonymous Functions (cont.)<a class="headerlink" href="#anonymous-functions-cont" title="Permanent link">#</a></h3>
<p>Different to <a href="#named-functions">Named Functions</a>, Anoynmous functions are generic pieces of javascript which you can write to suit your needs. Here are some examples of these custom functions:</p>
<h4 id="custom-replacer">Custom replacer<a class="headerlink" href="#custom-replacer" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">field</span><span class="p">(</span>
  <span class="s2">&quot;destination__c&quot;</span><span class="p">,</span>
  <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;path_to_data&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">).</span><span class="nx">toString</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;cats&quot;</span><span class="p">,</span><span class="s2">&quot;dogs&quot;</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>

<p>This will replace all "cats" with "dogs" in the string that lives at <code>path_to_data</code>.</p>
<blockquote>
<p><strong>NOTE:</strong> The JavaScript <code>replace()</code> function only replaces the first instance of whatever argument you specify.
If you're looking for a way to replace all instances, we suggest you use a regex like we did in the <a href="#custom-concatenation-of-null-values">example</a> below.</p>
</blockquote>
<h4 id="custom-arraytostring">Custom arrayToString<a class="headerlink" href="#custom-arraytostring" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">field</span><span class="p">(</span><span class="s2">&quot;target_specie_list__c&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span>
    <span class="kc">null</span><span class="p">,</span> <span class="nx">sourceValue</span><span class="p">(</span><span class="s2">&quot;$.data.target_specie_list&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span>
  <span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
<span class="p">}),</span>
</code></pre></div>
</td></tr></table>

<p>It will take an array, and concatenate each item into a string with a ", " separator.</p>
<h4 id="custom-concatenation">Custom concatenation<a class="headerlink" href="#custom-concatenation" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">field</span><span class="p">(</span><span class="s2">&quot;ODK_Key__c&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;metaId&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">).</span><span class="nx">concat</span><span class="p">(</span>
      <span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">),</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span>
  <span class="p">)</span>
<span class="p">})</span>
</code></pre></div>
</td></tr></table>

<p>This will concatenate two values.</p>
<h4 id="concatenation-of-null-values">Concatenation of null values<a class="headerlink" href="#concatenation-of-null-values" title="Permanent link">#</a></h4>
<p>This will concatenate many values, even if one or more are null, writing them to a field called Main_Office_City_c.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="p">...</span>
  <span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Main_Office_City__c&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">arrayToString</span><span class="p">([</span>
      <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;Main_Office_City_a&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;Main_Office_City_a&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">).</span><span class="nx">toString</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/-/g</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
      <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;Main_Office_City_b&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;Main_Office_City_b&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">).</span><span class="nx">toString</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/-/g</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
      <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;Main_Office_City_c&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;Main_Office_City_c&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">).</span><span class="nx">toString</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/-/g</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
      <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;Main_Office_City_d&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">?</span> <span class="s2">&quot;&quot;</span> <span class="o">:</span> <span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;Main_Office_City_d&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">).</span><span class="nx">toString</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/-/g</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
    <span class="p">].</span><span class="nx">filter</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">),</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
  <span class="p">})</span>
</code></pre></div>
</td></tr></table>

<blockquote>
<p>Notice how this custom function makes use of the <strong>regex</strong> <code>/-/g</code> to ensure that all instances are accounted for (g = global search).</p>
</blockquote>
<h4 id="custom-nth-reference-id">Custom Nth reference ID<a class="headerlink" href="#custom-nth-reference-id" title="Permanent link">#</a></h4>
<p>If you ever want to retrieve the FIRST object you created, or the SECOND, or the Nth, for that matter, a function like this will do the trick.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">field</span><span class="p">(</span><span class="s2">&quot;parent__c&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">state</span><span class="p">.</span><span class="nx">references</span><span class="p">[</span><span class="nx">state</span><span class="p">.</span><span class="nx">references</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">id</span>
  <span class="p">})</span>
</code></pre></div>
</td></tr></table>

<p>See how instead of taking the id of the "last" thing that was created in Salesforce, you're taking the id of the 1st thing, or 2nd thing if you replace "length-1" with "length-2".</p>
<h4 id="convert-date-string-to-standard-iso-date-for-salesforce">Convert date string to standard ISO date for Salesforce<a class="headerlink" href="#convert-date-string-to-standard-iso-date-for-salesforce" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Payment_Date__c&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">dataValue</span><span class="p">(</span><span class="s2">&quot;payment_date&quot;</span><span class="p">)(</span><span class="nx">state</span><span class="p">)).</span><span class="nx">toISOString</span><span class="p">()</span>
<span class="p">})</span>
</code></pre></div>
</td></tr></table>

<blockquote>
<p><strong>NOTE</strong>: The output of this function will always be formatted according to GMT time-zone.</p>
</blockquote>
<h4 id="use-external-id-fields-for-relationships-during-a-bulk-load-in-salesforce">Use external ID fields for relationships during a bulk load in Salesforce<a class="headerlink" href="#use-external-id-fields-for-relationships-during-a-bulk-load-in-salesforce" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">array</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">Patient_Name__c</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">fullName</span><span class="p">,</span>
    <span class="s1">&#39;Clinic__r.Unique_Clinic_Identifier__c&#39;</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">clinicId</span><span class="p">,</span>
    <span class="s1">&#39;RecordType.Name&#39;</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span>
  <span class="p">};</span>
<span class="p">})</span>
</code></pre></div>
</td></tr></table>

<h4 id="bulk-upsert-with-an-external-id-in-salesforce">Bulk upsert with an external ID in salesforce<a class="headerlink" href="#bulk-upsert-with-an-external-id-in-salesforce" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="nx">bulk</span><span class="p">(</span>
  <span class="s1">&#39;Visit_new__c&#39;</span><span class="p">,</span>
  <span class="s1">&#39;upsert&#39;</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="nx">extIdField</span><span class="o">:</span> <span class="s1">&#39;commcare_case_id__c&#39;</span><span class="p">,</span>
    <span class="nx">failOnError</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">allowNoOp</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="nx">dataValue</span><span class="p">(</span><span class="s1">&#39;patients&#39;</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
</td></tr></table>

<h3 id="common-errors-and-how-to-handle-them">Common errors and how to handle them<a class="headerlink" href="#common-errors-and-how-to-handle-them" title="Permanent link">#</a></h3>
<h4 id="are-master-detail-relationships-in-salesforce-reparentable">Are Master-detail relationships in Salesforce reparentable?<a class="headerlink" href="#are-master-detail-relationships-in-salesforce-reparentable" title="Permanent link">#</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">{ INVALID_FIELD_FOR_INSERT_UPDATE: Unable to create/update fields: Contact__c.</span>
<span class="err">Please check the security settings of this field and verify that it is</span>
<span class="err">read/write for your profile or permission set. }</span>
</code></pre></div>
</td></tr></table>

<p>This error may arise if a master-detail relationship in Salesforce is not set as
reparentable and the user attempts to run an upsert.</p>
                
              
              
                


  <h2 id="__comments">Comments</h2>
  <div id="disqus_thread"></div>
  <script>var disqus_config=function(){this.page.url="https://openfn.github.io/docs/documentation.html",this.page.identifier="/documentation.html"};!function(){var e=document,i=e.createElement("script");i.src="//openfn.disqus.com/embed.js",i.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(i)}()</script>

              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="quick-start.html" title="Quick Start Guide" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Quick Start Guide
              </div>
            </div>
          </a>
        
        
          <a href="release-notes.html" title="Release Notes" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Release Notes
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright (c) 2019 Open Function Group LLC
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="https://github.com/openfn" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
      <a href="https://facebook.com/openfn" target="_blank" rel="noopener" title="facebook.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
      </a>
    
      
      
      <a href="https://twitter.com/openfn" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
      <a href="https://linkedin.com/in/openfn" target="_blank" rel="noopener" title="linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/vendor.83fe6e3c.min.js"></script>
      <script src="assets/javascripts/bundle.7e1cb91c.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: ".",
          features: ["tabs", "instant"],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.37585f48.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>